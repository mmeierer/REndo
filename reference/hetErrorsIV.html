<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting Linear Models with Endogenous Regressors using Heteroskedastic Covariance Restrictions — hetErrorsIV • REndo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fitting Linear Models with Endogenous Regressors using Heteroskedastic Covariance Restrictions — hetErrorsIV" />
<meta property="og:description" content="This function estimates the model parameters and associated standard errors for a
linear regression model with one endogenous regressor. Identification is achieved
through heteroscedastic covariance restrictions within the triangular system as proposed in Lewbel(2012)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/REndo-introduction.html">REndo: A Package to Address Endogeneity Without External Instrumental Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mmeierer/REndo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models with Endogenous Regressors using Heteroskedastic Covariance Restrictions</h1>
    <small class="dont-index">Source: <a href='https://github.com/mmeierer/REndo/blob/master/R/f_heterrorsIV.R'><code>R/f_heterrorsIV.R</code></a></small>
    <div class="hidden name"><code>hetErrorsIV.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the model parameters and associated standard errors for a
linear regression model with one endogenous regressor. Identification is achieved
through heteroscedastic covariance restrictions within the triangular system as proposed in Lewbel(2012).</p>
    </div>

    <pre class="usage"><span class='fu'>hetErrorsIV</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fitted. See the "Details" section for the exact notation.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the data of all parts specified in the formula parameter.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of classes <code>rendo.ivreg</code> and <code>ivreg</code>, It extends the object returned from
function <code>ivreg</code> of package <code>AER</code> and slightly modifies it by adapting the <code>call</code>
and <code>formula</code> components. The <code>summary</code> function prints additional diagnostic information as
described in documentation for <code><a href='https://rdrr.io/pkg/AER/man/summary.ivreg.html'>summary.ivreg</a></code>.</p>
<p>All generic accessor functions for <code>ivreg</code> such as <code>anova</code>, <code>hatvalues</code>, or <code>vcov</code> are available.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method</h3>
<p>The method proposed in Lewbel(2012) identifies structural parameters in regression models with endogenous
regressors by means of variables that are uncorrelated with the product of heteroskedastic errors.
The instruments are constructed as simple functions of the model's data. The method can be applied when
no external instruments are available or to supplement external instruments to improve the efficiency of the
IV estimator.
Consider the model in the equation:
<br><center>y<sub>t</sub>=&beta;<sub>0</sub>+&beta;<sub>1</sub>P<sub>t</sub>+&beta;<sub>2</sub>X<sub>t</sub>+&epsilon;<sub>t</sub></center></p>
<p>where \(t=1,..,T\) indexes either time or cross-sectional units.The endogeneity problem arises from the correlation of
P<sub>t</sub> and &epsilon;<sub>t</sub>.
As such: P<sub>t</sub> = Z<sub>t</sub>+&nu;<sub>t</sub>,
where Z<sub>t</sub> is a subset of variables in X<sub>t</sub>.</p>
<p>The errors, &epsilon; and &nu;, may be correlated with each other.
Structural parameters are identified by an ordinary two-stage least squares regression of \(Y\) on \(X\) and \(P\), using \(X\) and \([Z-E(Z)]\nu\) as instruments.
A vital assumption for identification is that cov(Z,&nu;<sup>2</sup>)&ne;0.
The strength of the instrument is proportional to the covariance of (Z-Z&#773;)&nu; with \(\nu\), which corresponds to
the degree of heteroskedasticity of \(\nu\) with respect to \(Z\) (Lewbel 2012).</p>
<p>The assumption that the covariance between \(Z\) and the squared error is different from zero can be empirically tested (this is checked in the background when calling the
function). If it is zero or close to zero, the instrument is weak, producing imprecise estimates, with large standard errors.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Formula parameter</h3>
<p>The <code>formula</code> argument follows a four part notation:</p>
<p>A two-sided formula describing the model (e.g. <code>y ~ X1 + X2 + P</code>), a single endogenous regressor
(e.g. <code>P</code>), and the exogenous variables from which the internal instrumental variables should
be build (e.g. <code>IIV(X1) + IIV(X2)</code>), each part separated by a single vertical bar (<code><a href='https://rdrr.io/r/base/Logic.html'>|</a></code>).</p>
<p>The instrumental variables that should be built are specified as (multiple) functions, one for each
instrument. This function is <code>IIV</code> and uses the following arguments:</p>
<dl>
<dt><code>...</code></dt><dd><p>The exogenous regressors to build the internal instruments from.
If more than one is given, separate instruments are built for each.</p></dd>

</dl><p>Note that no argument to <code>IIV</code> is to be supplied as character but as symbols without quotation marks.</p>
<p>Optionally, additional external instrumental variables to also include in the instrumental variable
regression can be specified. These external instruments have to be already present in the data
and are provided as the fourth right-hand side part of the formula, again separated by a vertical bar.</p>
<p>See the example section for illustrations on how to specify the <code>formula</code> parameter.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Lewbel, A. (2012). Using Heteroskedasticity to Identify and Estimate Mismeasured and Endogenous Regressor Models, Journal of Business &amp; Economic Statistics, 30(1), 67-80.</p>
<p>Angrist, J. and Pischke, J.S. (2009). Mostly Harmless Econometrics: An Empiricists Companion, Princeton University Press.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/AER/man/ivreg.html'>ivreg</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataHetIV"</span><span class='op'>)</span>
<span class='co'># P is the endogenous regressor in all examples</span>
<span class='co'># X1 generates a weak instrument but for the examples</span>
<span class='co'># this is ignored</span>

<span class='co'># 2 IVs, one from X1, one from X2</span>
<span class='va'>het</span> <span class='op'>&lt;-</span> <span class='fu'>hetErrorsIV</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>IIV</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>IIV</span><span class='op'>(</span><span class='va'>X2</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>dataHetIV</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Residuals were derived by fitting P ~ X1 + X2.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: A studentized Breusch-Pagan test (P ~ X1) indicates at a 95% confidence level that the assumption of heteroscedasticity for the variable is not satisfied (p-value: 0.0501). The instrument built from it therefore is weak.</span></div><div class='output co'>#&gt; <span class='message'>The following internal instruments were built: IIV(X1), IIV(X2).</span></div><div class='output co'>#&gt; <span class='message'>Fitting an instrumental variable regression with model y ~ X1 + X2 + P|X1 + X2 + IIV(X1) + IIV(X2).</span></div><div class='input'><span class='co'># same as above</span>
<span class='va'>het</span> <span class='op'>&lt;-</span> <span class='fu'>hetErrorsIV</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>IIV</span><span class='op'>(</span><span class='va'>X1</span>,<span class='va'>X2</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>dataHetIV</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Residuals were derived by fitting P ~ X1 + X2.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: A studentized Breusch-Pagan test (P ~ X1) indicates at a 95% confidence level that the assumption of heteroscedasticity for the variable is not satisfied (p-value: 0.0501). The instrument built from it therefore is weak.</span></div><div class='output co'>#&gt; <span class='message'>The following internal instruments were built: IIV(X1), IIV(X2).</span></div><div class='output co'>#&gt; <span class='message'>Fitting an instrumental variable regression with model y ~ X1 + X2 + P|X1 + X2 + IIV(X1) + IIV(X2).</span></div><div class='input'>
<span class='co'># use X2 as an external IV</span>
<span class='va'>het</span> <span class='op'>&lt;-</span> <span class='fu'>hetErrorsIV</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>IIV</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span><span class='op'>|</span><span class='va'>X2</span>, data<span class='op'>=</span><span class='va'>dataHetIV</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Residuals were derived by fitting P ~ X1.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: A studentized Breusch-Pagan test (P ~ X1) indicates at a 95% confidence level that the assumption of heteroscedasticity for the variable is not satisfied (p-value: 0.0501). The instrument built from it therefore is weak.</span></div><div class='output co'>#&gt; <span class='message'>The following internal instruments were built: IIV(X1).</span></div><div class='output co'>#&gt; <span class='message'>Fitting an instrumental variable regression with model y ~ X1 + P|X1 + IIV(X1) + X2.</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>het</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; hetErrorsIV(formula = y ~ X1 + P | P | IIV(X1) | X2, data = dataHetIV)
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -46.23686  -2.27805  -0.08071   2.12718  50.45236 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  0.07569    0.13666   0.554    0.580    
#&gt; X1           1.59674    0.11651  13.704   &lt;2e-16 ***
#&gt; P           -0.01719    0.03892  -0.442    0.659    
#&gt; 
#&gt; Diagnostic tests:
#&gt;                   df1  df2 statistic  p-value    
#&gt; Weak instruments    2 2496   1377.04  &lt; 2e-16 ***
#&gt; Wu-Hausman          1 2496    287.90  &lt; 2e-16 ***
#&gt; Sargan              1   NA     16.41 5.09e-05 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Residual standard error: 5.762 on 2497 degrees of freedom
#&gt; Multiple R-Squared: 0.0762,	Adjusted R-squared: 0.07546 
#&gt; Wald test: 93.98 on 2 and 2497 DF,  p-value: &lt; 2.2e-16 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



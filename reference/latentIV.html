<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting Linear Models with one Endogenous Regressor using Latent Instrumental Variables — latentIV • REndo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fitting Linear Models with one Endogenous Regressor using Latent Instrumental Variables — latentIV" />
<meta property="og:description" content="Fits linear models with one endogenous regressor and no additional explanatory variables using the latent instrumental variable approach
presented in Ebbes, P., Wedel, M.,  Böckenholt, U., and Steerneman, A. G. M. (2005). This is a statistical technique to address the endogeneity problem where no external instrumental
variables are needed. The important assumption of the model is that the latent variables are discrete with at least two groups with different means and
the structural error is normally distributed." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/REndo-introduction.html">REndo: A Package to Address Endogeneity Without External Instrumental Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mmeierer/REndo/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models with one Endogenous Regressor using Latent Instrumental Variables</h1>
    <small class="dont-index">Source: <a href='https://github.com/mmeierer/REndo/blob/master/R/f_latentIV.R'><code>R/f_latentIV.R</code></a></small>
    <div class="hidden name"><code>latentIV.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits linear models with one endogenous regressor and no additional explanatory variables using the latent instrumental variable approach
presented in Ebbes, P., Wedel, M.,  Böckenholt, U., and Steerneman, A. G. M. (2005). This is a statistical technique to address the endogeneity problem where no external instrumental
variables are needed. The important assumption of the model is that the latent variables are discrete with at least two groups with different means and
the structural error is normally distributed.</p>
    </div>

    <pre class="usage"><span class='fu'>latentIV</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='kw'>start.params</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fitted. Of class "formula".</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the data of all parts specified in the formula parameter.</p></td>
    </tr>
    <tr>
      <th>start.params</th>
      <td><p>A named vector containing a set of parameters to use in the first optimization iteration.
The names have to correspond exactly to the names of the components specified in the formula parameter.
If not provided, a linear model is fitted to derive them.</p></td>
    </tr>
    <tr>
      <th>optimx.args</th>
      <td><p>A named list of arguments which are passed to <code><a href='https://rdrr.io/pkg/optimx/man/optimx.html'>optimx</a></code>. This allows users to tweak optimization settings to their liking.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of classes <code>rendo.latent.IV</code> and <code>rendo.base</code> is returned which is a list and contains the following components:</p>
<dt>formula</dt><dd><p>The formula given to specify the fitted model.</p></dd>
<dt>terms</dt><dd><p>The terms object used for model fitting.</p></dd>
<dt>model</dt><dd><p>The model.frame used for model fitting.</p></dd>
<dt>coefficients</dt><dd><p>A named vector of all coefficients resulting from model fitting.</p></dd>
<dt>names.main.coefs</dt><dd><p>a vector specifying which coefficients are from the model. For internal usage.</p></dd>
<dt>start.params</dt><dd><p>A named vector with the initial set of parameters used to optimize the log-likelihood function.</p></dd>
<dt>res.optimx</dt><dd><p>The result object returned by the function <code>optimx</code> after optimizing the log-likelihood function.</p></dd>
<dt>hessian</dt><dd><p>A named, symmetric matrix giving an estimate of the Hessian at the found solution.</p></dd>
<dt>m.delta.diag</dt><dd><p>A diagonal matrix needed when deriving the vcov to apply the delta method on theta5 which was transformed during the LL optimization.</p></dd>
<dt>fitted.values</dt><dd><p>Fitted values at the found optimal solution.</p></dd>
<dt>residuals</dt><dd><p>The residuals at the found optimal solution.</p></dd>

The function summary can be used to obtain and print a summary of the results.
The generic accessor functions coefficients, fitted.values, residuals, vcov, confint, logLik, AIC, BIC, case.names, and nobs are available.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Let's consider the model:
<br><center>Y<sub>t</sub>=&beta;<sub>0</sub>+&alpha;P<sub>t</sub>+&epsilon;<sub>t</sub></center>
<center>P<sub>t</sub>=&pi;'Z<sub>t</sub>+&nu;<sub>t</sub></center></p>
<p>where \(t = 1,..,T\) indexes either time or cross-sectional units, Y<sub>t</sub> is the dependent variable,
P<sub>t</sub> is a <code>k x 1</code> continuous, endogenous regressor,
&epsilon;<sub>t</sub> is a structural error term with mean zero
and E(&epsilon;<sup>2</sup>)=&sigma;<sub>&epsilon;</sub><sup>2</sup>,
\(\alpha\) and &beta;<sub>0</sub> are model parameters.
Z;<sub>t</sub> is a <code>l x 1</code> vector of instruments,
and &nu;<sub>t</sub> is a random error with mean zero and
E(&nu;<sup>2</sup>)=&sigma;<sub>&nu;</sub><sup>2</sup>.
The endogeneity problem arises from the correlation of \(P\) and &epsilon;<sub>t</sub>
through E(&epsilon;&nu;)=&sigma;<sub>&epsilon;&nu;</sub></p>
<p><code>latentIV</code> considers Z<sub>t</sub>' to be a latent, discrete, exogenous variable with an unknown number of groups \(m\) and \(\pi\) is a vector of group means.
It is assumed that \(Z\) is independent of the error terms \(\epsilon\) and \(\nu\) and that it has at least two groups with different means.
The structural and random errors are considered normally distributed with mean zero and variance-covariance matrix \(\Sigma\):
<center>&Sigma;=(&sigma;<sub>&epsilon;</sub><sup>2</sup>, &sigma;<sub>0</sub><sup>2</sup>,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&sigma;<sub>0</sub><sup>2</sup>, &sigma;<sub>&nu;</sub><sup>2</sup>)</center></p>
<p>The identification of the model lies in the assumption of the non-normality of
P<sub>t</sub>, the discreteness of the unobserved instruments and the existence of
at least two groups with different means.</p>
<p>The method has been implemented such that the latent variable has two groups. Ebbes et al.(2005) show in a Monte Carlo experiment that
even if the true number of the categories of the instrument is larger than two, estimates are approximately consistent. Besides, overfitting in terms
of the number of groups/categories reduces the degrees of freedom and leads to efficiency loss. For a model with additional explanatory variables a Bayesian approach is needed, since
in a frequentist approach identification issues appear.</p>
<p>Identification of the parameters relies on the distributional assumptions of the latent instruments as well as that of
the endogenous regressor P<sub>t</sub>.
Specifically, the endogenous regressor should have a non-normal distribution while the unobserved instruments, \(Z\), should be discrete and have at least two groups with different means Ebbes, Wedel, and Böckenholt (2009).
A continuous distribution for the instruments leads to an unidentified model, while a normal distribution of the endogenous regressor gives rise to inefficient estimates.</p>
<p>Additional parameters used during model fitting and printed in <code>summary</code> are:</p><dl>
<dt>pi1</dt><dd><p>The instrumental variables \(Z\) are assumed to be divided into two groups. <code>pi1</code> represents the estimated group mean of the first group.</p></dd>
<dt>pi2</dt><dd><p>The estimated group mean of the second group of the instrumental variables \(Z\).</p></dd>
<dt>theta5</dt><dd><p>The probability of being in the first group of the instruments.</p></dd>
<dt>theta6</dt><dd><p>The variance, &sigma;<sub>&epsilon;</sub><sup>2</sup></p></dd>
<dt>theta7</dt><dd><p>The covariance, &sigma;<sub>&epsilon;&nu;</sub></p></dd>
<dt>theta8</dt><dd><p>The variance, &sigma;<sub>&nu;</sub><sup>2</sup></p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ebbes, P., Wedel,M., Böckenholt, U., and Steerneman, A. G. M. (2005). 'Solving and Testing for Regressor-Error
(in)Dependence When no Instrumental Variables are Available: With New Evidence for the Effect of Education on Income'.
Quantitative Marketing and Economics, 3:365--392.</p>
<p>Ebbes P., Wedel M., Böckenholt U. (2009). “Frugal IV Alternatives to Identify the Parameter for an Endogenous Regressor.” Journal of Applied Econometrics, 24(3), 446–468.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.rendo.latent.IV.html'>summary</a></code> for how fitted models are summarized</p>
<p><code><a href='https://rdrr.io/pkg/optimx/man/optimx.html'>optimx</a></code> for possible elements of parameter <code>optimx.arg</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"dataLatentIV"</span>)

<span class='co'># function call without any initial parameter values</span>
<span class='no'>l</span>  <span class='kw'>&lt;-</span> <span class='fu'>latentIV</span>(<span class='no'>y</span> ~ <span class='no'>P</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataLatentIV</span>)</div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ P is fitted to derive them.</span></div><div class='output co'>#&gt; <span class='message'>The start parameters c((Intercept)=2.915, P=-0.852, pi1=0.589, pi2=2.001, theta5=0.5, theta6=1, theta7=0.5, theta8=1) are used for optimization.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>l</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; latentIV(formula = y ~ P, data = dataLatentIV)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z-score Pr(&gt;|z|)    
#&gt; (Intercept)  2.98632    0.03031   98.53   &lt;2e-16 ***
#&gt; P           -0.97539    0.03843  -25.38   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Further parameters estimated during model fitting:
#&gt;     pi1     pi2  theta5  theta6  theta7  theta8 
#&gt; 0.01744 2.21266 0.74306 1.01343 0.26144 1.09164 
#&gt; (see help file for details)
#&gt; 
#&gt; Initial parameter values:
#&gt; (Intercept)=2.9152 P=-0.8519 pi1=0.589 pi2=2.0011 theta5=0.5
#&gt; theta6=1 theta7=0.5 theta8=1
#&gt; 
#&gt; The value of the log-likelihood function: 7873.344 
#&gt; AIC: -15730.69 , BIC: -15684.1 
#&gt; KKT1: FALSE  KKT2: TRUE Optimx Convergence Code: 0 </div><div class='input'>
<span class='co'># function call with initial parameter values given by the user</span>
<span class='no'>l1</span> <span class='kw'>&lt;-</span> <span class='fu'>latentIV</span>(<span class='no'>y</span> ~ <span class='no'>P</span>, <span class='kw'>start.params</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"(Intercept)"</span><span class='kw'>=</span><span class='fl'>2.5</span>, <span class='kw'>P</span><span class='kw'>=</span>-<span class='fl'>0.5</span>),
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataLatentIV</span>)</div><div class='output co'>#&gt; <span class='message'>The start parameters c((Intercept)=2.5, P=-0.5, pi1=0.589, pi2=2.001, theta5=0.5, theta6=1, theta7=0.5, theta8=1) are used for optimization.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>l1</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; latentIV(formula = y ~ P, data = dataLatentIV, start.params = c(`(Intercept)` = 2.5, 
#&gt;     P = -0.5))
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z-score Pr(&gt;|z|)    
#&gt; (Intercept)  2.97611    0.02949  100.91   &lt;2e-16 ***
#&gt; P           -0.94434    0.03540  -26.68   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Further parameters estimated during model fitting:
#&gt;     pi1     pi2  theta5  theta6  theta7  theta8 
#&gt; 0.01376 2.18676 0.72090 0.97086 0.18639 1.05935 
#&gt; (see help file for details)
#&gt; 
#&gt; Initial parameter values:
#&gt; (Intercept)=2.5 P=-0.5 pi1=0.589 pi2=2.0011 theta5=0.5 theta6=1
#&gt; theta7=0.5 theta8=1
#&gt; 
#&gt; The value of the log-likelihood function: 7873.591 
#&gt; AIC: -15731.18 , BIC: -15684.59 
#&gt; KKT1: FALSE  KKT2: TRUE Optimx Convergence Code: 0 </div><div class='input'>
<span class='co'># use own optimization settings (see optimx())</span>
<span class='co'># set maximum number of iterations to 50'000</span>
<span class='no'>l2</span> <span class='kw'>&lt;-</span> <span class='fu'>latentIV</span>(<span class='no'>y</span> ~ <span class='no'>P</span>, <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>itnmax</span> <span class='kw'>=</span> <span class='fl'>50000</span>),
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataLatentIV</span>)</div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ P is fitted to derive them.</span></div><div class='output co'>#&gt; <span class='message'>The start parameters c((Intercept)=2.915, P=-0.852, pi1=0.589, pi2=2.001, theta5=0.5, theta6=1, theta7=0.5, theta8=1) are used for optimization.</span></div><div class='input'>
<span class='co'># print detailed tracing information on progress</span>
<span class='no'>l3</span> <span class='kw'>&lt;-</span> <span class='fu'>latentIV</span>(<span class='no'>y</span> ~ <span class='no'>P</span>, <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>6</span>)),
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataLatentIV</span>)</div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ P is fitted to derive them.</span></div><div class='output co'>#&gt; <span class='message'>The start parameters c((Intercept)=2.915, P=-0.852, pi1=0.589, pi2=2.001, theta5=0.5, theta6=1, theta7=0.5, theta8=1) are used for optimization.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  8  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.7657037   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 8
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, m.data.mvnorm, use.intercept, name.intercept, 
#&gt;     name.endo.param) 
#&gt; {
#&gt;     if (use.intercept) {
#&gt;         b00 &lt;- params[name.intercept]
#&gt;         a1 &lt;- params[name.endo.param]
#&gt;     }
#&gt;     else {
#&gt;         b00 &lt;- 0
#&gt;         a1 &lt;- params[name.endo.param]
#&gt;     }
#&gt;     pt &lt;- exp(params["theta5"])
#&gt;     pt &lt;- pt/(1 + pt)
#&gt;     m.sigma &lt;- matrix(c(params["theta6"], params["theta7"], params["theta7"], 
#&gt;         params["theta8"]), byrow = TRUE, ncol = 2, nrow = 2)
#&gt;     s2e &lt;- m.sigma[1, 1]
#&gt;     s2v &lt;- m.sigma[2, 2]
#&gt;     sev &lt;- m.sigma[1, 2]
#&gt;     varcov &lt;- matrix(0, 2, 2)
#&gt;     varcov[1, 1] &lt;- a1 * a1 * s2v + 2 * a1 * sev + s2e
#&gt;     varcov[2, 1] &lt;- a1 * s2v + sev
#&gt;     varcov[1, 2] &lt;- varcov[2, 1]
#&gt;     varcov[2, 2] &lt;- s2v
#&gt;     pi1 &lt;- params["pi1"]
#&gt;     mu1 &lt;- matrix(data = c(b00 + a1 * pi1, pi1), nrow = 2, ncol = 1)
#&gt;     pi2 &lt;- params["pi2"]
#&gt;     mu2 &lt;- matrix(c(b00 + a1 * pi2, pi2), nrow = 2, ncol = 1)
#&gt;     log.pdf1 &lt;- dmvnorm(m.data.mvnorm, mean = mu1, sigma = varcov, 
#&gt;         log = TRUE)
#&gt;     log.pdf2 &lt;- dmvnorm(m.data.mvnorm, mean = mu2, sigma = varcov, 
#&gt;         log = TRUE)
#&gt;     max.AB &lt;- pmax(log(pt) + log.pdf1, log(1 - pt) + log.pdf2)
#&gt;     logLL.lse &lt;- sum(max.AB + log(pt * exp(log.pdf1 - max.AB) + 
#&gt;         (1 - pt) * exp(log.pdf2 - max.AB)))
#&gt;     return(-1 * logLL.lse)
#&gt; }
#&gt; &lt;bytecode: 0x7fc0fa718390&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 8742.932040
#&gt;   Scaled convergence tolerance is 0.00013028
#&gt; Stepsize computed as 0.291524
#&gt; BUILD              9 11102.056553 8424.840299
#&gt; EXTENSION         11 9624.462289 8325.753007
#&gt; REFLECTION        13 9272.764194 8305.555394
#&gt; EXTENSION         15 8742.932040 7944.347065
#&gt; LO-REDUCTION      17 8703.872300 7944.347065
#&gt; LO-REDUCTION      19 8690.122323 7944.347065
#&gt; LO-REDUCTION      21 8680.249246 7944.347065
#&gt; LO-REDUCTION      23 8592.719293 7944.347065
#&gt; LO-REDUCTION      25 8424.840299 7944.347065
#&gt; LO-REDUCTION      27 8325.753007 7944.347065
#&gt; LO-REDUCTION      29 8305.555394 7944.347065
#&gt; LO-REDUCTION      31 8130.497227 7944.347065
#&gt; LO-REDUCTION      33 8114.012489 7944.347065
#&gt; LO-REDUCTION      35 8113.150479 7944.347065
#&gt; REFLECTION        37 8081.291967 7937.018590
#&gt; LO-REDUCTION      39 8077.875831 7937.018590
#&gt; LO-REDUCTION      41 8051.362993 7934.686437
#&gt; LO-REDUCTION      43 8011.993137 7924.134452
#&gt; REFLECTION        45 7957.286375 7906.855907
#&gt; HI-REDUCTION      47 7951.085472 7906.855907
#&gt; LO-REDUCTION      49 7946.239355 7906.855907
#&gt; LO-REDUCTION      51 7944.347065 7906.855907
#&gt; LO-REDUCTION      53 7937.652502 7906.855907
#&gt; LO-REDUCTION      55 7937.018590 7906.855907
#&gt; REFLECTION        57 7934.686437 7905.372810
#&gt; REFLECTION        59 7927.052505 7902.136181
#&gt; LO-REDUCTION      61 7924.134452 7902.136181
#&gt; REFLECTION        63 7921.069576 7893.709734
#&gt; LO-REDUCTION      65 7917.698438 7893.709734
#&gt; REFLECTION        67 7916.557036 7892.335377
#&gt; REFLECTION        69 7910.240349 7891.295754
#&gt; HI-REDUCTION      71 7908.458846 7891.295754
#&gt; LO-REDUCTION      73 7906.855907 7890.080494
#&gt; LO-REDUCTION      75 7905.372810 7890.080494
#&gt; LO-REDUCTION      77 7902.136181 7890.080494
#&gt; LO-REDUCTION      79 7898.525855 7890.080494
#&gt; LO-REDUCTION      81 7897.809519 7890.080494
#&gt; EXTENSION         83 7894.215378 7884.644817
#&gt; HI-REDUCTION      85 7893.709734 7884.644817
#&gt; LO-REDUCTION      87 7893.447130 7884.644817
#&gt; LO-REDUCTION      89 7892.335377 7884.644817
#&gt; HI-REDUCTION      91 7891.295754 7884.644817
#&gt; LO-REDUCTION      93 7890.923583 7884.644817
#&gt; REFLECTION        95 7890.221386 7884.554251
#&gt; LO-REDUCTION      97 7890.080494 7884.554251
#&gt; LO-REDUCTION      99 7889.589323 7884.554251
#&gt; REFLECTION       101 7888.284750 7883.793389
#&gt; LO-REDUCTION     103 7886.969431 7883.793389
#&gt; REFLECTION       105 7886.766207 7883.060300
#&gt; HI-REDUCTION     107 7886.700101 7883.060300
#&gt; REFLECTION       109 7885.826209 7883.036358
#&gt; REFLECTION       111 7884.841099 7882.527521
#&gt; REFLECTION       113 7884.675015 7882.360551
#&gt; LO-REDUCTION     115 7884.644817 7882.360551
#&gt; REFLECTION       117 7884.554251 7881.962927
#&gt; HI-REDUCTION     119 7884.461336 7881.962927
#&gt; EXTENSION        121 7883.793389 7880.668711
#&gt; LO-REDUCTION     123 7883.060300 7880.668711
#&gt; LO-REDUCTION     125 7883.036358 7880.668711
#&gt; LO-REDUCTION     127 7883.013367 7880.668711
#&gt; LO-REDUCTION     129 7882.890033 7880.668711
#&gt; LO-REDUCTION     131 7882.527521 7880.668711
#&gt; LO-REDUCTION     133 7882.360551 7880.668711
#&gt; LO-REDUCTION     135 7882.044811 7880.668711
#&gt; LO-REDUCTION     137 7881.962927 7880.668711
#&gt; LO-REDUCTION     139 7881.540015 7880.668711
#&gt; REFLECTION       141 7881.364098 7880.506212
#&gt; LO-REDUCTION     143 7881.209701 7880.506212
#&gt; LO-REDUCTION     145 7881.043959 7880.506212
#&gt; REFLECTION       147 7881.015615 7880.461745
#&gt; LO-REDUCTION     149 7880.945479 7880.461745
#&gt; LO-REDUCTION     151 7880.860779 7880.461745
#&gt; LO-REDUCTION     153 7880.765993 7880.461745
#&gt; LO-REDUCTION     155 7880.727698 7880.461745
#&gt; EXTENSION        157 7880.685065 7880.292296
#&gt; LO-REDUCTION     159 7880.668711 7880.292296
#&gt; LO-REDUCTION     161 7880.628690 7880.292296
#&gt; LO-REDUCTION     163 7880.569007 7880.292296
#&gt; LO-REDUCTION     165 7880.565565 7880.292296
#&gt; EXTENSION        167 7880.557113 7880.246277
#&gt; EXTENSION        169 7880.506212 7880.152925
#&gt; EXTENSION        171 7880.463658 7880.117354
#&gt; EXTENSION        173 7880.461745 7880.012803
#&gt; LO-REDUCTION     175 7880.355627 7880.012803
#&gt; EXTENSION        177 7880.334173 7879.829468
#&gt; LO-REDUCTION     179 7880.332691 7879.829468
#&gt; EXTENSION        181 7880.292296 7879.660900
#&gt; LO-REDUCTION     183 7880.246277 7879.660900
#&gt; LO-REDUCTION     185 7880.152925 7879.660900
#&gt; REFLECTION       187 7880.117354 7879.617674
#&gt; HI-REDUCTION     189 7880.117139 7879.617674
#&gt; EXTENSION        191 7880.012803 7879.268060
#&gt; LO-REDUCTION     193 7879.914322 7879.268060
#&gt; LO-REDUCTION     195 7879.829468 7879.268060
#&gt; LO-REDUCTION     197 7879.799598 7879.268060
#&gt; LO-REDUCTION     199 7879.783529 7879.268060
#&gt; LO-REDUCTION     201 7879.753101 7879.268060
#&gt; LO-REDUCTION     203 7879.660900 7879.268060
#&gt; LO-REDUCTION     205 7879.617674 7879.268060
#&gt; LO-REDUCTION     207 7879.585480 7879.268060
#&gt; LO-REDUCTION     209 7879.561489 7879.268060
#&gt; EXTENSION        211 7879.438207 7879.168968
#&gt; EXTENSION        213 7879.435870 7879.132444
#&gt; LO-REDUCTION     215 7879.428865 7879.132444
#&gt; EXTENSION        217 7879.385164 7878.968881
#&gt; LO-REDUCTION     219 7879.340957 7878.968881
#&gt; LO-REDUCTION     221 7879.305036 7878.968881
#&gt; EXTENSION        223 7879.281966 7878.760648
#&gt; LO-REDUCTION     225 7879.268060 7878.760648
#&gt; LO-REDUCTION     227 7879.195136 7878.760648
#&gt; LO-REDUCTION     229 7879.168968 7878.760648
#&gt; LO-REDUCTION     231 7879.132444 7878.760648
#&gt; LO-REDUCTION     233 7879.059316 7878.760648
#&gt; LO-REDUCTION     235 7878.975654 7878.760648
#&gt; EXTENSION        237 7878.971720 7878.655217
#&gt; LO-REDUCTION     239 7878.968881 7878.655217
#&gt; EXTENSION        241 7878.903387 7878.616791
#&gt; EXTENSION        243 7878.844085 7878.494173
#&gt; LO-REDUCTION     245 7878.827880 7878.494173
#&gt; LO-REDUCTION     247 7878.808252 7878.494173
#&gt; REFLECTION       249 7878.800476 7878.442731
#&gt; REFLECTION       251 7878.760648 7878.408916
#&gt; LO-REDUCTION     253 7878.715302 7878.408916
#&gt; EXTENSION        255 7878.655217 7878.025805
#&gt; LO-REDUCTION     257 7878.616791 7878.025805
#&gt; LO-REDUCTION     259 7878.571245 7878.025805
#&gt; LO-REDUCTION     261 7878.509654 7878.025805
#&gt; LO-REDUCTION     263 7878.494173 7878.025805
#&gt; LO-REDUCTION     265 7878.442731 7878.025805
#&gt; LO-REDUCTION     267 7878.438463 7878.025805
#&gt; EXTENSION        269 7878.408916 7877.760970
#&gt; LO-REDUCTION     271 7878.342853 7877.760970
#&gt; LO-REDUCTION     273 7878.329483 7877.760970
#&gt; EXTENSION        275 7878.266674 7877.596564
#&gt; LO-REDUCTION     277 7878.144760 7877.596564
#&gt; LO-REDUCTION     279 7878.132136 7877.596564
#&gt; EXTENSION        281 7878.041083 7877.397780
#&gt; LO-REDUCTION     283 7878.025805 7877.397780
#&gt; EXTENSION        285 7877.983724 7877.329001
#&gt; EXTENSION        287 7877.918973 7877.238097
#&gt; REFLECTION       289 7877.760970 7877.212135
#&gt; LO-REDUCTION     291 7877.670399 7877.212135
#&gt; LO-REDUCTION     293 7877.629038 7877.212135
#&gt; LO-REDUCTION     295 7877.596564 7877.212135
#&gt; LO-REDUCTION     297 7877.507114 7877.212135
#&gt; REFLECTION       299 7877.397780 7877.196937
#&gt; HI-REDUCTION     301 7877.329001 7877.196937
#&gt; REFLECTION       303 7877.295556 7877.181607
#&gt; EXTENSION        305 7877.262602 7876.954473
#&gt; LO-REDUCTION     307 7877.258082 7876.954473
#&gt; LO-REDUCTION     309 7877.247359 7876.954473
#&gt; LO-REDUCTION     311 7877.238097 7876.954473
#&gt; LO-REDUCTION     313 7877.230412 7876.954473
#&gt; LO-REDUCTION     315 7877.212135 7876.954473
#&gt; LO-REDUCTION     317 7877.196937 7876.954473
#&gt; LO-REDUCTION     319 7877.181607 7876.954473
#&gt; EXTENSION        321 7877.110460 7876.856400
#&gt; EXTENSION        323 7877.089184 7876.739058
#&gt; LO-REDUCTION     325 7877.082864 7876.739058
#&gt; EXTENSION        327 7877.053283 7876.549872
#&gt; LO-REDUCTION     329 7876.986577 7876.549872
#&gt; LO-REDUCTION     331 7876.986009 7876.549872
#&gt; LO-REDUCTION     333 7876.980204 7876.549872
#&gt; LO-REDUCTION     335 7876.954473 7876.549872
#&gt; EXTENSION        337 7876.856400 7876.237010
#&gt; LO-REDUCTION     339 7876.787029 7876.237010
#&gt; LO-REDUCTION     341 7876.739058 7876.237010
#&gt; LO-REDUCTION     343 7876.687658 7876.237010
#&gt; LO-REDUCTION     345 7876.671107 7876.237010
#&gt; EXTENSION        347 7876.633511 7876.153356
#&gt; EXTENSION        349 7876.551829 7876.031788
#&gt; EXTENSION        351 7876.549872 7875.881384
#&gt; LO-REDUCTION     353 7876.513139 7875.881384
#&gt; EXTENSION        355 7876.413540 7875.562368
#&gt; LO-REDUCTION     357 7876.311302 7875.562368
#&gt; LO-REDUCTION     359 7876.275977 7875.562368
#&gt; LO-REDUCTION     361 7876.237010 7875.562368
#&gt; LO-REDUCTION     363 7876.153356 7875.562368
#&gt; LO-REDUCTION     365 7876.031788 7875.562368
#&gt; LO-REDUCTION     367 7875.992399 7875.562368
#&gt; EXTENSION        369 7875.889476 7875.437998
#&gt; EXTENSION        371 7875.881384 7875.214806
#&gt; LO-REDUCTION     373 7875.839502 7875.214806
#&gt; LO-REDUCTION     375 7875.799629 7875.214806
#&gt; EXTENSION        377 7875.779035 7874.979370
#&gt; LO-REDUCTION     379 7875.673535 7874.979370
#&gt; LO-REDUCTION     381 7875.657270 7874.979370
#&gt; EXTENSION        383 7875.562368 7874.951503
#&gt; LO-REDUCTION     385 7875.438713 7874.951503
#&gt; EXTENSION        387 7875.437998 7874.595900
#&gt; EXTENSION        389 7875.304646 7874.444334
#&gt; LO-REDUCTION     391 7875.246611 7874.444334
#&gt; EXTENSION        393 7875.214806 7874.127223
#&gt; LO-REDUCTION     395 7875.046483 7874.127223
#&gt; LO-REDUCTION     397 7875.012419 7874.127223
#&gt; LO-REDUCTION     399 7874.979370 7874.127223
#&gt; LO-REDUCTION     401 7874.951503 7874.127223
#&gt; LO-REDUCTION     403 7874.595900 7874.127223
#&gt; LO-REDUCTION     405 7874.566430 7874.127223
#&gt; EXTENSION        407 7874.495020 7874.101348
#&gt; EXTENSION        409 7874.492839 7873.967425
#&gt; LO-REDUCTION     411 7874.444334 7873.967425
#&gt; REFLECTION       413 7874.343326 7873.921079
#&gt; REFLECTION       415 7874.310502 7873.850982
#&gt; LO-REDUCTION     417 7874.219801 7873.850982
#&gt; LO-REDUCTION     419 7874.138834 7873.850982
#&gt; LO-REDUCTION     421 7874.127223 7873.850982
#&gt; LO-REDUCTION     423 7874.101348 7873.850982
#&gt; EXTENSION        425 7874.081124 7873.783880
#&gt; LO-REDUCTION     427 7873.983422 7873.783880
#&gt; LO-REDUCTION     429 7873.982819 7873.783880
#&gt; LO-REDUCTION     431 7873.977598 7873.783880
#&gt; EXTENSION        433 7873.967425 7873.747915
#&gt; LO-REDUCTION     435 7873.964820 7873.747915
#&gt; LO-REDUCTION     437 7873.921079 7873.742302
#&gt; LO-REDUCTION     439 7873.850982 7873.742302
#&gt; LO-REDUCTION     441 7873.843559 7873.742302
#&gt; EXTENSION        443 7873.838925 7873.670492
#&gt; LO-REDUCTION     445 7873.826824 7873.670492
#&gt; LO-REDUCTION     447 7873.783880 7873.670492
#&gt; LO-REDUCTION     449 7873.768364 7873.670492
#&gt; LO-REDUCTION     451 7873.752220 7873.670492
#&gt; HI-REDUCTION     453 7873.747915 7873.670492
#&gt; LO-REDUCTION     455 7873.743085 7873.670492
#&gt; LO-REDUCTION     457 7873.742302 7873.670492
#&gt; LO-REDUCTION     459 7873.727311 7873.670492
#&gt; REFLECTION       461 7873.706839 7873.663163
#&gt; LO-REDUCTION     463 7873.694156 7873.663163
#&gt; LO-REDUCTION     465 7873.693556 7873.663163
#&gt; LO-REDUCTION     467 7873.693149 7873.663163
#&gt; LO-REDUCTION     469 7873.680706 7873.663163
#&gt; REFLECTION       471 7873.679782 7873.658683
#&gt; LO-REDUCTION     473 7873.677118 7873.658683
#&gt; HI-REDUCTION     475 7873.673279 7873.658683
#&gt; EXTENSION        477 7873.670492 7873.649404
#&gt; LO-REDUCTION     479 7873.668406 7873.649404
#&gt; EXTENSION        481 7873.667615 7873.645688
#&gt; LO-REDUCTION     483 7873.665794 7873.645688
#&gt; LO-REDUCTION     485 7873.665673 7873.645688
#&gt; LO-REDUCTION     487 7873.663163 7873.645688
#&gt; REFLECTION       489 7873.661091 7873.642268
#&gt; EXTENSION        491 7873.658683 7873.625179
#&gt; LO-REDUCTION     493 7873.657071 7873.625179
#&gt; LO-REDUCTION     495 7873.652898 7873.625179
#&gt; LO-REDUCTION     497 7873.649954 7873.625179
#&gt; LO-REDUCTION     499 7873.649404 7873.625179
#&gt; EXTENSION        501 7873.645933 7873.617972
#&gt; EXTENSION        503 7873.645688 7873.609255
#&gt; LO-REDUCTION     505 7873.642268 7873.609255
#&gt; LO-REDUCTION     507 7873.642057 7873.609255
#&gt; EXTENSION        509 7873.635016 7873.582029
#&gt; LO-REDUCTION     511 7873.627337 7873.582029
#&gt; LO-REDUCTION     513 7873.625601 7873.582029
#&gt; LO-REDUCTION     515 7873.625179 7873.582029
#&gt; EXTENSION        517 7873.618683 7873.574109
#&gt; LO-REDUCTION     519 7873.617972 7873.574109
#&gt; LO-REDUCTION     521 7873.615075 7873.574109
#&gt; LO-REDUCTION     523 7873.609255 7873.574109
#&gt; REFLECTION       525 7873.599968 7873.573347
#&gt; EXTENSION        527 7873.599411 7873.544108
#&gt; LO-REDUCTION     529 7873.587268 7873.544108
#&gt; LO-REDUCTION     531 7873.585021 7873.544108
#&gt; LO-REDUCTION     533 7873.582029 7873.544108
#&gt; LO-REDUCTION     535 7873.580517 7873.544108
#&gt; LO-REDUCTION     537 7873.575567 7873.544108
#&gt; LO-REDUCTION     539 7873.574109 7873.544108
#&gt; LO-REDUCTION     541 7873.573347 7873.544108
#&gt; EXTENSION        543 7873.557222 7873.521072
#&gt; LO-REDUCTION     545 7873.556680 7873.521072
#&gt; LO-REDUCTION     547 7873.554481 7873.521072
#&gt; LO-REDUCTION     549 7873.552024 7873.521072
#&gt; LO-REDUCTION     551 7873.551309 7873.521072
#&gt; EXTENSION        553 7873.549423 7873.502281
#&gt; LO-REDUCTION     555 7873.544967 7873.502281
#&gt; LO-REDUCTION     557 7873.544108 7873.502281
#&gt; LO-REDUCTION     559 7873.533628 7873.502281
#&gt; LO-REDUCTION     561 7873.529218 7873.502281
#&gt; REFLECTION       563 7873.528686 7873.501992
#&gt; REFLECTION       565 7873.526832 7873.501979
#&gt; REFLECTION       567 7873.521072 7873.496847
#&gt; LO-REDUCTION     569 7873.513217 7873.496847
#&gt; REFLECTION       571 7873.510430 7873.495121
#&gt; EXTENSION        573 7873.506431 7873.490333
#&gt; LO-REDUCTION     575 7873.502946 7873.490333
#&gt; REFLECTION       577 7873.502281 7873.488898
#&gt; LO-REDUCTION     579 7873.501992 7873.488898
#&gt; LO-REDUCTION     581 7873.501979 7873.488898
#&gt; LO-REDUCTION     583 7873.497228 7873.488898
#&gt; HI-REDUCTION     585 7873.496847 7873.488898
#&gt; LO-REDUCTION     587 7873.495121 7873.488898
#&gt; HI-REDUCTION     589 7873.494892 7873.488898
#&gt; REFLECTION       591 7873.493812 7873.488551
#&gt; EXTENSION        593 7873.492191 7873.484993
#&gt; LO-REDUCTION     595 7873.491183 7873.484993
#&gt; LO-REDUCTION     597 7873.490614 7873.484993
#&gt; LO-REDUCTION     599 7873.490333 7873.484993
#&gt; LO-REDUCTION     601 7873.489726 7873.484993
#&gt; LO-REDUCTION     603 7873.488979 7873.484993
#&gt; REFLECTION       605 7873.488898 7873.484879
#&gt; LO-REDUCTION     607 7873.488551 7873.484879
#&gt; LO-REDUCTION     609 7873.487332 7873.484739
#&gt; REFLECTION       611 7873.487115 7873.483926
#&gt; LO-REDUCTION     613 7873.487042 7873.483926
#&gt; LO-REDUCTION     615 7873.486005 7873.483926
#&gt; EXTENSION        617 7873.485945 7873.481990
#&gt; LO-REDUCTION     619 7873.485063 7873.481990
#&gt; LO-REDUCTION     621 7873.484993 7873.481990
#&gt; LO-REDUCTION     623 7873.484879 7873.481990
#&gt; LO-REDUCTION     625 7873.484739 7873.481990
#&gt; LO-REDUCTION     627 7873.484430 7873.481990
#&gt; EXTENSION        629 7873.483966 7873.480264
#&gt; LO-REDUCTION     631 7873.483926 7873.480264
#&gt; LO-REDUCTION     633 7873.483886 7873.480264
#&gt; LO-REDUCTION     635 7873.483686 7873.480264
#&gt; EXTENSION        637 7873.483379 7873.478829
#&gt; LO-REDUCTION     639 7873.483198 7873.478829
#&gt; LO-REDUCTION     641 7873.482537 7873.478829
#&gt; LO-REDUCTION     643 7873.481990 7873.478829
#&gt; EXTENSION        645 7873.481699 7873.477523
#&gt; LO-REDUCTION     647 7873.481560 7873.477523
#&gt; EXTENSION        649 7873.481291 7873.474958
#&gt; LO-REDUCTION     651 7873.480264 7873.474958
#&gt; LO-REDUCTION     653 7873.480125 7873.474958
#&gt; LO-REDUCTION     655 7873.479825 7873.474958
#&gt; EXTENSION        657 7873.478932 7873.471649
#&gt; LO-REDUCTION     659 7873.478829 7873.471649
#&gt; LO-REDUCTION     661 7873.477619 7873.471649
#&gt; LO-REDUCTION     663 7873.477523 7873.471649
#&gt; LO-REDUCTION     665 7873.476761 7873.471649
#&gt; LO-REDUCTION     667 7873.476718 7873.471649
#&gt; EXTENSION        669 7873.476336 7873.470920
#&gt; EXTENSION        671 7873.474958 7873.467269
#&gt; LO-REDUCTION     673 7873.474719 7873.467269
#&gt; LO-REDUCTION     675 7873.474430 7873.467269
#&gt; EXTENSION        677 7873.473312 7873.464401
#&gt; LO-REDUCTION     679 7873.473288 7873.464401
#&gt; LO-REDUCTION     681 7873.472276 7873.464401
#&gt; LO-REDUCTION     683 7873.471649 7873.464401
#&gt; LO-REDUCTION     685 7873.470920 7873.464401
#&gt; EXTENSION        687 7873.470326 7873.460417
#&gt; LO-REDUCTION     689 7873.469271 7873.460417
#&gt; LO-REDUCTION     691 7873.467269 7873.460417
#&gt; LO-REDUCTION     693 7873.467147 7873.460417
#&gt; EXTENSION        695 7873.466899 7873.456121
#&gt; LO-REDUCTION     697 7873.466173 7873.456121
#&gt; LO-REDUCTION     699 7873.465248 7873.456121
#&gt; EXTENSION        701 7873.464401 7873.454121
#&gt; LO-REDUCTION     703 7873.462947 7873.454121
#&gt; EXTENSION        705 7873.461762 7873.451189
#&gt; LO-REDUCTION     707 7873.461244 7873.451189
#&gt; EXTENSION        709 7873.460417 7873.448989
#&gt; EXTENSION        711 7873.458872 7873.443598
#&gt; LO-REDUCTION     713 7873.457406 7873.443598
#&gt; LO-REDUCTION     715 7873.456121 7873.443598
#&gt; LO-REDUCTION     717 7873.454768 7873.443598
#&gt; LO-REDUCTION     719 7873.454121 7873.443598
#&gt; LO-REDUCTION     721 7873.452064 7873.443598
#&gt; LO-REDUCTION     723 7873.451189 7873.443598
#&gt; LO-REDUCTION     725 7873.449800 7873.443598
#&gt; LO-REDUCTION     727 7873.449744 7873.443598
#&gt; LO-REDUCTION     729 7873.448989 7873.443598
#&gt; REFLECTION       731 7873.446894 7873.442969
#&gt; EXTENSION        733 7873.446574 7873.442182
#&gt; EXTENSION        735 7873.446001 7873.438511
#&gt; LO-REDUCTION     737 7873.445895 7873.438511
#&gt; EXTENSION        739 7873.445438 7873.435462
#&gt; LO-REDUCTION     741 7873.444508 7873.435462
#&gt; LO-REDUCTION     743 7873.443663 7873.435462
#&gt; LO-REDUCTION     745 7873.443598 7873.435462
#&gt; EXTENSION        747 7873.442969 7873.434681
#&gt; LO-REDUCTION     749 7873.442182 7873.434681
#&gt; EXTENSION        751 7873.440886 7873.427479
#&gt; LO-REDUCTION     753 7873.438784 7873.427479
#&gt; LO-REDUCTION     755 7873.438511 7873.427479
#&gt; LO-REDUCTION     757 7873.437999 7873.427479
#&gt; LO-REDUCTION     759 7873.436864 7873.427479
#&gt; EXTENSION        761 7873.436042 7873.427155
#&gt; EXTENSION        763 7873.435462 7873.423607
#&gt; LO-REDUCTION     765 7873.434681 7873.423607
#&gt; EXTENSION        767 7873.431663 7873.415235
#&gt; LO-REDUCTION     769 7873.430635 7873.415235
#&gt; LO-REDUCTION     771 7873.429266 7873.415235
#&gt; LO-REDUCTION     773 7873.428377 7873.415235
#&gt; LO-REDUCTION     775 7873.427479 7873.415235
#&gt; LO-REDUCTION     777 7873.427155 7873.415235
#&gt; LO-REDUCTION     779 7873.426117 7873.415235
#&gt; EXTENSION        781 7873.423678 7873.413749
#&gt; EXTENSION        783 7873.423607 7873.410755
#&gt; EXTENSION        785 7873.421180 7873.409932
#&gt; REFLECTION       787 7873.420377 7873.408827
#&gt; LO-REDUCTION     789 7873.419484 7873.408827
#&gt; LO-REDUCTION     791 7873.419444 7873.408827
#&gt; LO-REDUCTION     793 7873.416098 7873.408827
#&gt; REFLECTION       795 7873.415235 7873.408700
#&gt; HI-REDUCTION     797 7873.413749 7873.408700
#&gt; LO-REDUCTION     799 7873.410755 7873.408700
#&gt; LO-REDUCTION     801 7873.410382 7873.408700
#&gt; HI-REDUCTION     803 7873.409996 7873.408700
#&gt; LO-REDUCTION     805 7873.409932 7873.408618
#&gt; REFLECTION       807 7873.409775 7873.408476
#&gt; REFLECTION       809 7873.409367 7873.408224
#&gt; EXTENSION        811 7873.409104 7873.407191
#&gt; LO-REDUCTION     813 7873.409007 7873.407191
#&gt; LO-REDUCTION     815 7873.409002 7873.407191
#&gt; REFLECTION       817 7873.408827 7873.407100
#&gt; LO-REDUCTION     819 7873.408700 7873.407100
#&gt; LO-REDUCTION     821 7873.408618 7873.407100
#&gt; EXTENSION        823 7873.408476 7873.404994
#&gt; LO-REDUCTION     825 7873.408224 7873.404994
#&gt; LO-REDUCTION     827 7873.407767 7873.404994
#&gt; LO-REDUCTION     829 7873.407584 7873.404994
#&gt; LO-REDUCTION     831 7873.407297 7873.404994
#&gt; LO-REDUCTION     833 7873.407191 7873.404994
#&gt; LO-REDUCTION     835 7873.407147 7873.404994
#&gt; EXTENSION        837 7873.407100 7873.403559
#&gt; EXTENSION        839 7873.406847 7873.402593
#&gt; LO-REDUCTION     841 7873.405530 7873.402593
#&gt; LO-REDUCTION     843 7873.405389 7873.402593
#&gt; LO-REDUCTION     845 7873.405383 7873.402593
#&gt; EXTENSION        847 7873.405068 7873.400300
#&gt; LO-REDUCTION     849 7873.405001 7873.400300
#&gt; LO-REDUCTION     851 7873.404994 7873.400300
#&gt; REFLECTION       853 7873.403559 7873.399970
#&gt; LO-REDUCTION     855 7873.403085 7873.399970
#&gt; LO-REDUCTION     857 7873.402983 7873.399970
#&gt; EXTENSION        859 7873.402648 7873.398938
#&gt; EXTENSION        861 7873.402593 7873.397505
#&gt; LO-REDUCTION     863 7873.401110 7873.397505
#&gt; LO-REDUCTION     865 7873.400933 7873.397505
#&gt; LO-REDUCTION     867 7873.400567 7873.397505
#&gt; REFLECTION       869 7873.400371 7873.397392
#&gt; REFLECTION       871 7873.400300 7873.397190
#&gt; LO-REDUCTION     873 7873.399970 7873.397190
#&gt; LO-REDUCTION     875 7873.398938 7873.397190
#&gt; LO-REDUCTION     877 7873.398449 7873.397190
#&gt; EXTENSION        879 7873.398253 7873.396296
#&gt; LO-REDUCTION     881 7873.397865 7873.396296
#&gt; LO-REDUCTION     883 7873.397552 7873.396296
#&gt; LO-REDUCTION     885 7873.397505 7873.396296
#&gt; HI-REDUCTION     887 7873.397469 7873.396296
#&gt; REFLECTION       889 7873.397392 7873.396167
#&gt; LO-REDUCTION     891 7873.397225 7873.396167
#&gt; EXTENSION        893 7873.397190 7873.395257
#&gt; EXTENSION        895 7873.396851 7873.394744
#&gt; LO-REDUCTION     897 7873.396699 7873.394744
#&gt; EXTENSION        899 7873.396469 7873.393910
#&gt; LO-REDUCTION     901 7873.396373 7873.393910
#&gt; LO-REDUCTION     903 7873.396296 7873.393910
#&gt; LO-REDUCTION     905 7873.396293 7873.393910
#&gt; EXTENSION        907 7873.396167 7873.393169
#&gt; LO-REDUCTION     909 7873.395459 7873.393169
#&gt; EXTENSION        911 7873.395257 7873.391089
#&gt; LO-REDUCTION     913 7873.394837 7873.391089
#&gt; LO-REDUCTION     915 7873.394760 7873.391089
#&gt; LO-REDUCTION     917 7873.394744 7873.391089
#&gt; LO-REDUCTION     919 7873.394281 7873.391089
#&gt; LO-REDUCTION     921 7873.393910 7873.391089
#&gt; LO-REDUCTION     923 7873.393608 7873.391089
#&gt; LO-REDUCTION     925 7873.393405 7873.391089
#&gt; EXTENSION        927 7873.393169 7873.390186
#&gt; LO-REDUCTION     929 7873.392917 7873.390186
#&gt; EXTENSION        931 7873.392244 7873.389692
#&gt; LO-REDUCTION     933 7873.392234 7873.389692
#&gt; EXTENSION        935 7873.392018 7873.387249
#&gt; LO-REDUCTION     937 7873.391551 7873.387249
#&gt; LO-REDUCTION     939 7873.391287 7873.387249
#&gt; EXTENSION        941 7873.391089 7873.386046
#&gt; LO-REDUCTION     943 7873.390381 7873.386046
#&gt; EXTENSION        945 7873.390186 7873.384738
#&gt; LO-REDUCTION     947 7873.389764 7873.384738
#&gt; LO-REDUCTION     949 7873.389692 7873.384738
#&gt; EXTENSION        951 7873.387794 7873.382773
#&gt; LO-REDUCTION     953 7873.387778 7873.382773
#&gt; LO-REDUCTION     955 7873.387267 7873.382773
#&gt; EXTENSION        957 7873.387249 7873.380669
#&gt; LO-REDUCTION     959 7873.386288 7873.380669
#&gt; LO-REDUCTION     961 7873.386046 7873.380669
#&gt; LO-REDUCTION     963 7873.384925 7873.380669
#&gt; EXTENSION        965 7873.384738 7873.379951
#&gt; LO-REDUCTION     967 7873.384083 7873.379951
#&gt; EXTENSION        969 7873.383650 7873.377437
#&gt; LO-REDUCTION     971 7873.383169 7873.377437
#&gt; LO-REDUCTION     973 7873.382773 7873.377437
#&gt; LO-REDUCTION     975 7873.382607 7873.377437
#&gt; EXTENSION        977 7873.381259 7873.374642
#&gt; LO-REDUCTION     979 7873.380669 7873.374642
#&gt; HI-REDUCTION     981 7873.380010 7873.374642
#&gt; LO-REDUCTION     983 7873.379951 7873.374642
#&gt; LO-REDUCTION     985 7873.378990 7873.374642
#&gt; LO-REDUCTION     987 7873.378600 7873.374642
#&gt; LO-REDUCTION     989 7873.378321 7873.374642
#&gt; LO-REDUCTION     991 7873.377814 7873.374642
#&gt; LO-REDUCTION     993 7873.377736 7873.374642
#&gt; EXTENSION        995 7873.377437 7873.371732
#&gt; LO-REDUCTION     997 7873.376019 7873.371732
#&gt; LO-REDUCTION     999 7873.375561 7873.371732
#&gt; LO-REDUCTION    1001 7873.375208 7873.371732
#&gt; LO-REDUCTION    1003 7873.374979 7873.371732
#&gt; EXTENSION       1005 7873.374813 7873.371066
#&gt; LO-REDUCTION    1007 7873.374664 7873.371066
#&gt; LO-REDUCTION    1009 7873.374642 7873.371066
#&gt; REFLECTION      1011 7873.373421 7873.370501
#&gt; EXTENSION       1013 7873.372471 7873.368264
#&gt; LO-REDUCTION    1015 7873.372039 7873.368264
#&gt; LO-REDUCTION    1017 7873.372032 7873.368264
#&gt; LO-REDUCTION    1019 7873.371732 7873.368264
#&gt; LO-REDUCTION    1021 7873.371695 7873.368264
#&gt; EXTENSION       1023 7873.371635 7873.367673
#&gt; LO-REDUCTION    1025 7873.371066 7873.367673
#&gt; LO-REDUCTION    1027 7873.370501 7873.367673
#&gt; LO-REDUCTION    1029 7873.370031 7873.367673
#&gt; EXTENSION       1031 7873.369563 7873.367261
#&gt; EXTENSION       1033 7873.369368 7873.365073
#&gt; LO-REDUCTION    1035 7873.369179 7873.365073
#&gt; LO-REDUCTION    1037 7873.368427 7873.365073
#&gt; EXTENSION       1039 7873.368264 7873.363784
#&gt; LO-REDUCTION    1041 7873.368264 7873.363784
#&gt; LO-REDUCTION    1043 7873.367830 7873.363784
#&gt; LO-REDUCTION    1045 7873.367673 7873.363784
#&gt; LO-REDUCTION    1047 7873.367261 7873.363784
#&gt; EXTENSION       1049 7873.366801 7873.362781
#&gt; EXTENSION       1051 7873.365493 7873.360155
#&gt; LO-REDUCTION    1053 7873.365465 7873.360155
#&gt; LO-REDUCTION    1055 7873.365415 7873.360155
#&gt; LO-REDUCTION    1057 7873.365073 7873.360155
#&gt; EXTENSION       1059 7873.364091 7873.359633
#&gt; REFLECTION      1061 7873.363786 7873.359459
#&gt; LO-REDUCTION    1063 7873.363784 7873.359459
#&gt; EXTENSION       1065 7873.362781 7873.357881
#&gt; LO-REDUCTION    1067 7873.361532 7873.357881
#&gt; LO-REDUCTION    1069 7873.361154 7873.357881
#&gt; LO-REDUCTION    1071 7873.360600 7873.357881
#&gt; LO-REDUCTION    1073 7873.360155 7873.357881
#&gt; LO-REDUCTION    1075 7873.359769 7873.357881
#&gt; LO-REDUCTION    1077 7873.359633 7873.357881
#&gt; REFLECTION      1079 7873.359459 7873.357849
#&gt; REFLECTION      1081 7873.358683 7873.357736
#&gt; EXTENSION       1083 7873.358268 7873.356832
#&gt; LO-REDUCTION    1085 7873.358217 7873.356832
#&gt; LO-REDUCTION    1087 7873.358177 7873.356832
#&gt; REFLECTION      1089 7873.358082 7873.356818
#&gt; EXTENSION       1091 7873.358023 7873.356123
#&gt; HI-REDUCTION    1093 7873.357881 7873.356123
#&gt; LO-REDUCTION    1095 7873.357849 7873.356123
#&gt; LO-REDUCTION    1097 7873.357736 7873.356123
#&gt; REFLECTION      1099 7873.357051 7873.356002
#&gt; EXTENSION       1101 7873.357050 7873.355468
#&gt; EXTENSION       1103 7873.356832 7873.354776
#&gt; LO-REDUCTION    1105 7873.356818 7873.354776
#&gt; LO-REDUCTION    1107 7873.356791 7873.354776
#&gt; LO-REDUCTION    1109 7873.356509 7873.354776
#&gt; REFLECTION      1111 7873.356382 7873.354713
#&gt; LO-REDUCTION    1113 7873.356123 7873.354713
#&gt; REFLECTION      1115 7873.356002 7873.354493
#&gt; REFLECTION      1117 7873.355518 7873.354353
#&gt; EXTENSION       1119 7873.355468 7873.353795
#&gt; LO-REDUCTION    1121 7873.355237 7873.353795
#&gt; LO-REDUCTION    1123 7873.355096 7873.353795
#&gt; LO-REDUCTION    1125 7873.354916 7873.353795
#&gt; EXTENSION       1127 7873.354776 7873.352967
#&gt; LO-REDUCTION    1129 7873.354713 7873.352967
#&gt; LO-REDUCTION    1131 7873.354493 7873.352967
#&gt; EXTENSION       1133 7873.354353 7873.351907
#&gt; LO-REDUCTION    1135 7873.354045 7873.351907
#&gt; LO-REDUCTION    1137 7873.353875 7873.351907
#&gt; LO-REDUCTION    1139 7873.353873 7873.351907
#&gt; LO-REDUCTION    1141 7873.353795 7873.351907
#&gt; EXTENSION       1143 7873.353153 7873.351113
#&gt; LO-REDUCTION    1145 7873.353064 7873.351113
#&gt; LO-REDUCTION    1147 7873.352967 7873.351113
#&gt; REFLECTION      1149 7873.352753 7873.351074
#&gt; EXTENSION       1151 7873.352681 7873.349926
#&gt; LO-REDUCTION    1153 7873.352241 7873.349926
#&gt; LO-REDUCTION    1155 7873.352143 7873.349926
#&gt; LO-REDUCTION    1157 7873.351907 7873.349926
#&gt; LO-REDUCTION    1159 7873.351181 7873.349926
#&gt; LO-REDUCTION    1161 7873.351162 7873.349926
#&gt; LO-REDUCTION    1163 7873.351113 7873.349926
#&gt; LO-REDUCTION    1165 7873.351074 7873.349926
#&gt; REFLECTION      1167 7873.350719 7873.349709
#&gt; REFLECTION      1169 7873.350401 7873.349570
#&gt; EXTENSION       1171 7873.350307 7873.349441
#&gt; HI-REDUCTION    1173 7873.350209 7873.349441
#&gt; EXTENSION       1175 7873.350163 7873.349170
#&gt; LO-REDUCTION    1177 7873.350152 7873.349170
#&gt; EXTENSION       1179 7873.349981 7873.348487
#&gt; LO-REDUCTION    1181 7873.349926 7873.348487
#&gt; LO-REDUCTION    1183 7873.349841 7873.348487
#&gt; LO-REDUCTION    1185 7873.349709 7873.348487
#&gt; LO-REDUCTION    1187 7873.349570 7873.348487
#&gt; EXTENSION       1189 7873.349441 7873.348184
#&gt; EXTENSION       1191 7873.349188 7873.347291
#&gt; LO-REDUCTION    1193 7873.349170 7873.347291
#&gt; LO-REDUCTION    1195 7873.348920 7873.347291
#&gt; LO-REDUCTION    1197 7873.348713 7873.347291
#&gt; LO-REDUCTION    1199 7873.348667 7873.347291
#&gt; REFLECTION      1201 7873.348497 7873.347168
#&gt; LO-REDUCTION    1203 7873.348487 7873.347168
#&gt; REFLECTION      1205 7873.348184 7873.347091
#&gt; EXTENSION       1207 7873.347835 7873.346777
#&gt; EXTENSION       1209 7873.347816 7873.346464
#&gt; LO-REDUCTION    1211 7873.347670 7873.346464
#&gt; LO-REDUCTION    1213 7873.347454 7873.346464
#&gt; REFLECTION      1215 7873.347361 7873.346413
#&gt; REFLECTION      1217 7873.347291 7873.346256
#&gt; REFLECTION      1219 7873.347168 7873.346148
#&gt; LO-REDUCTION    1221 7873.347091 7873.346148
#&gt; HI-REDUCTION    1223 7873.346939 7873.346148
#&gt; REFLECTION      1225 7873.346777 7873.345928
#&gt; LO-REDUCTION    1227 7873.346508 7873.345928
#&gt; LO-REDUCTION    1229 7873.346464 7873.345928
#&gt; LO-REDUCTION    1231 7873.346458 7873.345928
#&gt; LO-REDUCTION    1233 7873.346413 7873.345928
#&gt; LO-REDUCTION    1235 7873.346256 7873.345928
#&gt; LO-REDUCTION    1237 7873.346222 7873.345928
#&gt; LO-REDUCTION    1239 7873.346167 7873.345928
#&gt; EXTENSION       1241 7873.346148 7873.345718
#&gt; LO-REDUCTION    1243 7873.346064 7873.345718
#&gt; LO-REDUCTION    1245 7873.346049 7873.345718
#&gt; LO-REDUCTION    1247 7873.346046 7873.345718
#&gt; LO-REDUCTION    1249 7873.345997 7873.345718
#&gt; LO-REDUCTION    1251 7873.345996 7873.345718
#&gt; LO-REDUCTION    1253 7873.345940 7873.345718
#&gt; LO-REDUCTION    1255 7873.345928 7873.345718
#&gt; EXTENSION       1257 7873.345908 7873.345621
#&gt; EXTENSION       1259 7873.345848 7873.345579
#&gt; EXTENSION       1261 7873.345814 7873.345299
#&gt; LO-REDUCTION    1263 7873.345750 7873.345299
#&gt; LO-REDUCTION    1265 7873.345750 7873.345299
#&gt; LO-REDUCTION    1267 7873.345741 7873.345299
#&gt; LO-REDUCTION    1269 7873.345733 7873.345299
#&gt; LO-REDUCTION    1271 7873.345718 7873.345299
#&gt; EXTENSION       1273 7873.345621 7873.345176
#&gt; EXTENSION       1275 7873.345579 7873.345023
#&gt; LO-REDUCTION    1277 7873.345533 7873.345023
#&gt; LO-REDUCTION    1279 7873.345496 7873.345023
#&gt; EXTENSION       1281 7873.345478 7873.345003
#&gt; REFLECTION      1283 7873.345427 7873.344920
#&gt; REFLECTION      1285 7873.345367 7873.344868
#&gt; REFLECTION      1287 7873.345299 7873.344845
#&gt; LO-REDUCTION    1289 7873.345176 7873.344845
#&gt; LO-REDUCTION    1291 7873.345165 7873.344845
#&gt; REFLECTION      1293 7873.345057 7873.344721
#&gt; HI-REDUCTION    1295 7873.345023 7873.344721
#&gt; LO-REDUCTION    1297 7873.345003 7873.344721
#&gt; LO-REDUCTION    1299 7873.344920 7873.344721
#&gt; EXTENSION       1301 7873.344880 7873.344649
#&gt; LO-REDUCTION    1303 7873.344874 7873.344649
#&gt; LO-REDUCTION    1305 7873.344868 7873.344649
#&gt; LO-REDUCTION    1307 7873.344862 7873.344649
#&gt; LO-REDUCTION    1309 7873.344845 7873.344649
#&gt; EXTENSION       1311 7873.344807 7873.344604
#&gt; LO-REDUCTION    1313 7873.344775 7873.344604
#&gt; LO-REDUCTION    1315 7873.344769 7873.344604
#&gt; LO-REDUCTION    1317 7873.344760 7873.344604
#&gt; EXTENSION       1319 7873.344722 7873.344489
#&gt; LO-REDUCTION    1321 7873.344721 7873.344489
#&gt; LO-REDUCTION    1323 7873.344677 7873.344489
#&gt; LO-REDUCTION    1325 7873.344663 7873.344489
#&gt; EXTENSION       1327 7873.344649 7873.344444
#&gt; LO-REDUCTION    1329 7873.344648 7873.344444
#&gt; EXTENSION       1331 7873.344628 7873.344373
#&gt; LO-REDUCTION    1333 7873.344604 7873.344373
#&gt; LO-REDUCTION    1335 7873.344553 7873.344373
#&gt; LO-REDUCTION    1337 7873.344526 7873.344373
#&gt; EXTENSION       1339 7873.344514 7873.344349
#&gt; LO-REDUCTION    1341 7873.344512 7873.344349
#&gt; REFLECTION      1343 7873.344489 7873.344300
#&gt; LO-REDUCTION    1345 7873.344444 7873.344300
#&gt; LO-REDUCTION    1347 7873.344431 7873.344300
#&gt; EXTENSION       1349 7873.344403 7873.344240
#&gt; LO-REDUCTION    1351 7873.344381 7873.344240
#&gt; REFLECTION      1353 7873.344373 7873.344229
#&gt; HI-REDUCTION    1355 7873.344362 7873.344229
#&gt; EXTENSION       1357 7873.344349 7873.344169
#&gt; LO-REDUCTION    1359 7873.344338 7873.344169
#&gt; EXTENSION       1361 7873.344300 7873.344093
#&gt; LO-REDUCTION    1363 7873.344300 7873.344093
#&gt; LO-REDUCTION    1365 7873.344287 7873.344093
#&gt; LO-REDUCTION    1367 7873.344261 7873.344093
#&gt; LO-REDUCTION    1369 7873.344240 7873.344093
#&gt; LO-REDUCTION    1371 7873.344229 7873.344093
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1373 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)           P         pi1         pi2      theta5      theta6 
#&gt;  2.98631522 -0.97538823  0.01743891  2.21266368  1.06191570  1.01343231 
#&gt;      theta7      theta8 
#&gt;  0.26143557  1.09163689 
#&gt; 
#&gt; $value
#&gt; [1] 7873.344
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1373 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     1.062 
#&gt; 
#&gt; Assemble the answers</div><div class='input'>
<span class='co'># use method L-BFGS-B instead of Nelder-Mead and print report every 50 iterations</span>
<span class='no'>l4</span> <span class='kw'>&lt;-</span> <span class='fu'>latentIV</span>(<span class='no'>y</span> ~ <span class='no'>P</span>, <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"L-BFGS-B"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>REPORT</span><span class='kw'>=</span><span class='fl'>50</span>)),
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataLatentIV</span>)</div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ P is fitted to derive them.</span></div><div class='output co'>#&gt; <span class='message'>The start parameters c((Intercept)=2.915, P=-0.852, pi1=0.589, pi2=2.001, theta5=0.5, theta6=1, theta7=0.5, theta8=1) are used for optimization.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  8  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.7657037   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 8
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, m.data.mvnorm, use.intercept, name.intercept, 
#&gt;     name.endo.param) 
#&gt; {
#&gt;     if (use.intercept) {
#&gt;         b00 &lt;- params[name.intercept]
#&gt;         a1 &lt;- params[name.endo.param]
#&gt;     }
#&gt;     else {
#&gt;         b00 &lt;- 0
#&gt;         a1 &lt;- params[name.endo.param]
#&gt;     }
#&gt;     pt &lt;- exp(params["theta5"])
#&gt;     pt &lt;- pt/(1 + pt)
#&gt;     m.sigma &lt;- matrix(c(params["theta6"], params["theta7"], params["theta7"], 
#&gt;         params["theta8"]), byrow = TRUE, ncol = 2, nrow = 2)
#&gt;     s2e &lt;- m.sigma[1, 1]
#&gt;     s2v &lt;- m.sigma[2, 2]
#&gt;     sev &lt;- m.sigma[1, 2]
#&gt;     varcov &lt;- matrix(0, 2, 2)
#&gt;     varcov[1, 1] &lt;- a1 * a1 * s2v + 2 * a1 * sev + s2e
#&gt;     varcov[2, 1] &lt;- a1 * s2v + sev
#&gt;     varcov[1, 2] &lt;- varcov[2, 1]
#&gt;     varcov[2, 2] &lt;- s2v
#&gt;     pi1 &lt;- params["pi1"]
#&gt;     mu1 &lt;- matrix(data = c(b00 + a1 * pi1, pi1), nrow = 2, ncol = 1)
#&gt;     pi2 &lt;- params["pi2"]
#&gt;     mu2 &lt;- matrix(c(b00 + a1 * pi2, pi2), nrow = 2, ncol = 1)
#&gt;     log.pdf1 &lt;- dmvnorm(m.data.mvnorm, mean = mu1, sigma = varcov, 
#&gt;         log = TRUE)
#&gt;     log.pdf2 &lt;- dmvnorm(m.data.mvnorm, mean = mu2, sigma = varcov, 
#&gt;         log = TRUE)
#&gt;     max.AB &lt;- pmax(log(pt) + log.pdf1, log(1 - pt) + log.pdf2)
#&gt;     logLL.lse &lt;- sum(max.AB + log(pt * exp(log.pdf1 - max.AB) + 
#&gt;         (1 - pt) * exp(log.pdf2 - max.AB)))
#&gt;     return(-1 * logLL.lse)
#&gt; }
#&gt; &lt;bytecode: 0x7fc0fa718390&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 8, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 28
#&gt; function evaluations 32
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0630359
#&gt; final function value 7872.1
#&gt; 
#&gt; final  value 7872.102327 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)           P         pi1         pi2      theta5      theta6 
#&gt;  2.98907680 -0.97725302 -0.02486042  2.13742890  0.92538516  1.00268565 
#&gt;      theta7      theta8 
#&gt;  0.24989801  1.04266832 
#&gt; 
#&gt; $value
#&gt; [1] 7872.102
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       32 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       32 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.412 
#&gt; 
#&gt; Assemble the answers</div><div class='input'>
<span class='co'># read out all coefficients, incl auxiliary coefs</span>
<span class='no'>lat.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>l4</span>)
<span class='co'># same as above</span>
<span class='no'>lat.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>l4</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># only main model coefs</span>
<span class='no'>lat.main.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>l4</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



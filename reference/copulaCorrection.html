<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection • REndo</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection" />

<meta property="og:description" content="Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mmeierer/REndo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models Endogenous Regressors using Gaussian Copula</h1>
    <small class="dont-index">Source: <a href='https://github.com/mmeierer/REndo/blob/master/R/f_copulacorrection_interface.R'><code>R/f_copulacorrection_interface.R</code></a></small>
    <div class="hidden name"><code>copulaCorrection.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution.</p>
    
    </div>

    <pre class="usage"><span class='fu'>copulaCorrection</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>num.boots</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fitted. See the "Details" section for the exact notation.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the data of all parts specified in the formula parameter.</p></td>
    </tr>
    <tr>
      <th>num.boots</th>
      <td><p>Number of bootstrapping iterations. Defaults to 1000.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments for the log-likelihood optimization function in the case of a single continuous endogenous
 regressor. Ignored with a warning otherwise.</p><dl class='dl-horizontal'>
<dt>start.params</dt><dd><p>A named vector containing a set of parameters to use in the first optimization iteration.
The names have to correspond exactly to the names of the components specified in the <code>formula</code> parameter.
If not provided, a linear model is fitted to derive them.</p></dd>
<dt>optimx.args</dt><dd><p>A named list of arguments which are passed to <code><a href='https://www.rdocumentation.org/packages/optimx/topics/optimx'>optimx</a></code>. This allows users to tweak optimization settings to their liking.</p></dd>
</dl></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For all cases, an object of classes <code>rendo.copula.correction</code>, <code>rendo.boots</code>, and <code>rendo.base</code> is returned
which is a list and contains the following components:</p>
<dt>formula</dt><dd><p>The formula given to specify the fitted model.</p></dd>
<dt>terms</dt><dd><p>The terms object used for model fitting.</p></dd>
<dt>model</dt><dd><p>The model.frame used for model fitting.</p></dd>
<dt>coefficients</dt><dd><p>A named vector of all coefficients resulting from model fitting.</p></dd>
<dt>names.main.coefs</dt><dd><p>a vector specifying which coefficients are from the model. For internal usage.</p></dd>
<dt>names.vars.continuous</dt><dd><p>The names of the continuous endogenous regressors.</p></dd>
<dt>names.vars.discrete</dt><dd><p>The names of the discrete endogenous regressors.</p></dd>
<dt>fitted.values</dt><dd><p>Fitted values at the found solution.</p></dd>
<dt>residuals</dt><dd><p>The residuals at the found solution.</p></dd>
<dt>boots.params</dt><dd><p>The bootstrapped coefficients.</p></dd>

For the case of a single continuous endogenous regressor, the returned object further
contains the following components:
<dt>start.params</dt><dd><p>A named vector with the initial set of parameters used to optimize the log-likelihood function.</p></dd>
<dt>res.optimx</dt><dd><p>The result object returned by the function <code>optimx</code> after optimizing the log-likelihood function.</p></dd>

For all other cases, the returned object further contains the following components:
<dt>res.lm.real.data</dt><dd><p>The linear model fitted on the original data together with generated p.star data.</p></dd>

The function summary can be used to obtain and print a summary of the results.
Depending on the returned object, the generic accessor functions coefficients, fitted.values,
residuals, vcov, logLik, AIC, BIC, and nobs are available.

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <h3>Method</h3>
    The underlying idea of the joint estimation method is that using information contained in the observed data,
one selects marginal distributions for the endogenous regressor and the structural error term, respectively.
Then, the copula model enables the construction of a flexible multivariate joint distribution allowing a wide range
of correlations between the two marginals.
    Consider the model:
<br><center>Y<sub>t</sub>=&beta;<sub>0</sub>+&beta;<sub>1</sub>P<sub>t</sub>+&beta;<sub>2</sub>X<sub>t</sub>+&epsilon;<sub>t</sub></center>
    where \(t=1,..,T\) indexes either time or cross-sectional units, Y<sub>t</sub> is a \(1x1\) response variable,
X<sub>t</sub> is a \(kxn\) exogenous regressor,
P<sub>t</sub> is a \(kx1\) continuous endogenous regressor,
&epsilon;<sub>t</sub> is a normally distributed structural error term with mean zero and
E(&epsilon;<sup>2</sup>)=&sigma;<sub>&epsilon;</sub><sup>2</sup>,
\(\alpha\) and \(\beta\) are model parameters.
    The marginal distribution of the endogenous regressor P<sub>t</sub> is obtained using the Epanechnikov
kernel density estimator (Epanechnikov, 1969), as below:
<br><center>h&#770;(p)=1/(T&#183;b) &sum;(K&#183;((p-P<sub>t</sub>)/b))</center>
    where P<sub>t</sub> is the endogenous regressor,
K(x)=0.75&#183;(1-x<sup>2</sup>)&#183;I(|x|<=1)
and the bandwidth \(b\) is the one proposed by Silverman (1986),
and is equal to b=0.9&#183;T<sup>-1.5</sup>&#183;min(s, IQR/1.34).
\(IQR\) is the interquartile range while \(s\) is the data sample standard deviation
and \(T\) is the number of time periods observed in the data.
After obtaining the joint distribution of the error term and the continuous endogenous regressor, the model parameters are estimated using
maximum likelihood estimation.
    The additional parameters used during model fitting and printed in <code>summary</code> hence are:
<dl class='dl-horizontal'>
<dt><code>rho</code></dt><dd><p>The correlation between the endogenous regressor and the error.</p></dd>
<dt><code>sigma</code></dt><dd><p>The variance of the model's error.</p></dd>
</dl>
    With more than one continuous endogenous regressor or an endogenous discrete regressor, an alternative approach to the
estimation using Gaussian copula should be applied. This approach is similar to the control function approach (Petrin and Train, 2010).
The core idea is to apply OLS estimation on the original set of explanatory variables in the model equation above, plus an additional regressor
P<sub>t</sub>&#42;=&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
Here, H(P<sub>t</sub>) is the marginal distribution of the endogenous regressor \(P\).
Including this regressor solves the correlation between the endogenous regressor and the structural error, \(\epsilon\),
OLS providing consistent parameter estimates. Due to identification problems, the discrete endogenous regressor cannot have a binomial
distribution.
    Hence, only in the case of a single continuous endogenous regressor maximum likelihood estimation is used.
In all other cases, augmented OLS based on Gaussian copula is applied. This includes cases of multiple endogenous regressors
of both discrete and continuous distributions.
    In the case of discrete endogenous regressors, a random seed needs to be assigned because the marginal distribution function of
the endogenous regressor is a step function in this case. This means that the value of P&#42;
lies between 2 values, &Phi;<sup>-1</sup>(H(P<sub>t</sub>-1)) and
&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
However, the reported upper and lower bounds of the 95% bootstrapped confidence interval gives indication of the variance of the estimates.
<p>Since the inference procedure in both cases, augmented OLS and maximum likelihood, occurs in two stages (first the empirical distribution of the endogenous
regressor is computed and then used in constructing the likelihood function), the standard errors are not correct. Therefore, in both cases, the standard errors
and the confidence intervals are obtained based on the sampling distributions resulted from bootstrapping. Since the distribution of the bootstrapped parameters
is highly skewed, we report the percentile confidence intervals. Moreover, the variance-covariance matrix is also computed based on the bootstrapped
parameters, and not based on the Hessian.</p>
    <h3>Formula parameter</h3>
    The <code>formula</code> argument follows a two part notation:
    A two-sided formula describing the model (e.g. <code>y ~ X1 + X2 + P</code>) to be estimated and a
second right-hand side part in which the endogenous regressors and their distributional
assumptions are indicated (e.g. <code>continuous(P)</code>). These two parts are separated by a single vertical bar (<code>|</code>).
In the second part, the special functions <code>continuous</code>, <code>discrete</code>, or a combination
of both, are used to indicate the endogenous regressors and their respective distribution.
Both functions use the <code>...</code> parameter in which the respective endogenous regressors is specified.
    Note that no argument to <code>continuous</code> or <code>discrete</code> is to be supplied as character
but as symbols without quotation marks.
    See the example section for illustrations on how to specify the <code>formula</code> parameter.
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Park, S. and Gupta, S., (2012), "Handling Endogenous Regressors by Joint Estimation Using Copulas", Marketing Science, 31(4), 567-86.</p>
<p>Epanechnikov V (1969). "Nonparametric Estimation of a Multidimensional Probability Density." Teoriya veroyatnostei i ee primeneniya, 14(1), 156–161.
Silverman B (1986). "Density Estimation for Statistics and Data Analysis". CRC Monographs on Statistics and Applied Probability. London: Chapman &amp; Hall.</p>
<p>Petrin A, Train K (2010). "A Control Function Approach to Endogeneity in Consumer Choice Models." Journal of Marketing Research, 47(1), 3–13.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.rendo.copula.correction.html'>summary</a></code> for how fitted models are summarized</p>
<p><code><a href='vcov.rendo.boots.html'>vcov</a></code> for how the variance-covariance matrix is derived</p>
<p><code><a href='confint.rendo.boots.html'>confint</a></code> for how confidence intervals are derived</p>
<p><code><a href='https://www.rdocumentation.org/packages/optimx/topics/optimx'>optimx</a></code> for possible elements of parameter <code>optimx.arg</code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopCont"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopCont2"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDis"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDis2"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDisCont"</span>)</div><div class='input'><span class='co'># Single continuous: log-likelihood optimization</span>
<span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above, with start.parameters and number of bootstrappings</span>
<span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>,
                       <span class='kw'>start.params</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"(Intercept)"</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>X1</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>X2</span><span class='kw'>=</span>-<span class='fl'>2</span>, <span class='kw'>P</span><span class='kw'>=</span>-<span class='fl'>1</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># All following examples fit linear model with Gaussian copulas</span>

<span class='co'># 2 continuous endogenous regressors</span>
<span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P1</span>, <span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 2 continuous and 0 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above</span>
<span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P1</span>)+<span class='fu'>continuous</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 2 continuous and 0 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># single discrete endogenous regressor</span>
<span class='no'>d1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 1 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># two discrete endogenous regressor</span>
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>)+<span class='fu'>discrete</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 2 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above but less bootstrap runs</span>
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>, <span class='no'>P2</span>), <span class='kw'>num.boots</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 2 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># single discrete, single continuous</span>
<span class='no'>cd</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>)+<span class='fu'>continuous</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDisCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 1 continuous and 1 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># For single continuous only: use own optimization settings (see optimx())</span>
<span class='co'># set maximum number of iterations to 50'000</span>
<span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                           <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>itnmax</span> <span class='kw'>=</span> <span class='fl'>50000</span>),
                           <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># print detailed tracing information on progress</span>
 <span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                            <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>6</span>)),
                            <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6066.699410
#&gt;   Scaled convergence tolerance is 9.04009e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11655.293629 5695.637199
#&gt; LO-REDUCTION       9 7765.834415 5695.637199
#&gt; LO-REDUCTION      11 7519.586333 5695.637199
#&gt; LO-REDUCTION      13 6861.295883 5695.637199
#&gt; LO-REDUCTION      15 6591.723078 5695.637199
#&gt; LO-REDUCTION      17 6330.376148 5695.637199
#&gt; REFLECTION        19 6277.490264 5673.393067
#&gt; REFLECTION        21 6066.699410 5485.576718
#&gt; LO-REDUCTION      23 5879.887795 5485.576718
#&gt; LO-REDUCTION      25 5868.216236 5485.576718
#&gt; LO-REDUCTION      27 5700.078431 5485.576718
#&gt; LO-REDUCTION      29 5695.637199 5485.576718
#&gt; LO-REDUCTION      31 5673.393067 5485.576718
#&gt; LO-REDUCTION      33 5569.952286 5485.576718
#&gt; LO-REDUCTION      35 5534.598391 5485.576718
#&gt; HI-REDUCTION      37 5528.603388 5485.576718
#&gt; LO-REDUCTION      39 5515.960624 5485.576718
#&gt; HI-REDUCTION      41 5496.374548 5485.576718
#&gt; HI-REDUCTION      43 5494.649359 5485.576718
#&gt; HI-REDUCTION      45 5493.139869 5485.441214
#&gt; REFLECTION        47 5489.798362 5484.577835
#&gt; LO-REDUCTION      49 5488.808164 5481.951305
#&gt; LO-REDUCTION      51 5485.763575 5480.324269
#&gt; HI-REDUCTION      53 5485.649342 5480.324269
#&gt; HI-REDUCTION      55 5485.576718 5480.324269
#&gt; HI-REDUCTION      57 5485.441214 5480.324269
#&gt; LO-REDUCTION      59 5484.577835 5479.718251
#&gt; HI-REDUCTION      61 5481.951305 5479.718251
#&gt; HI-REDUCTION      63 5481.493549 5479.718251
#&gt; REFLECTION        65 5481.258604 5479.042918
#&gt; HI-REDUCTION      67 5481.088674 5479.042918
#&gt; REFLECTION        69 5480.324269 5478.568166
#&gt; HI-REDUCTION      71 5480.210564 5478.568166
#&gt; LO-REDUCTION      73 5480.169553 5478.568166
#&gt; EXTENSION         75 5479.729317 5478.078801
#&gt; REFLECTION        77 5479.718251 5477.828364
#&gt; LO-REDUCTION      79 5479.215719 5477.828364
#&gt; LO-REDUCTION      81 5479.203150 5477.823854
#&gt; REFLECTION        83 5479.042918 5477.152439
#&gt; LO-REDUCTION      85 5478.568166 5477.152439
#&gt; LO-REDUCTION      87 5478.078801 5477.152439
#&gt; LO-REDUCTION      89 5477.873007 5477.152439
#&gt; LO-REDUCTION      91 5477.828364 5477.152439
#&gt; LO-REDUCTION      93 5477.823854 5477.152439
#&gt; EXTENSION         95 5477.607265 5476.526851
#&gt; LO-REDUCTION      97 5477.414512 5476.526851
#&gt; LO-REDUCTION      99 5477.407763 5476.526851
#&gt; LO-REDUCTION     101 5477.365292 5476.526851
#&gt; LO-REDUCTION     103 5477.294969 5476.526851
#&gt; LO-REDUCTION     105 5477.152439 5476.526851
#&gt; EXTENSION        107 5477.047051 5476.077909
#&gt; LO-REDUCTION     109 5476.914382 5476.077909
#&gt; LO-REDUCTION     111 5476.747256 5476.077909
#&gt; LO-REDUCTION     113 5476.700138 5476.077909
#&gt; EXTENSION        115 5476.573155 5476.006884
#&gt; LO-REDUCTION     117 5476.526851 5476.006884
#&gt; REFLECTION       119 5476.359098 5475.966940
#&gt; EXTENSION        121 5476.221765 5475.531955
#&gt; LO-REDUCTION     123 5476.209942 5475.531955
#&gt; LO-REDUCTION     125 5476.150247 5475.531955
#&gt; LO-REDUCTION     127 5476.077909 5475.531955
#&gt; LO-REDUCTION     129 5476.006884 5475.531955
#&gt; LO-REDUCTION     131 5475.966940 5475.531955
#&gt; LO-REDUCTION     133 5475.935765 5475.531955
#&gt; EXTENSION        135 5475.770072 5475.282275
#&gt; EXTENSION        137 5475.703400 5475.046043
#&gt; LO-REDUCTION     139 5475.596586 5475.046043
#&gt; LO-REDUCTION     141 5475.554207 5475.046043
#&gt; LO-REDUCTION     143 5475.535053 5475.046043
#&gt; LO-REDUCTION     145 5475.531955 5475.046043
#&gt; REFLECTION       147 5475.282275 5474.985965
#&gt; LO-REDUCTION     149 5475.201050 5474.985965
#&gt; EXTENSION        151 5475.162505 5474.914685
#&gt; LO-REDUCTION     153 5475.131559 5474.914685
#&gt; EXTENSION        155 5475.091330 5474.818176
#&gt; REFLECTION       157 5475.078835 5474.785378
#&gt; REFLECTION       159 5475.046043 5474.771218
#&gt; LO-REDUCTION     161 5474.985965 5474.771218
#&gt; LO-REDUCTION     163 5474.919264 5474.771218
#&gt; HI-REDUCTION     165 5474.914685 5474.771218
#&gt; REFLECTION       167 5474.870588 5474.737806
#&gt; LO-REDUCTION     169 5474.829996 5474.737806
#&gt; LO-REDUCTION     171 5474.818176 5474.737806
#&gt; REFLECTION       173 5474.817291 5474.723977
#&gt; EXTENSION        175 5474.785378 5474.664323
#&gt; LO-REDUCTION     177 5474.771218 5474.664323
#&gt; LO-REDUCTION     179 5474.749096 5474.664323
#&gt; LO-REDUCTION     181 5474.744778 5474.664323
#&gt; EXTENSION        183 5474.737806 5474.627580
#&gt; EXTENSION        185 5474.723977 5474.603678
#&gt; LO-REDUCTION     187 5474.690190 5474.603678
#&gt; REFLECTION       189 5474.676094 5474.600848
#&gt; REFLECTION       191 5474.671963 5474.581443
#&gt; HI-REDUCTION     193 5474.664323 5474.581443
#&gt; EXTENSION        195 5474.627580 5474.542814
#&gt; REFLECTION       197 5474.607645 5474.534732
#&gt; LO-REDUCTION     199 5474.604300 5474.534732
#&gt; HI-REDUCTION     201 5474.603678 5474.534732
#&gt; LO-REDUCTION     203 5474.600848 5474.534732
#&gt; EXTENSION        205 5474.581443 5474.474411
#&gt; LO-REDUCTION     207 5474.563653 5474.474411
#&gt; LO-REDUCTION     209 5474.557809 5474.474411
#&gt; EXTENSION        211 5474.551105 5474.447380
#&gt; LO-REDUCTION     213 5474.542814 5474.447380
#&gt; REFLECTION       215 5474.534732 5474.434785
#&gt; LO-REDUCTION     217 5474.507183 5474.434785
#&gt; EXTENSION        219 5474.497839 5474.408340
#&gt; EXTENSION        221 5474.474411 5474.372781
#&gt; LO-REDUCTION     223 5474.468972 5474.372781
#&gt; EXTENSION        225 5474.455320 5474.295481
#&gt; LO-REDUCTION     227 5474.447380 5474.295481
#&gt; LO-REDUCTION     229 5474.434785 5474.295481
#&gt; LO-REDUCTION     231 5474.408340 5474.295481
#&gt; EXTENSION        233 5474.387490 5474.265810
#&gt; LO-REDUCTION     235 5474.372781 5474.265810
#&gt; LO-REDUCTION     237 5474.351363 5474.265810
#&gt; LO-REDUCTION     239 5474.346856 5474.265810
#&gt; EXTENSION        241 5474.343541 5474.245871
#&gt; REFLECTION       243 5474.295481 5474.218162
#&gt; HI-REDUCTION     245 5474.292981 5474.218162
#&gt; EXTENSION        247 5474.290031 5474.195094
#&gt; LO-REDUCTION     249 5474.281209 5474.195094
#&gt; EXTENSION        251 5474.265810 5474.169866
#&gt; LO-REDUCTION     253 5474.260265 5474.169866
#&gt; LO-REDUCTION     255 5474.245871 5474.169866
#&gt; EXTENSION        257 5474.218162 5474.104369
#&gt; LO-REDUCTION     259 5474.209633 5474.104369
#&gt; LO-REDUCTION     261 5474.195094 5474.104369
#&gt; LO-REDUCTION     263 5474.193875 5474.104369
#&gt; EXTENSION        265 5474.181355 5474.035079
#&gt; LO-REDUCTION     267 5474.169866 5474.035079
#&gt; LO-REDUCTION     269 5474.154536 5474.035079
#&gt; EXTENSION        271 5474.129257 5473.975150
#&gt; LO-REDUCTION     273 5474.112698 5473.975150
#&gt; LO-REDUCTION     275 5474.104369 5473.975150
#&gt; LO-REDUCTION     277 5474.081845 5473.975150
#&gt; LO-REDUCTION     279 5474.062998 5473.975150
#&gt; LO-REDUCTION     281 5474.035079 5473.975150
#&gt; LO-REDUCTION     283 5474.023715 5473.975150
#&gt; EXTENSION        285 5474.020378 5473.957216
#&gt; EXTENSION        287 5473.990427 5473.937415
#&gt; REFLECTION       289 5473.988691 5473.935943
#&gt; HI-REDUCTION     291 5473.987532 5473.935943
#&gt; REFLECTION       293 5473.979800 5473.922702
#&gt; EXTENSION        295 5473.975150 5473.864352
#&gt; LO-REDUCTION     297 5473.957216 5473.864352
#&gt; LO-REDUCTION     299 5473.956967 5473.864352
#&gt; LO-REDUCTION     301 5473.937415 5473.864352
#&gt; LO-REDUCTION     303 5473.935943 5473.864352
#&gt; EXTENSION        305 5473.922702 5473.849235
#&gt; EXTENSION        307 5473.916512 5473.829827
#&gt; EXTENSION        309 5473.898706 5473.811097
#&gt; EXTENSION        311 5473.883827 5473.788518
#&gt; LO-REDUCTION     313 5473.874805 5473.788518
#&gt; LO-REDUCTION     315 5473.864352 5473.788518
#&gt; REFLECTION       317 5473.849235 5473.783659
#&gt; LO-REDUCTION     319 5473.829827 5473.783659
#&gt; HI-REDUCTION     321 5473.811097 5473.783659
#&gt; REFLECTION       323 5473.797066 5473.775061
#&gt; LO-REDUCTION     325 5473.794855 5473.775061
#&gt; EXTENSION        327 5473.792770 5473.759049
#&gt; LO-REDUCTION     329 5473.791611 5473.759049
#&gt; LO-REDUCTION     331 5473.788518 5473.758560
#&gt; LO-REDUCTION     333 5473.783659 5473.758560
#&gt; HI-REDUCTION     335 5473.775670 5473.758560
#&gt; LO-REDUCTION     337 5473.775061 5473.758560
#&gt; REFLECTION       339 5473.765389 5473.756064
#&gt; LO-REDUCTION     341 5473.764760 5473.755112
#&gt; EXTENSION        343 5473.759778 5473.741357
#&gt; HI-REDUCTION     345 5473.759146 5473.741357
#&gt; LO-REDUCTION     347 5473.759049 5473.741357
#&gt; LO-REDUCTION     349 5473.758560 5473.741357
#&gt; EXTENSION        351 5473.756064 5473.738656
#&gt; LO-REDUCTION     353 5473.755112 5473.738656
#&gt; EXTENSION        355 5473.752204 5473.732288
#&gt; REFLECTION       357 5473.748349 5473.731125
#&gt; LO-REDUCTION     359 5473.743165 5473.731125
#&gt; LO-REDUCTION     361 5473.741357 5473.731125
#&gt; LO-REDUCTION     363 5473.741351 5473.731125
#&gt; LO-REDUCTION     365 5473.738656 5473.731125
#&gt; REFLECTION       367 5473.735294 5473.729399
#&gt; EXTENSION        369 5473.733289 5473.725014
#&gt; LO-REDUCTION     371 5473.733093 5473.725014
#&gt; LO-REDUCTION     373 5473.732288 5473.725014
#&gt; LO-REDUCTION     375 5473.731173 5473.725014
#&gt; EXTENSION        377 5473.731125 5473.721626
#&gt; LO-REDUCTION     379 5473.729399 5473.721626
#&gt; LO-REDUCTION     381 5473.726415 5473.721626
#&gt; EXTENSION        383 5473.725699 5473.718097
#&gt; LO-REDUCTION     385 5473.725415 5473.718097
#&gt; LO-REDUCTION     387 5473.725014 5473.718097
#&gt; LO-REDUCTION     389 5473.722704 5473.718097
#&gt; LO-REDUCTION     391 5473.722190 5473.718097
#&gt; REFLECTION       393 5473.721626 5473.717825
#&gt; REFLECTION       395 5473.720554 5473.717053
#&gt; LO-REDUCTION     397 5473.720034 5473.716914
#&gt; REFLECTION       399 5473.718882 5473.716822
#&gt; EXTENSION        401 5473.718320 5473.714298
#&gt; LO-REDUCTION     403 5473.718097 5473.714298
#&gt; LO-REDUCTION     405 5473.717825 5473.714298
#&gt; LO-REDUCTION     407 5473.717053 5473.714298
#&gt; LO-REDUCTION     409 5473.716914 5473.714298
#&gt; LO-REDUCTION     411 5473.716822 5473.714298
#&gt; EXTENSION        413 5473.716021 5473.713447
#&gt; LO-REDUCTION     415 5473.715777 5473.713447
#&gt; EXTENSION        417 5473.715651 5473.713066
#&gt; LO-REDUCTION     419 5473.715526 5473.713066
#&gt; LO-REDUCTION     421 5473.715087 5473.713066
#&gt; LO-REDUCTION     423 5473.714363 5473.713066
#&gt; REFLECTION       425 5473.714298 5473.713028
#&gt; LO-REDUCTION     427 5473.713567 5473.713023
#&gt; HI-REDUCTION     429 5473.713447 5473.713023
#&gt; EXTENSION        431 5473.713283 5473.712235
#&gt; LO-REDUCTION     433 5473.713199 5473.712235
#&gt; LO-REDUCTION     435 5473.713154 5473.712235
#&gt; HI-REDUCTION     437 5473.713066 5473.712235
#&gt; LO-REDUCTION     439 5473.713028 5473.712235
#&gt; LO-REDUCTION     441 5473.713023 5473.712235
#&gt; LO-REDUCTION     443 5473.712862 5473.712235
#&gt; LO-REDUCTION     445 5473.712828 5473.712235
#&gt; EXTENSION        447 5473.712784 5473.711935
#&gt; EXTENSION        449 5473.712695 5473.711390
#&gt; LO-REDUCTION     451 5473.712390 5473.711390
#&gt; LO-REDUCTION     453 5473.712283 5473.711390
#&gt; LO-REDUCTION     455 5473.712246 5473.711390
#&gt; REFLECTION       457 5473.712235 5473.711337
#&gt; EXTENSION        459 5473.711935 5473.711052
#&gt; EXTENSION        461 5473.711599 5473.710490
#&gt; LO-REDUCTION     463 5473.711598 5473.710490
#&gt; EXTENSION        465 5473.711513 5473.710121
#&gt; LO-REDUCTION     467 5473.711390 5473.710121
#&gt; LO-REDUCTION     469 5473.711337 5473.710121
#&gt; LO-REDUCTION     471 5473.711052 5473.710121
#&gt; EXTENSION        473 5473.710613 5473.709455
#&gt; LO-REDUCTION     475 5473.710569 5473.709455
#&gt; LO-REDUCTION     477 5473.710558 5473.709455
#&gt; LO-REDUCTION     479 5473.710490 5473.709455
#&gt; EXTENSION        481 5473.710223 5473.709307
#&gt; LO-REDUCTION     483 5473.710121 5473.709307
#&gt; LO-REDUCTION     485 5473.710118 5473.709307
#&gt; EXTENSION        487 5473.709834 5473.708478
#&gt; LO-REDUCTION     489 5473.709516 5473.708478
#&gt; LO-REDUCTION     491 5473.709455 5473.708478
#&gt; LO-REDUCTION     493 5473.709442 5473.708478
#&gt; LO-REDUCTION     495 5473.709425 5473.708478
#&gt; EXTENSION        497 5473.709307 5473.708168
#&gt; LO-REDUCTION     499 5473.708999 5473.708168
#&gt; LO-REDUCTION     501 5473.708908 5473.708168
#&gt; EXTENSION        503 5473.708892 5473.708101
#&gt; REFLECTION       505 5473.708754 5473.707883
#&gt; REFLECTION       507 5473.708478 5473.707856
#&gt; HI-REDUCTION     509 5473.708447 5473.707856
#&gt; REFLECTION       511 5473.708360 5473.707816
#&gt; EXTENSION        513 5473.708168 5473.707045
#&gt; LO-REDUCTION     515 5473.708118 5473.707045
#&gt; LO-REDUCTION     517 5473.708101 5473.707045
#&gt; LO-REDUCTION     519 5473.707883 5473.707045
#&gt; LO-REDUCTION     521 5473.707856 5473.707045
#&gt; LO-REDUCTION     523 5473.707816 5473.707045
#&gt; LO-REDUCTION     525 5473.707804 5473.707045
#&gt; EXTENSION        527 5473.707780 5473.706881
#&gt; EXTENSION        529 5473.707482 5473.705810
#&gt; LO-REDUCTION     531 5473.707341 5473.705810
#&gt; LO-REDUCTION     533 5473.707259 5473.705810
#&gt; EXTENSION        535 5473.707135 5473.705341
#&gt; LO-REDUCTION     537 5473.707045 5473.705341
#&gt; LO-REDUCTION     539 5473.706881 5473.705341
#&gt; EXTENSION        541 5473.706373 5473.703301
#&gt; LO-REDUCTION     543 5473.706000 5473.703301
#&gt; LO-REDUCTION     545 5473.705810 5473.703301
#&gt; LO-REDUCTION     547 5473.705529 5473.703301
#&gt; LO-REDUCTION     549 5473.705436 5473.703301
#&gt; EXTENSION        551 5473.705341 5473.700935
#&gt; LO-REDUCTION     553 5473.704096 5473.700935
#&gt; LO-REDUCTION     555 5473.704022 5473.700935
#&gt; EXTENSION        557 5473.703753 5473.698947
#&gt; LO-REDUCTION     559 5473.703315 5473.698947
#&gt; EXTENSION        561 5473.703301 5473.697534
#&gt; EXTENSION        563 5473.701275 5473.693757
#&gt; LO-REDUCTION     565 5473.701019 5473.693757
#&gt; LO-REDUCTION     567 5473.700935 5473.693757
#&gt; EXTENSION        569 5473.699873 5473.691864
#&gt; EXTENSION        571 5473.698947 5473.688397
#&gt; LO-REDUCTION     573 5473.697534 5473.688397
#&gt; LO-REDUCTION     575 5473.695554 5473.688397
#&gt; LO-REDUCTION     577 5473.695159 5473.688397
#&gt; REFLECTION       579 5473.693757 5473.687221
#&gt; LO-REDUCTION     581 5473.691864 5473.687221
#&gt; EXTENSION        583 5473.689777 5473.684985
#&gt; LO-REDUCTION     585 5473.689229 5473.684985
#&gt; LO-REDUCTION     587 5473.689126 5473.684985
#&gt; EXTENSION        589 5473.688738 5473.684040
#&gt; LO-REDUCTION     591 5473.688397 5473.684040
#&gt; LO-REDUCTION     593 5473.687436 5473.684040
#&gt; EXTENSION        595 5473.687221 5473.680380
#&gt; LO-REDUCTION     597 5473.686742 5473.680380
#&gt; LO-REDUCTION     599 5473.685656 5473.680380
#&gt; LO-REDUCTION     601 5473.684985 5473.680380
#&gt; LO-REDUCTION     603 5473.684696 5473.680380
#&gt; EXTENSION        605 5473.684040 5473.676677
#&gt; LO-REDUCTION     607 5473.682830 5473.676677
#&gt; EXTENSION        609 5473.682673 5473.673979
#&gt; LO-REDUCTION     611 5473.681575 5473.673979
#&gt; EXTENSION        613 5473.680914 5473.670992
#&gt; EXTENSION        615 5473.680380 5473.665124
#&gt; LO-REDUCTION     617 5473.678465 5473.665124
#&gt; EXTENSION        619 5473.676677 5473.657691
#&gt; LO-REDUCTION     621 5473.674527 5473.657691
#&gt; LO-REDUCTION     623 5473.673979 5473.657691
#&gt; EXTENSION        625 5473.670992 5473.646617
#&gt; EXTENSION        627 5473.667211 5473.637296
#&gt; LO-REDUCTION     629 5473.665124 5473.637296
#&gt; EXTENSION        631 5473.658907 5473.624633
#&gt; LO-REDUCTION     633 5473.658045 5473.624633
#&gt; EXTENSION        635 5473.657691 5473.608922
#&gt; LO-REDUCTION     637 5473.646617 5473.608922
#&gt; EXTENSION        639 5473.639129 5473.603210
#&gt; LO-REDUCTION     641 5473.637296 5473.603210
#&gt; LO-REDUCTION     643 5473.629334 5473.603210
#&gt; REFLECTION       645 5473.624633 5473.599311
#&gt; REFLECTION       647 5473.612619 5473.597382
#&gt; HI-REDUCTION     649 5473.609880 5473.597382
#&gt; EXTENSION        651 5473.608922 5473.589403
#&gt; LO-REDUCTION     653 5473.605827 5473.589403
#&gt; LO-REDUCTION     655 5473.604253 5473.589403
#&gt; HI-REDUCTION     657 5473.603210 5473.589403
#&gt; LO-REDUCTION     659 5473.599311 5473.589403
#&gt; LO-REDUCTION     661 5473.597641 5473.589403
#&gt; LO-REDUCTION     663 5473.597382 5473.589403
#&gt; EXTENSION        665 5473.596136 5473.586795
#&gt; EXTENSION        667 5473.594133 5473.581062
#&gt; LO-REDUCTION     669 5473.593092 5473.581062
#&gt; LO-REDUCTION     671 5473.592558 5473.581062
#&gt; EXTENSION        673 5473.589644 5473.578114
#&gt; LO-REDUCTION     675 5473.589403 5473.578114
#&gt; LO-REDUCTION     677 5473.586795 5473.578114
#&gt; LO-REDUCTION     679 5473.585604 5473.578114
#&gt; EXTENSION        681 5473.582257 5473.572965
#&gt; EXTENSION        683 5473.582038 5473.568155
#&gt; LO-REDUCTION     685 5473.581062 5473.568155
#&gt; LO-REDUCTION     687 5473.578430 5473.568155
#&gt; LO-REDUCTION     689 5473.578134 5473.568155
#&gt; LO-REDUCTION     691 5473.578114 5473.568155
#&gt; LO-REDUCTION     693 5473.574117 5473.568093
#&gt; EXTENSION        695 5473.572965 5473.560840
#&gt; LO-REDUCTION     697 5473.572011 5473.560840
#&gt; EXTENSION        699 5473.569711 5473.555391
#&gt; LO-REDUCTION     701 5473.568275 5473.555391
#&gt; LO-REDUCTION     703 5473.568155 5473.555391
#&gt; LO-REDUCTION     705 5473.568093 5473.555391
#&gt; EXTENSION        707 5473.562808 5473.549032
#&gt; LO-REDUCTION     709 5473.561034 5473.549032
#&gt; LO-REDUCTION     711 5473.560840 5473.549032
#&gt; EXTENSION        713 5473.558382 5473.542850
#&gt; LO-REDUCTION     715 5473.556132 5473.542850
#&gt; LO-REDUCTION     717 5473.555391 5473.542850
#&gt; LO-REDUCTION     719 5473.554476 5473.542850
#&gt; EXTENSION        721 5473.550557 5473.542110
#&gt; LO-REDUCTION     723 5473.549032 5473.542110
#&gt; LO-REDUCTION     725 5473.548500 5473.542110
#&gt; EXTENSION        727 5473.548310 5473.540528
#&gt; LO-REDUCTION     729 5473.547261 5473.540528
#&gt; REFLECTION       731 5473.544174 5473.539355
#&gt; REFLECTION       733 5473.543366 5473.539184
#&gt; LO-REDUCTION     735 5473.542850 5473.539184
#&gt; HI-REDUCTION     737 5473.542537 5473.539184
#&gt; EXTENSION        739 5473.542110 5473.537158
#&gt; LO-REDUCTION     741 5473.540528 5473.537158
#&gt; EXTENSION        743 5473.540202 5473.534897
#&gt; LO-REDUCTION     745 5473.539540 5473.534897
#&gt; LO-REDUCTION     747 5473.539355 5473.534897
#&gt; LO-REDUCTION     749 5473.539184 5473.534897
#&gt; EXTENSION        751 5473.538490 5473.533200
#&gt; EXTENSION        753 5473.537845 5473.531098
#&gt; LO-REDUCTION     755 5473.537158 5473.531098
#&gt; EXTENSION        757 5473.536395 5473.527262
#&gt; EXTENSION        759 5473.535640 5473.522412
#&gt; LO-REDUCTION     761 5473.534897 5473.522412
#&gt; LO-REDUCTION     763 5473.533200 5473.522412
#&gt; LO-REDUCTION     765 5473.531325 5473.522412
#&gt; EXTENSION        767 5473.531098 5473.520516
#&gt; EXTENSION        769 5473.527262 5473.515047
#&gt; EXTENSION        771 5473.526691 5473.512053
#&gt; LO-REDUCTION     773 5473.523660 5473.512053
#&gt; EXTENSION        775 5473.522834 5473.505338
#&gt; LO-REDUCTION     777 5473.522412 5473.505338
#&gt; LO-REDUCTION     779 5473.520516 5473.505338
#&gt; LO-REDUCTION     781 5473.515047 5473.505338
#&gt; LO-REDUCTION     783 5473.514715 5473.505338
#&gt; LO-REDUCTION     785 5473.512804 5473.505338
#&gt; EXTENSION        787 5473.512251 5473.501068
#&gt; EXTENSION        789 5473.512053 5473.497575
#&gt; REFLECTION       791 5473.507982 5473.497255
#&gt; LO-REDUCTION     793 5473.506905 5473.497255
#&gt; EXTENSION        795 5473.505380 5473.488328
#&gt; LO-REDUCTION     797 5473.505338 5473.488328
#&gt; LO-REDUCTION     799 5473.501068 5473.488328
#&gt; LO-REDUCTION     801 5473.497707 5473.488328
#&gt; EXTENSION        803 5473.497575 5473.486172
#&gt; EXTENSION        805 5473.497255 5473.481969
#&gt; LO-REDUCTION     807 5473.494387 5473.481969
#&gt; EXTENSION        809 5473.492626 5473.475919
#&gt; REFLECTION       811 5473.488846 5473.475653
#&gt; LO-REDUCTION     813 5473.488328 5473.475653
#&gt; REFLECTION       815 5473.486172 5473.475480
#&gt; HI-REDUCTION     817 5473.483866 5473.475480
#&gt; LO-REDUCTION     819 5473.481969 5473.475480
#&gt; REFLECTION       821 5473.478810 5473.474674
#&gt; LO-REDUCTION     823 5473.477291 5473.474674
#&gt; LO-REDUCTION     825 5473.475919 5473.474674
#&gt; LO-REDUCTION     827 5473.475653 5473.474221
#&gt; HI-REDUCTION     829 5473.475496 5473.474221
#&gt; LO-REDUCTION     831 5473.475480 5473.474221
#&gt; REFLECTION       833 5473.474915 5473.473908
#&gt; LO-REDUCTION     835 5473.474742 5473.473736
#&gt; LO-REDUCTION     837 5473.474674 5473.473736
#&gt; HI-REDUCTION     839 5473.474471 5473.473736
#&gt; LO-REDUCTION     841 5473.474376 5473.473637
#&gt; HI-REDUCTION     843 5473.474221 5473.473637
#&gt; LO-REDUCTION     845 5473.473950 5473.473598
#&gt; LO-REDUCTION     847 5473.473908 5473.473585
#&gt; HI-REDUCTION     849 5473.473856 5473.473585
#&gt; LO-REDUCTION     851 5473.473820 5473.473567
#&gt; REFLECTION       853 5473.473736 5473.473487
#&gt; HI-REDUCTION     855 5473.473637 5473.473487
#&gt; LO-REDUCTION     857 5473.473625 5473.473487
#&gt; REFLECTION       859 5473.473598 5473.473432
#&gt; LO-REDUCTION     861 5473.473585 5473.473432
#&gt; LO-REDUCTION     863 5473.473567 5473.473432
#&gt; LO-REDUCTION     865 5473.473531 5473.473432
#&gt; Exiting from Nelder Mead minimizer
#&gt;     867 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0625664   1.4887824  -3.0065109  -0.9652173  -0.5257498   0.3090100 
#&gt; 
#&gt; $value
#&gt; [1] 5473.473
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      867 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;       0.7 
#&gt; 
#&gt; Assemble the answers</div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6033.580738
#&gt;   Scaled convergence tolerance is 8.99074e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11512.297416 5676.039012
#&gt; LO-REDUCTION       9 7692.997857 5676.039012
#&gt; HI-REDUCTION      11 7427.091370 5676.039012
#&gt; LO-REDUCTION      13 6863.335034 5676.039012
#&gt; LO-REDUCTION      15 6431.630939 5676.039012
#&gt; LO-REDUCTION      17 6251.504365 5676.039012
#&gt; REFLECTION        19 6240.387171 5612.553062
#&gt; REFLECTION        21 6080.926358 5480.248092
#&gt; LO-REDUCTION      23 6033.580738 5480.248092
#&gt; LO-REDUCTION      25 5699.130206 5471.191484
#&gt; LO-REDUCTION      27 5683.915263 5471.191484
#&gt; LO-REDUCTION      29 5676.039012 5471.191484
#&gt; LO-REDUCTION      31 5612.553062 5471.191484
#&gt; REFLECTION        33 5602.585776 5470.030216
#&gt; LO-REDUCTION      35 5560.374864 5465.646470
#&gt; HI-REDUCTION      37 5500.146394 5465.646470
#&gt; LO-REDUCTION      39 5494.151355 5465.646470
#&gt; LO-REDUCTION      41 5488.464293 5464.658609
#&gt; HI-REDUCTION      43 5480.248092 5464.658609
#&gt; HI-REDUCTION      45 5474.591252 5464.658609
#&gt; REFLECTION        47 5471.191484 5459.674601
#&gt; HI-REDUCTION      49 5470.030216 5459.674601
#&gt; HI-REDUCTION      51 5467.947807 5459.674601
#&gt; HI-REDUCTION      53 5465.646470 5459.674601
#&gt; LO-REDUCTION      55 5465.285285 5459.674601
#&gt; LO-REDUCTION      57 5464.658609 5459.674601
#&gt; HI-REDUCTION      59 5462.855194 5459.674601
#&gt; REFLECTION        61 5462.797235 5459.003262
#&gt; LO-REDUCTION      63 5462.314453 5459.003262
#&gt; REFLECTION        65 5460.734981 5458.783496
#&gt; LO-REDUCTION      67 5460.632421 5458.581289
#&gt; LO-REDUCTION      69 5460.287807 5458.305117
#&gt; LO-REDUCTION      71 5459.674601 5458.109366
#&gt; LO-REDUCTION      73 5459.016734 5458.109366
#&gt; HI-REDUCTION      75 5459.003262 5458.109366
#&gt; HI-REDUCTION      77 5458.783496 5458.109205
#&gt; REFLECTION        79 5458.581289 5458.019638
#&gt; LO-REDUCTION      81 5458.305117 5457.916224
#&gt; HI-REDUCTION      83 5458.150241 5457.916224
#&gt; REFLECTION        85 5458.129856 5457.793733
#&gt; LO-REDUCTION      87 5458.109366 5457.744672
#&gt; HI-REDUCTION      89 5458.109205 5457.744672
#&gt; REFLECTION        91 5458.019638 5457.731059
#&gt; HI-REDUCTION      93 5457.933312 5457.731059
#&gt; REFLECTION        95 5457.916224 5457.603665
#&gt; LO-REDUCTION      97 5457.798056 5457.603665
#&gt; REFLECTION        99 5457.793733 5457.538468
#&gt; HI-REDUCTION     101 5457.744672 5457.538468
#&gt; EXTENSION        103 5457.732127 5457.338626
#&gt; LO-REDUCTION     105 5457.731059 5457.338626
#&gt; LO-REDUCTION     107 5457.632262 5457.338626
#&gt; LO-REDUCTION     109 5457.624015 5457.338626
#&gt; LO-REDUCTION     111 5457.603665 5457.338626
#&gt; EXTENSION        113 5457.538468 5457.178331
#&gt; EXTENSION        115 5457.498339 5457.090946
#&gt; LO-REDUCTION     117 5457.464635 5457.090946
#&gt; LO-REDUCTION     119 5457.452389 5457.090946
#&gt; REFLECTION       121 5457.373680 5457.060194
#&gt; EXTENSION        123 5457.338626 5456.900799
#&gt; REFLECTION       125 5457.192222 5456.887618
#&gt; LO-REDUCTION     127 5457.178331 5456.887618
#&gt; REFLECTION       129 5457.178096 5456.887310
#&gt; EXTENSION        131 5457.090946 5456.540835
#&gt; LO-REDUCTION     133 5457.060194 5456.540835
#&gt; LO-REDUCTION     135 5456.900799 5456.540835
#&gt; LO-REDUCTION     137 5456.892275 5456.540835
#&gt; LO-REDUCTION     139 5456.887618 5456.540835
#&gt; LO-REDUCTION     141 5456.887310 5456.540835
#&gt; LO-REDUCTION     143 5456.866070 5456.540835
#&gt; LO-REDUCTION     145 5456.775998 5456.540835
#&gt; LO-REDUCTION     147 5456.736141 5456.540835
#&gt; LO-REDUCTION     149 5456.713530 5456.540835
#&gt; EXTENSION        151 5456.708633 5456.428413
#&gt; EXTENSION        153 5456.625132 5456.282092
#&gt; LO-REDUCTION     155 5456.597974 5456.282092
#&gt; LO-REDUCTION     157 5456.585268 5456.282092
#&gt; EXTENSION        159 5456.569802 5456.119953
#&gt; LO-REDUCTION     161 5456.540835 5456.119953
#&gt; LO-REDUCTION     163 5456.428413 5456.119953
#&gt; EXTENSION        165 5456.386307 5456.032101
#&gt; LO-REDUCTION     167 5456.362764 5456.032101
#&gt; EXTENSION        169 5456.282092 5455.768583
#&gt; LO-REDUCTION     171 5456.216795 5455.768583
#&gt; EXTENSION        173 5456.148807 5455.655231
#&gt; LO-REDUCTION     175 5456.119953 5455.655231
#&gt; LO-REDUCTION     177 5456.062631 5455.655231
#&gt; EXTENSION        179 5456.032101 5455.580833
#&gt; REFLECTION       181 5455.849684 5455.521867
#&gt; LO-REDUCTION     183 5455.807326 5455.521867
#&gt; REFLECTION       185 5455.768583 5455.499024
#&gt; LO-REDUCTION     187 5455.744554 5455.499024
#&gt; EXTENSION        189 5455.655231 5455.373265
#&gt; HI-REDUCTION     191 5455.580833 5455.373265
#&gt; LO-REDUCTION     193 5455.553028 5455.373265
#&gt; LO-REDUCTION     195 5455.536074 5455.373265
#&gt; LO-REDUCTION     197 5455.521867 5455.373265
#&gt; REFLECTION       199 5455.499162 5455.346031
#&gt; LO-REDUCTION     201 5455.499024 5455.346031
#&gt; LO-REDUCTION     203 5455.450532 5455.346031
#&gt; LO-REDUCTION     205 5455.406456 5455.346031
#&gt; LO-REDUCTION     207 5455.392472 5455.346031
#&gt; REFLECTION       209 5455.387341 5455.337424
#&gt; HI-REDUCTION     211 5455.380186 5455.337424
#&gt; LO-REDUCTION     213 5455.373265 5455.337424
#&gt; REFLECTION       215 5455.371712 5455.331477
#&gt; LO-REDUCTION     217 5455.355287 5455.331477
#&gt; LO-REDUCTION     219 5455.354828 5455.331477
#&gt; REFLECTION       221 5455.346295 5455.327985
#&gt; LO-REDUCTION     223 5455.346031 5455.327985
#&gt; REFLECTION       225 5455.337424 5455.326251
#&gt; LO-REDUCTION     227 5455.335269 5455.326251
#&gt; EXTENSION        229 5455.334465 5455.313082
#&gt; LO-REDUCTION     231 5455.331477 5455.313082
#&gt; LO-REDUCTION     233 5455.330288 5455.313082
#&gt; LO-REDUCTION     235 5455.329782 5455.313082
#&gt; LO-REDUCTION     237 5455.327985 5455.313082
#&gt; LO-REDUCTION     239 5455.326251 5455.313082
#&gt; LO-REDUCTION     241 5455.325751 5455.313082
#&gt; EXTENSION        243 5455.321887 5455.304379
#&gt; EXTENSION        245 5455.315509 5455.296334
#&gt; LO-REDUCTION     247 5455.315213 5455.296334
#&gt; LO-REDUCTION     249 5455.314553 5455.296334
#&gt; LO-REDUCTION     251 5455.314028 5455.296334
#&gt; LO-REDUCTION     253 5455.313082 5455.296334
#&gt; REFLECTION       255 5455.304379 5455.291551
#&gt; LO-REDUCTION     257 5455.303363 5455.291551
#&gt; LO-REDUCTION     259 5455.300989 5455.291551
#&gt; LO-REDUCTION     261 5455.299536 5455.291551
#&gt; EXTENSION        263 5455.297916 5455.287224
#&gt; LO-REDUCTION     265 5455.296334 5455.287224
#&gt; LO-REDUCTION     267 5455.295167 5455.287224
#&gt; LO-REDUCTION     269 5455.294674 5455.287224
#&gt; EXTENSION        271 5455.293003 5455.280916
#&gt; LO-REDUCTION     273 5455.291551 5455.280916
#&gt; LO-REDUCTION     275 5455.290788 5455.280916
#&gt; EXTENSION        277 5455.289452 5455.278215
#&gt; LO-REDUCTION     279 5455.287877 5455.278215
#&gt; LO-REDUCTION     281 5455.287224 5455.278215
#&gt; EXTENSION        283 5455.284767 5455.275671
#&gt; EXTENSION        285 5455.283511 5455.274057
#&gt; REFLECTION       287 5455.281231 5455.272931
#&gt; LO-REDUCTION     289 5455.280916 5455.272920
#&gt; LO-REDUCTION     291 5455.278851 5455.272920
#&gt; LO-REDUCTION     293 5455.278215 5455.272920
#&gt; HI-REDUCTION     295 5455.275671 5455.272920
#&gt; LO-REDUCTION     297 5455.274947 5455.272920
#&gt; REFLECTION       299 5455.274160 5455.272047
#&gt; LO-REDUCTION     301 5455.274057 5455.272047
#&gt; REFLECTION       303 5455.273331 5455.271813
#&gt; LO-REDUCTION     305 5455.273200 5455.271813
#&gt; LO-REDUCTION     307 5455.272931 5455.271813
#&gt; LO-REDUCTION     309 5455.272920 5455.271813
#&gt; REFLECTION       311 5455.272712 5455.271417
#&gt; HI-REDUCTION     313 5455.272260 5455.271417
#&gt; LO-REDUCTION     315 5455.272159 5455.271417
#&gt; LO-REDUCTION     317 5455.272047 5455.271417
#&gt; LO-REDUCTION     319 5455.272004 5455.271417
#&gt; REFLECTION       321 5455.271989 5455.271364
#&gt; LO-REDUCTION     323 5455.271813 5455.271350
#&gt; REFLECTION       325 5455.271602 5455.271150
#&gt; LO-REDUCTION     327 5455.271571 5455.271150
#&gt; EXTENSION        329 5455.271425 5455.270840
#&gt; LO-REDUCTION     331 5455.271417 5455.270840
#&gt; LO-REDUCTION     333 5455.271364 5455.270840
#&gt; LO-REDUCTION     335 5455.271350 5455.270840
#&gt; EXTENSION        337 5455.271305 5455.270439
#&gt; LO-REDUCTION     339 5455.271150 5455.270439
#&gt; LO-REDUCTION     341 5455.271096 5455.270439
#&gt; EXTENSION        343 5455.271076 5455.270171
#&gt; EXTENSION        345 5455.270921 5455.269661
#&gt; LO-REDUCTION     347 5455.270840 5455.269661
#&gt; EXTENSION        349 5455.270664 5455.269213
#&gt; LO-REDUCTION     351 5455.270521 5455.269213
#&gt; LO-REDUCTION     353 5455.270439 5455.269213
#&gt; EXTENSION        355 5455.270171 5455.268997
#&gt; EXTENSION        357 5455.270088 5455.268369
#&gt; REFLECTION       359 5455.269661 5455.268273
#&gt; LO-REDUCTION     361 5455.269327 5455.268273
#&gt; LO-REDUCTION     363 5455.269264 5455.268273
#&gt; LO-REDUCTION     365 5455.269213 5455.268273
#&gt; LO-REDUCTION     367 5455.268997 5455.268273
#&gt; REFLECTION       369 5455.268607 5455.268264
#&gt; LO-REDUCTION     371 5455.268505 5455.268264
#&gt; LO-REDUCTION     373 5455.268462 5455.268264
#&gt; REFLECTION       375 5455.268448 5455.268152
#&gt; LO-REDUCTION     377 5455.268369 5455.268152
#&gt; LO-REDUCTION     379 5455.268298 5455.268152
#&gt; EXTENSION        381 5455.268289 5455.268060
#&gt; LO-REDUCTION     383 5455.268273 5455.268060
#&gt; HI-REDUCTION     385 5455.268264 5455.268060
#&gt; LO-REDUCTION     387 5455.268206 5455.268060
#&gt; REFLECTION       389 5455.268168 5455.268054
#&gt; EXTENSION        391 5455.268158 5455.267990
#&gt; REFLECTION       393 5455.268152 5455.267986
#&gt; REFLECTION       395 5455.268110 5455.267971
#&gt; LO-REDUCTION     397 5455.268090 5455.267971
#&gt; LO-REDUCTION     399 5455.268060 5455.267968
#&gt; LO-REDUCTION     401 5455.268054 5455.267963
#&gt; Exiting from Nelder Mead minimizer
#&gt;     403 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0704477   1.4870458  -3.0014819  -0.9919897  -0.4253420   0.3061800 
#&gt; 
#&gt; $value
#&gt; [1] 5455.268
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      403 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.328 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==============                                                        |  20%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6076.090502
#&gt;   Scaled convergence tolerance is 9.05408e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11946.975790 5703.724857
#&gt; LO-REDUCTION       9 7880.636718 5703.724857
#&gt; LO-REDUCTION      11 7480.556654 5703.724857
#&gt; REFLECTION        13 6790.891682 5673.898425
#&gt; LO-REDUCTION      15 6516.446490 5673.898425
#&gt; LO-REDUCTION      17 6388.982754 5673.898425
#&gt; REFLECTION        19 6291.224369 5656.506794
#&gt; REFLECTION        21 6076.090502 5491.560068
#&gt; LO-REDUCTION      23 5926.241846 5491.560068
#&gt; LO-REDUCTION      25 5921.539493 5491.560068
#&gt; LO-REDUCTION      27 5703.724857 5491.560068
#&gt; HI-REDUCTION      29 5673.898425 5491.560068
#&gt; LO-REDUCTION      31 5656.506794 5491.560068
#&gt; LO-REDUCTION      33 5563.093611 5491.560068
#&gt; LO-REDUCTION      35 5545.859206 5491.560068
#&gt; LO-REDUCTION      37 5534.208361 5491.524658
#&gt; HI-REDUCTION      39 5530.259819 5491.524658
#&gt; LO-REDUCTION      41 5500.289112 5491.361826
#&gt; REFLECTION        43 5497.311073 5488.621299
#&gt; REFLECTION        45 5497.241690 5484.454334
#&gt; HI-REDUCTION      47 5492.193268 5484.454334
#&gt; LO-REDUCTION      49 5491.560068 5483.619433
#&gt; HI-REDUCTION      51 5491.524658 5483.399223
#&gt; HI-REDUCTION      53 5491.361826 5483.399223
#&gt; LO-REDUCTION      55 5488.621299 5481.688266
#&gt; LO-REDUCTION      57 5486.117345 5481.514891
#&gt; LO-REDUCTION      59 5484.454334 5480.344518
#&gt; HI-REDUCTION      61 5484.086162 5480.344518
#&gt; HI-REDUCTION      63 5483.619433 5480.344518
#&gt; LO-REDUCTION      65 5483.399223 5480.344518
#&gt; LO-REDUCTION      67 5481.688266 5480.344518
#&gt; LO-REDUCTION      69 5481.514891 5480.342682
#&gt; LO-REDUCTION      71 5481.464803 5480.095689
#&gt; LO-REDUCTION      73 5480.942841 5479.922048
#&gt; REFLECTION        75 5480.884571 5479.623839
#&gt; LO-REDUCTION      77 5480.416814 5479.623839
#&gt; LO-REDUCTION      79 5480.344518 5479.623839
#&gt; LO-REDUCTION      81 5480.342682 5479.623839
#&gt; LO-REDUCTION      83 5480.095689 5479.519498
#&gt; REFLECTION        85 5479.922048 5479.292027
#&gt; HI-REDUCTION      87 5479.842892 5479.292027
#&gt; LO-REDUCTION      89 5479.829594 5479.292027
#&gt; LO-REDUCTION      91 5479.826601 5479.292027
#&gt; REFLECTION        93 5479.623839 5479.249976
#&gt; LO-REDUCTION      95 5479.524101 5479.249976
#&gt; REFLECTION        97 5479.519498 5479.176516
#&gt; LO-REDUCTION      99 5479.458029 5479.176516
#&gt; LO-REDUCTION     101 5479.371628 5479.176516
#&gt; LO-REDUCTION     103 5479.317720 5479.176516
#&gt; HI-REDUCTION     105 5479.292027 5479.176516
#&gt; REFLECTION       107 5479.249976 5479.154767
#&gt; REFLECTION       109 5479.230063 5479.135486
#&gt; LO-REDUCTION     111 5479.205245 5479.135486
#&gt; LO-REDUCTION     113 5479.192939 5479.135486
#&gt; REFLECTION       115 5479.181253 5479.119570
#&gt; REFLECTION       117 5479.176516 5479.097279
#&gt; REFLECTION       119 5479.162602 5479.088097
#&gt; REFLECTION       121 5479.154767 5479.071520
#&gt; LO-REDUCTION     123 5479.139437 5479.071520
#&gt; LO-REDUCTION     125 5479.135486 5479.071520
#&gt; LO-REDUCTION     127 5479.119570 5479.071520
#&gt; REFLECTION       129 5479.097279 5479.050701
#&gt; LO-REDUCTION     131 5479.088097 5479.050701
#&gt; HI-REDUCTION     133 5479.083659 5479.050701
#&gt; LO-REDUCTION     135 5479.082870 5479.050701
#&gt; LO-REDUCTION     137 5479.078858 5479.050701
#&gt; LO-REDUCTION     139 5479.071520 5479.050701
#&gt; REFLECTION       141 5479.068971 5479.050248
#&gt; EXTENSION        143 5479.059466 5479.033633
#&gt; LO-REDUCTION     145 5479.058531 5479.033633
#&gt; LO-REDUCTION     147 5479.054253 5479.033633
#&gt; LO-REDUCTION     149 5479.053401 5479.033633
#&gt; LO-REDUCTION     151 5479.050701 5479.033633
#&gt; EXTENSION        153 5479.050248 5479.025570
#&gt; LO-REDUCTION     155 5479.046186 5479.025570
#&gt; REFLECTION       157 5479.041816 5479.024609
#&gt; REFLECTION       159 5479.038827 5479.023606
#&gt; LO-REDUCTION     161 5479.036547 5479.023606
#&gt; EXTENSION        163 5479.033712 5479.009805
#&gt; LO-REDUCTION     165 5479.033633 5479.009805
#&gt; LO-REDUCTION     167 5479.025570 5479.009805
#&gt; LO-REDUCTION     169 5479.024609 5479.009805
#&gt; LO-REDUCTION     171 5479.024082 5479.009805
#&gt; EXTENSION        173 5479.023606 5479.000651
#&gt; EXTENSION        175 5479.016121 5478.996929
#&gt; EXTENSION        177 5479.013416 5478.980054
#&gt; LO-REDUCTION     179 5479.012486 5478.980054
#&gt; EXTENSION        181 5479.012265 5478.974230
#&gt; LO-REDUCTION     183 5479.009805 5478.974230
#&gt; LO-REDUCTION     185 5479.000651 5478.974230
#&gt; REFLECTION       187 5478.996929 5478.972181
#&gt; EXTENSION        189 5478.987405 5478.941470
#&gt; LO-REDUCTION     191 5478.984636 5478.941470
#&gt; LO-REDUCTION     193 5478.980054 5478.941470
#&gt; LO-REDUCTION     195 5478.974866 5478.941470
#&gt; LO-REDUCTION     197 5478.974230 5478.941470
#&gt; EXTENSION        199 5478.972181 5478.920324
#&gt; LO-REDUCTION     201 5478.958557 5478.920324
#&gt; LO-REDUCTION     203 5478.957172 5478.920324
#&gt; LO-REDUCTION     205 5478.951912 5478.920324
#&gt; LO-REDUCTION     207 5478.951283 5478.920324
#&gt; EXTENSION        209 5478.941470 5478.904003
#&gt; LO-REDUCTION     211 5478.933264 5478.904003
#&gt; EXTENSION        213 5478.929367 5478.888675
#&gt; EXTENSION        215 5478.922461 5478.878721
#&gt; LO-REDUCTION     217 5478.921168 5478.878721
#&gt; EXTENSION        219 5478.920324 5478.867828
#&gt; LO-REDUCTION     221 5478.908902 5478.867828
#&gt; EXTENSION        223 5478.904003 5478.851070
#&gt; LO-REDUCTION     225 5478.891929 5478.851070
#&gt; EXTENSION        227 5478.888675 5478.833324
#&gt; LO-REDUCTION     229 5478.878721 5478.833324
#&gt; LO-REDUCTION     231 5478.878044 5478.833324
#&gt; LO-REDUCTION     233 5478.867828 5478.833324
#&gt; LO-REDUCTION     235 5478.863402 5478.833324
#&gt; LO-REDUCTION     237 5478.858395 5478.833324
#&gt; LO-REDUCTION     239 5478.851274 5478.833324
#&gt; LO-REDUCTION     241 5478.851070 5478.833324
#&gt; LO-REDUCTION     243 5478.846106 5478.833324
#&gt; LO-REDUCTION     245 5478.844864 5478.833324
#&gt; EXTENSION        247 5478.844207 5478.822966
#&gt; LO-REDUCTION     249 5478.836369 5478.822966
#&gt; EXTENSION        251 5478.836361 5478.820266
#&gt; LO-REDUCTION     253 5478.834628 5478.820266
#&gt; EXTENSION        255 5478.834245 5478.814679
#&gt; EXTENSION        257 5478.833324 5478.800981
#&gt; LO-REDUCTION     259 5478.824152 5478.800981
#&gt; LO-REDUCTION     261 5478.824046 5478.800981
#&gt; EXTENSION        263 5478.822966 5478.799180
#&gt; EXTENSION        265 5478.820266 5478.786709
#&gt; REFLECTION       267 5478.814679 5478.785345
#&gt; LO-REDUCTION     269 5478.811535 5478.785345
#&gt; EXTENSION        271 5478.802495 5478.758750
#&gt; LO-REDUCTION     273 5478.800981 5478.758750
#&gt; LO-REDUCTION     275 5478.799180 5478.758750
#&gt; EXTENSION        277 5478.788270 5478.747033
#&gt; LO-REDUCTION     279 5478.786709 5478.747033
#&gt; LO-REDUCTION     281 5478.785345 5478.747033
#&gt; LO-REDUCTION     283 5478.778532 5478.747033
#&gt; EXTENSION        285 5478.778515 5478.735389
#&gt; EXTENSION        287 5478.762260 5478.695641
#&gt; LO-REDUCTION     289 5478.758750 5478.695641
#&gt; LO-REDUCTION     291 5478.755619 5478.695641
#&gt; LO-REDUCTION     293 5478.750704 5478.695641
#&gt; LO-REDUCTION     295 5478.747033 5478.695641
#&gt; LO-REDUCTION     297 5478.735389 5478.695641
#&gt; EXTENSION        299 5478.719752 5478.658078
#&gt; LO-REDUCTION     301 5478.714987 5478.658078
#&gt; LO-REDUCTION     303 5478.706481 5478.658078
#&gt; LO-REDUCTION     305 5478.702654 5478.658078
#&gt; EXTENSION        307 5478.701380 5478.643558
#&gt; EXTENSION        309 5478.695641 5478.612542
#&gt; EXTENSION        311 5478.668179 5478.599763
#&gt; LO-REDUCTION     313 5478.663661 5478.599763
#&gt; LO-REDUCTION     315 5478.662454 5478.599763
#&gt; LO-REDUCTION     317 5478.658078 5478.599763
#&gt; REFLECTION       319 5478.643558 5478.596298
#&gt; LO-REDUCTION     321 5478.625929 5478.596298
#&gt; LO-REDUCTION     323 5478.617712 5478.596298
#&gt; EXTENSION        325 5478.612542 5478.587996
#&gt; LO-REDUCTION     327 5478.609083 5478.587996
#&gt; EXTENSION        329 5478.609008 5478.580556
#&gt; LO-REDUCTION     331 5478.599763 5478.580556
#&gt; LO-REDUCTION     333 5478.598956 5478.580556
#&gt; LO-REDUCTION     335 5478.597660 5478.580556
#&gt; EXTENSION        337 5478.596298 5478.560851
#&gt; LO-REDUCTION     339 5478.587996 5478.560851
#&gt; LO-REDUCTION     341 5478.587324 5478.560851
#&gt; LO-REDUCTION     343 5478.586488 5478.560851
#&gt; LO-REDUCTION     345 5478.582398 5478.560851
#&gt; LO-REDUCTION     347 5478.580556 5478.560851
#&gt; EXTENSION        349 5478.578948 5478.558892
#&gt; EXTENSION        351 5478.573500 5478.538113
#&gt; LO-REDUCTION     353 5478.572957 5478.538113
#&gt; EXTENSION        355 5478.566185 5478.526400
#&gt; LO-REDUCTION     357 5478.564079 5478.526400
#&gt; LO-REDUCTION     359 5478.560851 5478.526400
#&gt; LO-REDUCTION     361 5478.558892 5478.526400
#&gt; EXTENSION        363 5478.553233 5478.500422
#&gt; LO-REDUCTION     365 5478.538113 5478.500422
#&gt; LO-REDUCTION     367 5478.536063 5478.500422
#&gt; LO-REDUCTION     369 5478.533100 5478.500422
#&gt; EXTENSION        371 5478.530554 5478.481299
#&gt; LO-REDUCTION     373 5478.526400 5478.481299
#&gt; REFLECTION       375 5478.513386 5478.479623
#&gt; LO-REDUCTION     377 5478.511626 5478.479623
#&gt; LO-REDUCTION     379 5478.504998 5478.479623
#&gt; EXTENSION        381 5478.500422 5478.468425
#&gt; LO-REDUCTION     383 5478.490089 5478.468425
#&gt; REFLECTION       385 5478.489996 5478.467922
#&gt; REFLECTION       387 5478.482535 5478.465506
#&gt; LO-REDUCTION     389 5478.481299 5478.465506
#&gt; LO-REDUCTION     391 5478.479623 5478.465506
#&gt; REFLECTION       393 5478.474237 5478.465421
#&gt; EXTENSION        395 5478.468550 5478.455870
#&gt; LO-REDUCTION     397 5478.468425 5478.455870
#&gt; LO-REDUCTION     399 5478.467922 5478.455870
#&gt; LO-REDUCTION     401 5478.466216 5478.455870
#&gt; LO-REDUCTION     403 5478.465506 5478.455870
#&gt; REFLECTION       405 5478.465421 5478.452716
#&gt; REFLECTION       407 5478.459441 5478.450281
#&gt; REFLECTION       409 5478.458498 5478.449850
#&gt; REFLECTION       411 5478.456647 5478.449352
#&gt; REFLECTION       413 5478.455932 5478.448725
#&gt; LO-REDUCTION     415 5478.455870 5478.448725
#&gt; EXTENSION        417 5478.452716 5478.440724
#&gt; LO-REDUCTION     419 5478.450972 5478.440724
#&gt; LO-REDUCTION     421 5478.450281 5478.440724
#&gt; LO-REDUCTION     423 5478.449850 5478.440724
#&gt; EXTENSION        425 5478.449352 5478.436409
#&gt; EXTENSION        427 5478.448725 5478.430295
#&gt; LO-REDUCTION     429 5478.446676 5478.430295
#&gt; EXTENSION        431 5478.445376 5478.420816
#&gt; LO-REDUCTION     433 5478.442453 5478.420816
#&gt; LO-REDUCTION     435 5478.440724 5478.420816
#&gt; EXTENSION        437 5478.438820 5478.409786
#&gt; LO-REDUCTION     439 5478.436409 5478.409786
#&gt; EXTENSION        441 5478.430295 5478.393848
#&gt; LO-REDUCTION     443 5478.424651 5478.393848
#&gt; EXTENSION        445 5478.423141 5478.380870
#&gt; EXTENSION        447 5478.420816 5478.366540
#&gt; LO-REDUCTION     449 5478.411590 5478.366540
#&gt; EXTENSION        451 5478.409786 5478.344491
#&gt; LO-REDUCTION     453 5478.397243 5478.344491
#&gt; LO-REDUCTION     455 5478.393848 5478.344491
#&gt; LO-REDUCTION     457 5478.380870 5478.344491
#&gt; REFLECTION       459 5478.377725 5478.341554
#&gt; EXTENSION        461 5478.366540 5478.300763
#&gt; LO-REDUCTION     463 5478.351342 5478.300763
#&gt; LO-REDUCTION     465 5478.348983 5478.300763
#&gt; LO-REDUCTION     467 5478.347823 5478.300763
#&gt; LO-REDUCTION     469 5478.344491 5478.300763
#&gt; LO-REDUCTION     471 5478.341554 5478.300763
#&gt; EXTENSION        473 5478.332638 5478.286469
#&gt; EXTENSION        475 5478.322054 5478.276484
#&gt; LO-REDUCTION     477 5478.319284 5478.276484
#&gt; LO-REDUCTION     479 5478.316793 5478.276484
#&gt; EXTENSION        481 5478.308240 5478.256803
#&gt; LO-REDUCTION     483 5478.300763 5478.256803
#&gt; LO-REDUCTION     485 5478.286469 5478.256803
#&gt; REFLECTION       487 5478.281306 5478.256573
#&gt; LO-REDUCTION     489 5478.279057 5478.256573
#&gt; REFLECTION       491 5478.276484 5478.256551
#&gt; HI-REDUCTION     493 5478.268686 5478.256551
#&gt; EXTENSION        495 5478.260784 5478.236673
#&gt; LO-REDUCTION     497 5478.260596 5478.236673
#&gt; LO-REDUCTION     499 5478.258346 5478.236673
#&gt; LO-REDUCTION     501 5478.256803 5478.236673
#&gt; HI-REDUCTION     503 5478.256573 5478.236673
#&gt; LO-REDUCTION     505 5478.256551 5478.236673
#&gt; LO-REDUCTION     507 5478.249262 5478.236673
#&gt; LO-REDUCTION     509 5478.247872 5478.236673
#&gt; REFLECTION       511 5478.247790 5478.235404
#&gt; REFLECTION       513 5478.246506 5478.232737
#&gt; EXTENSION        515 5478.242025 5478.220002
#&gt; LO-REDUCTION     517 5478.237879 5478.220002
#&gt; LO-REDUCTION     519 5478.237308 5478.220002
#&gt; LO-REDUCTION     521 5478.236673 5478.220002
#&gt; LO-REDUCTION     523 5478.235404 5478.220002
#&gt; LO-REDUCTION     525 5478.232737 5478.220002
#&gt; REFLECTION       527 5478.230093 5478.219340
#&gt; REFLECTION       529 5478.228211 5478.217775
#&gt; EXTENSION        531 5478.225738 5478.213915
#&gt; LO-REDUCTION     533 5478.225244 5478.213915
#&gt; EXTENSION        535 5478.220231 5478.206630
#&gt; LO-REDUCTION     537 5478.220002 5478.206630
#&gt; LO-REDUCTION     539 5478.219340 5478.206630
#&gt; LO-REDUCTION     541 5478.217775 5478.206630
#&gt; EXTENSION        543 5478.216611 5478.204459
#&gt; REFLECTION       545 5478.213915 5478.202674
#&gt; LO-REDUCTION     547 5478.211416 5478.202674
#&gt; EXTENSION        549 5478.208563 5478.192403
#&gt; LO-REDUCTION     551 5478.208062 5478.192403
#&gt; LO-REDUCTION     553 5478.206630 5478.192403
#&gt; LO-REDUCTION     555 5478.204459 5478.192403
#&gt; LO-REDUCTION     557 5478.203111 5478.192403
#&gt; LO-REDUCTION     559 5478.202674 5478.192403
#&gt; LO-REDUCTION     561 5478.200822 5478.192403
#&gt; LO-REDUCTION     563 5478.200620 5478.192403
#&gt; LO-REDUCTION     565 5478.200102 5478.192403
#&gt; EXTENSION        567 5478.197132 5478.187473
#&gt; LO-REDUCTION     569 5478.196520 5478.187473
#&gt; LO-REDUCTION     571 5478.195332 5478.187473
#&gt; EXTENSION        573 5478.193862 5478.182578
#&gt; LO-REDUCTION     575 5478.192886 5478.182578
#&gt; LO-REDUCTION     577 5478.192403 5478.182578
#&gt; LO-REDUCTION     579 5478.191052 5478.182578
#&gt; EXTENSION        581 5478.187597 5478.175311
#&gt; LO-REDUCTION     583 5478.187473 5478.175311
#&gt; EXTENSION        585 5478.183833 5478.167937
#&gt; LO-REDUCTION     587 5478.183665 5478.167937
#&gt; LO-REDUCTION     589 5478.183485 5478.167937
#&gt; LO-REDUCTION     591 5478.182578 5478.167937
#&gt; LO-REDUCTION     593 5478.180474 5478.167937
#&gt; EXTENSION        595 5478.176843 5478.153756
#&gt; LO-REDUCTION     597 5478.175311 5478.153756
#&gt; LO-REDUCTION     599 5478.171626 5478.153756
#&gt; EXTENSION        601 5478.169501 5478.147214
#&gt; LO-REDUCTION     603 5478.168217 5478.147214
#&gt; EXTENSION        605 5478.167937 5478.130766
#&gt; LO-REDUCTION     607 5478.158859 5478.130766
#&gt; LO-REDUCTION     609 5478.156420 5478.130766
#&gt; EXTENSION        611 5478.153756 5478.123274
#&gt; EXTENSION        613 5478.148194 5478.112938
#&gt; LO-REDUCTION     615 5478.147214 5478.112938
#&gt; EXTENSION        617 5478.137224 5478.101734
#&gt; EXTENSION        619 5478.132806 5478.090170
#&gt; LO-REDUCTION     621 5478.130766 5478.090170
#&gt; LO-REDUCTION     623 5478.126685 5478.090170
#&gt; LO-REDUCTION     625 5478.123274 5478.090170
#&gt; LO-REDUCTION     627 5478.112938 5478.090170
#&gt; LO-REDUCTION     629 5478.109244 5478.090170
#&gt; EXTENSION        631 5478.106405 5478.069380
#&gt; LO-REDUCTION     633 5478.101734 5478.069380
#&gt; LO-REDUCTION     635 5478.097340 5478.069380
#&gt; EXTENSION        637 5478.093974 5478.052496
#&gt; LO-REDUCTION     639 5478.090643 5478.052496
#&gt; EXTENSION        641 5478.090170 5478.035407
#&gt; LO-REDUCTION     643 5478.080420 5478.035407
#&gt; EXTENSION        645 5478.074136 5478.001736
#&gt; LO-REDUCTION     647 5478.069380 5478.001736
#&gt; EXTENSION        649 5478.058340 5477.979161
#&gt; LO-REDUCTION     651 5478.052496 5477.979161
#&gt; EXTENSION        653 5478.039678 5477.949788
#&gt; LO-REDUCTION     655 5478.035407 5477.949788
#&gt; EXTENSION        657 5478.012873 5477.884486
#&gt; LO-REDUCTION     659 5478.001736 5477.884486
#&gt; LO-REDUCTION     661 5477.990760 5477.884486
#&gt; LO-REDUCTION     663 5477.979161 5477.884486
#&gt; LO-REDUCTION     665 5477.953541 5477.884486
#&gt; LO-REDUCTION     667 5477.949788 5477.884486
#&gt; REFLECTION       669 5477.931564 5477.881335
#&gt; EXTENSION        671 5477.923083 5477.832824
#&gt; LO-REDUCTION     673 5477.894976 5477.832824
#&gt; LO-REDUCTION     675 5477.891361 5477.832824
#&gt; LO-REDUCTION     677 5477.888697 5477.832824
#&gt; EXTENSION        679 5477.884486 5477.821150
#&gt; LO-REDUCTION     681 5477.881335 5477.821150
#&gt; EXTENSION        683 5477.848325 5477.800325
#&gt; EXTENSION        685 5477.848076 5477.792742
#&gt; EXTENSION        687 5477.845179 5477.777898
#&gt; LO-REDUCTION     689 5477.842979 5477.777898
#&gt; EXTENSION        691 5477.832824 5477.715985
#&gt; LO-REDUCTION     693 5477.821150 5477.715985
#&gt; LO-REDUCTION     695 5477.800325 5477.715985
#&gt; LO-REDUCTION     697 5477.792742 5477.715985
#&gt; HI-REDUCTION     699 5477.783366 5477.715985
#&gt; EXTENSION        701 5477.777898 5477.622625
#&gt; LO-REDUCTION     703 5477.750613 5477.622625
#&gt; EXTENSION        705 5477.746518 5477.566394
#&gt; LO-REDUCTION     707 5477.724725 5477.566394
#&gt; LO-REDUCTION     709 5477.724345 5477.566394
#&gt; EXTENSION        711 5477.715985 5477.443529
#&gt; EXTENSION        713 5477.640904 5477.313088
#&gt; LO-REDUCTION     715 5477.622625 5477.313088
#&gt; LO-REDUCTION     717 5477.605325 5477.313088
#&gt; EXTENSION        719 5477.590289 5477.221678
#&gt; EXTENSION        721 5477.566394 5476.977198
#&gt; EXTENSION        723 5477.443529 5476.661501
#&gt; LO-REDUCTION     725 5477.371710 5476.661501
#&gt; LO-REDUCTION     727 5477.316745 5476.661501
#&gt; LO-REDUCTION     729 5477.313088 5476.661501
#&gt; EXTENSION        731 5477.221678 5476.474146
#&gt; EXTENSION        733 5476.977198 5475.900343
#&gt; LO-REDUCTION     735 5476.886121 5475.900343
#&gt; LO-REDUCTION     737 5476.744028 5475.900343
#&gt; LO-REDUCTION     739 5476.737206 5475.900343
#&gt; EXTENSION        741 5476.661501 5475.487281
#&gt; LO-REDUCTION     743 5476.474146 5475.487281
#&gt; EXTENSION        745 5476.059679 5475.083365
#&gt; LO-REDUCTION     747 5476.049362 5475.083365
#&gt; LO-REDUCTION     749 5475.983757 5475.083365
#&gt; LO-REDUCTION     751 5475.900343 5475.083365
#&gt; LO-REDUCTION     753 5475.869724 5475.083365
#&gt; LO-REDUCTION     755 5475.547462 5475.083365
#&gt; REFLECTION       757 5475.487281 5475.021273
#&gt; LO-REDUCTION     759 5475.345664 5475.021273
#&gt; LO-REDUCTION     761 5475.283841 5475.021273
#&gt; REFLECTION       763 5475.172354 5474.995329
#&gt; REFLECTION       765 5475.137589 5474.988868
#&gt; LO-REDUCTION     767 5475.131877 5474.988868
#&gt; EXTENSION        769 5475.083365 5474.867057
#&gt; LO-REDUCTION     771 5475.078952 5474.867057
#&gt; EXTENSION        773 5475.021273 5474.787446
#&gt; LO-REDUCTION     775 5475.002800 5474.787446
#&gt; EXTENSION        777 5474.995329 5474.693449
#&gt; LO-REDUCTION     779 5474.988868 5474.693449
#&gt; LO-REDUCTION     781 5474.946077 5474.693449
#&gt; EXTENSION        783 5474.884034 5474.639665
#&gt; EXTENSION        785 5474.867057 5474.579987
#&gt; REFLECTION       787 5474.787446 5474.538242
#&gt; LO-REDUCTION     789 5474.735709 5474.538242
#&gt; EXTENSION        791 5474.702618 5474.399589
#&gt; LO-REDUCTION     793 5474.693449 5474.399589
#&gt; HI-REDUCTION     795 5474.639665 5474.399589
#&gt; EXTENSION        797 5474.583234 5474.318148
#&gt; LO-REDUCTION     799 5474.579987 5474.318148
#&gt; LO-REDUCTION     801 5474.553931 5474.318148
#&gt; REFLECTION       803 5474.538242 5474.295735
#&gt; REFLECTION       805 5474.531769 5474.250480
#&gt; EXTENSION        807 5474.399589 5474.055467
#&gt; LO-REDUCTION     809 5474.339049 5474.055467
#&gt; LO-REDUCTION     811 5474.324211 5474.055467
#&gt; LO-REDUCTION     813 5474.318148 5474.055467
#&gt; LO-REDUCTION     815 5474.295735 5474.055467
#&gt; LO-REDUCTION     817 5474.250480 5474.055467
#&gt; LO-REDUCTION     819 5474.196258 5474.055467
#&gt; LO-REDUCTION     821 5474.127255 5474.055467
#&gt; LO-REDUCTION     823 5474.119654 5474.055467
#&gt; REFLECTION       825 5474.085065 5474.032597
#&gt; LO-REDUCTION     827 5474.069790 5474.032597
#&gt; LO-REDUCTION     829 5474.059054 5474.032597
#&gt; LO-REDUCTION     831 5474.058639 5474.032597
#&gt; LO-REDUCTION     833 5474.058398 5474.032597
#&gt; LO-REDUCTION     835 5474.055467 5474.032597
#&gt; LO-REDUCTION     837 5474.051847 5474.032597
#&gt; REFLECTION       839 5474.041118 5474.031811
#&gt; REFLECTION       841 5474.036229 5474.028564
#&gt; HI-REDUCTION     843 5474.034897 5474.028564
#&gt; EXTENSION        845 5474.034879 5474.018664
#&gt; HI-REDUCTION     847 5474.034475 5474.018664
#&gt; LO-REDUCTION     849 5474.032597 5474.018664
#&gt; LO-REDUCTION     851 5474.031811 5474.018664
#&gt; HI-REDUCTION     853 5474.029932 5474.018664
#&gt; EXTENSION        855 5474.028564 5474.014487
#&gt; REFLECTION       857 5474.027141 5474.012986
#&gt; LO-REDUCTION     859 5474.024236 5474.012986
#&gt; REFLECTION       861 5474.020906 5474.009546
#&gt; REFLECTION       863 5474.019408 5474.008835
#&gt; LO-REDUCTION     865 5474.018664 5474.008835
#&gt; REFLECTION       867 5474.014487 5474.007494
#&gt; LO-REDUCTION     869 5474.013752 5474.007494
#&gt; REFLECTION       871 5474.012986 5474.004861
#&gt; LO-REDUCTION     873 5474.009921 5474.004861
#&gt; EXTENSION        875 5474.009546 5474.004015
#&gt; LO-REDUCTION     877 5474.008835 5474.004015
#&gt; EXTENSION        879 5474.007908 5473.998695
#&gt; LO-REDUCTION     881 5474.007494 5473.998695
#&gt; LO-REDUCTION     883 5474.007070 5473.998695
#&gt; EXTENSION        885 5474.005428 5473.995742
#&gt; EXTENSION        887 5474.004861 5473.992807
#&gt; LO-REDUCTION     889 5474.004015 5473.992807
#&gt; LO-REDUCTION     891 5474.003350 5473.992807
#&gt; REFLECTION       893 5473.999809 5473.991873
#&gt; REFLECTION       895 5473.998695 5473.991441
#&gt; EXTENSION        897 5473.996647 5473.985749
#&gt; LO-REDUCTION     899 5473.995742 5473.985749
#&gt; LO-REDUCTION     901 5473.993641 5473.985749
#&gt; LO-REDUCTION     903 5473.992807 5473.985749
#&gt; LO-REDUCTION     905 5473.991873 5473.985749
#&gt; LO-REDUCTION     907 5473.991441 5473.985749
#&gt; LO-REDUCTION     909 5473.990173 5473.985749
#&gt; LO-REDUCTION     911 5473.989531 5473.985749
#&gt; LO-REDUCTION     913 5473.989264 5473.985749
#&gt; EXTENSION        915 5473.988215 5473.982640
#&gt; LO-REDUCTION     917 5473.987446 5473.982640
#&gt; LO-REDUCTION     919 5473.987389 5473.982640
#&gt; LO-REDUCTION     921 5473.987156 5473.982640
#&gt; EXTENSION        923 5473.987120 5473.980360
#&gt; EXTENSION        925 5473.985749 5473.978643
#&gt; LO-REDUCTION     927 5473.985026 5473.978643
#&gt; EXTENSION        929 5473.984262 5473.974564
#&gt; EXTENSION        931 5473.983339 5473.969246
#&gt; LO-REDUCTION     933 5473.982640 5473.969246
#&gt; LO-REDUCTION     935 5473.980360 5473.969246
#&gt; LO-REDUCTION     937 5473.979303 5473.969246
#&gt; EXTENSION        939 5473.978643 5473.960002
#&gt; LO-REDUCTION     941 5473.974564 5473.960002
#&gt; LO-REDUCTION     943 5473.970902 5473.960002
#&gt; LO-REDUCTION     945 5473.970178 5473.960002
#&gt; EXTENSION        947 5473.969980 5473.958507
#&gt; EXTENSION        949 5473.969246 5473.944829
#&gt; LO-REDUCTION     951 5473.960947 5473.944829
#&gt; LO-REDUCTION     953 5473.960880 5473.944829
#&gt; LO-REDUCTION     955 5473.960249 5473.944829
#&gt; LO-REDUCTION     957 5473.960002 5473.944829
#&gt; LO-REDUCTION     959 5473.958507 5473.944829
#&gt; LO-REDUCTION     961 5473.952713 5473.944829
#&gt; EXTENSION        963 5473.951216 5473.942827
#&gt; EXTENSION        965 5473.950189 5473.937010
#&gt; EXTENSION        967 5473.947776 5473.934221
#&gt; LO-REDUCTION     969 5473.946769 5473.934221
#&gt; LO-REDUCTION     971 5473.945667 5473.934221
#&gt; EXTENSION        973 5473.944829 5473.927730
#&gt; LO-REDUCTION     975 5473.942827 5473.927730
#&gt; LO-REDUCTION     977 5473.937470 5473.927730
#&gt; LO-REDUCTION     979 5473.937289 5473.927730
#&gt; LO-REDUCTION     981 5473.937010 5473.927730
#&gt; LO-REDUCTION     983 5473.936067 5473.927730
#&gt; REFLECTION       985 5473.934221 5473.926402
#&gt; REFLECTION       987 5473.930495 5473.925069
#&gt; EXTENSION        989 5473.930323 5473.924115
#&gt; EXTENSION        991 5473.930212 5473.916990
#&gt; LO-REDUCTION     993 5473.928719 5473.916990
#&gt; LO-REDUCTION     995 5473.927730 5473.916990
#&gt; EXTENSION        997 5473.926402 5473.916691
#&gt; EXTENSION        999 5473.925069 5473.908507
#&gt; LO-REDUCTION    1001 5473.924115 5473.908507
#&gt; EXTENSION       1003 5473.918965 5473.897973
#&gt; LO-REDUCTION    1005 5473.918212 5473.897973
#&gt; LO-REDUCTION    1007 5473.916990 5473.897973
#&gt; LO-REDUCTION    1009 5473.916691 5473.897973
#&gt; EXTENSION       1011 5473.910466 5473.888808
#&gt; LO-REDUCTION    1013 5473.908507 5473.888808
#&gt; LO-REDUCTION    1015 5473.906470 5473.888808
#&gt; EXTENSION       1017 5473.901974 5473.880540
#&gt; EXTENSION       1019 5473.900927 5473.879474
#&gt; LO-REDUCTION    1021 5473.897973 5473.879474
#&gt; LO-REDUCTION    1023 5473.894341 5473.879474
#&gt; EXTENSION       1025 5473.890177 5473.870642
#&gt; LO-REDUCTION    1027 5473.888808 5473.870642
#&gt; LO-REDUCTION    1029 5473.880992 5473.870642
#&gt; LO-REDUCTION    1031 5473.880540 5473.870642
#&gt; HI-REDUCTION    1033 5473.880155 5473.870642
#&gt; LO-REDUCTION    1035 5473.879474 5473.870642
#&gt; LO-REDUCTION    1037 5473.879269 5473.870642
#&gt; LO-REDUCTION    1039 5473.877159 5473.870642
#&gt; REFLECTION      1041 5473.875801 5473.869801
#&gt; LO-REDUCTION    1043 5473.874980 5473.869801
#&gt; REFLECTION      1045 5473.873823 5473.869120
#&gt; LO-REDUCTION    1047 5473.873355 5473.869120
#&gt; REFLECTION      1049 5473.872016 5473.868325
#&gt; REFLECTION      1051 5473.871431 5473.867770
#&gt; HI-REDUCTION    1053 5473.870642 5473.867770
#&gt; LO-REDUCTION    1055 5473.870092 5473.867770
#&gt; EXTENSION       1057 5473.869801 5473.867068
#&gt; LO-REDUCTION    1059 5473.869405 5473.867068
#&gt; LO-REDUCTION    1061 5473.869120 5473.867068
#&gt; REFLECTION      1063 5473.868329 5473.866555
#&gt; REFLECTION      1065 5473.868325 5473.866407
#&gt; LO-REDUCTION    1067 5473.867770 5473.866407
#&gt; EXTENSION       1069 5473.867740 5473.865602
#&gt; LO-REDUCTION    1071 5473.867275 5473.865602
#&gt; LO-REDUCTION    1073 5473.867211 5473.865602
#&gt; EXTENSION       1075 5473.867068 5473.864146
#&gt; LO-REDUCTION    1077 5473.866555 5473.864146
#&gt; LO-REDUCTION    1079 5473.866407 5473.864146
#&gt; LO-REDUCTION    1081 5473.866096 5473.864146
#&gt; LO-REDUCTION    1083 5473.866085 5473.864146
#&gt; REFLECTION      1085 5473.865602 5473.864098
#&gt; EXTENSION       1087 5473.865373 5473.863922
#&gt; EXTENSION       1089 5473.865285 5473.862816
#&gt; EXTENSION       1091 5473.864896 5473.861481
#&gt; LO-REDUCTION    1093 5473.864283 5473.861481
#&gt; LO-REDUCTION    1095 5473.864146 5473.861481
#&gt; LO-REDUCTION    1097 5473.864098 5473.861481
#&gt; LO-REDUCTION    1099 5473.863922 5473.861481
#&gt; EXTENSION       1101 5473.862816 5473.859072
#&gt; LO-REDUCTION    1103 5473.862756 5473.859072
#&gt; LO-REDUCTION    1105 5473.862202 5473.859072
#&gt; LO-REDUCTION    1107 5473.862145 5473.859072
#&gt; LO-REDUCTION    1109 5473.861980 5473.859072
#&gt; EXTENSION       1111 5473.861481 5473.857212
#&gt; LO-REDUCTION    1113 5473.861341 5473.857212
#&gt; EXTENSION       1115 5473.860241 5473.856475
#&gt; EXTENSION       1117 5473.859489 5473.854418
#&gt; LO-REDUCTION    1119 5473.859101 5473.854418
#&gt; LO-REDUCTION    1121 5473.859072 5473.854418
#&gt; LO-REDUCTION    1123 5473.857443 5473.854418
#&gt; LO-REDUCTION    1125 5473.857212 5473.854418
#&gt; LO-REDUCTION    1127 5473.856475 5473.854418
#&gt; EXTENSION       1129 5473.856228 5473.854090
#&gt; EXTENSION       1131 5473.855954 5473.853067
#&gt; LO-REDUCTION    1133 5473.855232 5473.853067
#&gt; EXTENSION       1135 5473.855185 5473.852217
#&gt; REFLECTION      1137 5473.854541 5473.852191
#&gt; LO-REDUCTION    1139 5473.854418 5473.852191
#&gt; LO-REDUCTION    1141 5473.854090 5473.852191
#&gt; REFLECTION      1143 5473.853138 5473.852109
#&gt; REFLECTION      1145 5473.853067 5473.851949
#&gt; HI-REDUCTION    1147 5473.852917 5473.851949
#&gt; EXTENSION       1149 5473.852780 5473.850717
#&gt; LO-REDUCTION    1151 5473.852380 5473.850717
#&gt; LO-REDUCTION    1153 5473.852217 5473.850717
#&gt; EXTENSION       1155 5473.852191 5473.849739
#&gt; LO-REDUCTION    1157 5473.852109 5473.849739
#&gt; EXTENSION       1159 5473.851949 5473.848850
#&gt; EXTENSION       1161 5473.851057 5473.846394
#&gt; LO-REDUCTION    1163 5473.850925 5473.846394
#&gt; LO-REDUCTION    1165 5473.850717 5473.846394
#&gt; EXTENSION       1167 5473.850561 5473.844926
#&gt; EXTENSION       1169 5473.849739 5473.842806
#&gt; EXTENSION       1171 5473.848850 5473.840363
#&gt; EXTENSION       1173 5473.847580 5473.835063
#&gt; LO-REDUCTION    1175 5473.846588 5473.835063
#&gt; EXTENSION       1177 5473.846394 5473.829774
#&gt; LO-REDUCTION    1179 5473.844926 5473.829774
#&gt; LO-REDUCTION    1181 5473.842806 5473.829774
#&gt; EXTENSION       1183 5473.840363 5473.819855
#&gt; LO-REDUCTION    1185 5473.836458 5473.819855
#&gt; EXTENSION       1187 5473.835063 5473.811733
#&gt; LO-REDUCTION    1189 5473.831641 5473.811733
#&gt; LO-REDUCTION    1191 5473.830153 5473.811733
#&gt; EXTENSION       1193 5473.829774 5473.806946
#&gt; REFLECTION      1195 5473.820213 5473.806249
#&gt; LO-REDUCTION    1197 5473.819855 5473.806249
#&gt; LO-REDUCTION    1199 5473.818726 5473.806249
#&gt; REFLECTION      1201 5473.816110 5473.805450
#&gt; LO-REDUCTION    1203 5473.811733 5473.805305
#&gt; HI-REDUCTION    1205 5473.810156 5473.805305
#&gt; EXTENSION       1207 5473.807489 5473.800004
#&gt; LO-REDUCTION    1209 5473.807159 5473.800004
#&gt; HI-REDUCTION    1211 5473.806946 5473.800004
#&gt; LO-REDUCTION    1213 5473.806249 5473.800004
#&gt; EXTENSION       1215 5473.805450 5473.796992
#&gt; LO-REDUCTION    1217 5473.805305 5473.796992
#&gt; LO-REDUCTION    1219 5473.804660 5473.796992
#&gt; LO-REDUCTION    1221 5473.803844 5473.796992
#&gt; EXTENSION       1223 5473.800504 5473.788841
#&gt; LO-REDUCTION    1225 5473.800004 5473.788841
#&gt; LO-REDUCTION    1227 5473.799050 5473.788841
#&gt; LO-REDUCTION    1229 5473.798274 5473.788841
#&gt; LO-REDUCTION    1231 5473.797634 5473.788841
#&gt; EXTENSION       1233 5473.796992 5473.782514
#&gt; LO-REDUCTION    1235 5473.794594 5473.782514
#&gt; LO-REDUCTION    1237 5473.794251 5473.782514
#&gt; EXTENSION       1239 5473.790756 5473.772603
#&gt; LO-REDUCTION    1241 5473.790132 5473.772603
#&gt; LO-REDUCTION    1243 5473.788841 5473.772603
#&gt; LO-REDUCTION    1245 5473.786782 5473.772603
#&gt; EXTENSION       1247 5473.784110 5473.763519
#&gt; EXTENSION       1249 5473.782514 5473.755271
#&gt; LO-REDUCTION    1251 5473.777105 5473.755271
#&gt; LO-REDUCTION    1253 5473.776008 5473.755271
#&gt; EXTENSION       1255 5473.773186 5473.737946
#&gt; LO-REDUCTION    1257 5473.772603 5473.737946
#&gt; LO-REDUCTION    1259 5473.763519 5473.737946
#&gt; EXTENSION       1261 5473.757498 5473.736690
#&gt; EXTENSION       1263 5473.757078 5473.721351
#&gt; EXTENSION       1265 5473.755271 5473.708821
#&gt; LO-REDUCTION    1267 5473.741716 5473.708821
#&gt; LO-REDUCTION    1269 5473.738185 5473.708821
#&gt; REFLECTION      1271 5473.737946 5473.708168
#&gt; LO-REDUCTION    1273 5473.736690 5473.708168
#&gt; LO-REDUCTION    1275 5473.721351 5473.708168
#&gt; REFLECTION      1277 5473.717087 5473.705055
#&gt; REFLECTION      1279 5473.715178 5473.703139
#&gt; REFLECTION      1281 5473.712494 5473.700956
#&gt; LO-REDUCTION    1283 5473.708821 5473.700956
#&gt; LO-REDUCTION    1285 5473.708341 5473.700956
#&gt; REFLECTION      1287 5473.708168 5473.698649
#&gt; LO-REDUCTION    1289 5473.705055 5473.698649
#&gt; EXTENSION       1291 5473.703139 5473.696837
#&gt; EXTENSION       1293 5473.701840 5473.691436
#&gt; LO-REDUCTION    1295 5473.701801 5473.691436
#&gt; EXTENSION       1297 5473.700956 5473.690114
#&gt; LO-REDUCTION    1299 5473.700077 5473.690114
#&gt; REFLECTION      1301 5473.698649 5473.689319
#&gt; HI-REDUCTION    1303 5473.696837 5473.689319
#&gt; EXTENSION       1305 5473.694892 5473.684229
#&gt; EXTENSION       1307 5473.692668 5473.680021
#&gt; LO-REDUCTION    1309 5473.691436 5473.680021
#&gt; LO-REDUCTION    1311 5473.691297 5473.680021
#&gt; LO-REDUCTION    1313 5473.690114 5473.680021
#&gt; REFLECTION      1315 5473.689319 5473.678858
#&gt; LO-REDUCTION    1317 5473.684229 5473.678858
#&gt; LO-REDUCTION    1319 5473.682557 5473.678858
#&gt; EXTENSION       1321 5473.682545 5473.676146
#&gt; LO-REDUCTION    1323 5473.680829 5473.676146
#&gt; LO-REDUCTION    1325 5473.680021 5473.676146
#&gt; LO-REDUCTION    1327 5473.679334 5473.676146
#&gt; LO-REDUCTION    1329 5473.679028 5473.676146
#&gt; HI-REDUCTION    1331 5473.678858 5473.676146
#&gt; REFLECTION      1333 5473.677350 5473.676054
#&gt; REFLECTION      1335 5473.677123 5473.675354
#&gt; LO-REDUCTION    1337 5473.676803 5473.675354
#&gt; REFLECTION      1339 5473.676559 5473.675063
#&gt; REFLECTION      1341 5473.676435 5473.674732
#&gt; HI-REDUCTION    1343 5473.676146 5473.674732
#&gt; REFLECTION      1345 5473.676054 5473.674592
#&gt; LO-REDUCTION    1347 5473.675635 5473.674592
#&gt; REFLECTION      1349 5473.675494 5473.674574
#&gt; EXTENSION       1351 5473.675354 5473.674070
#&gt; REFLECTION      1353 5473.675063 5473.674016
#&gt; EXTENSION       1355 5473.675062 5473.673764
#&gt; LO-REDUCTION    1357 5473.674732 5473.673764
#&gt; REFLECTION      1359 5473.674592 5473.673737
#&gt; REFLECTION      1361 5473.674574 5473.673585
#&gt; REFLECTION      1363 5473.674070 5473.673244
#&gt; HI-REDUCTION    1365 5473.674016 5473.673244
#&gt; LO-REDUCTION    1367 5473.673935 5473.673244
#&gt; REFLECTION      1369 5473.673764 5473.673047
#&gt; HI-REDUCTION    1371 5473.673737 5473.673047
#&gt; LO-REDUCTION    1373 5473.673596 5473.673047
#&gt; LO-REDUCTION    1375 5473.673585 5473.673047
#&gt; REFLECTION      1377 5473.673357 5473.672993
#&gt; LO-REDUCTION    1379 5473.673331 5473.672993
#&gt; EXTENSION       1381 5473.673244 5473.672885
#&gt; REFLECTION      1383 5473.673223 5473.672871
#&gt; REFLECTION      1385 5473.673163 5473.672742
#&gt; EXTENSION       1387 5473.673053 5473.672306
#&gt; LO-REDUCTION    1389 5473.673047 5473.672306
#&gt; LO-REDUCTION    1391 5473.672993 5473.672306
#&gt; LO-REDUCTION    1393 5473.672885 5473.672306
#&gt; LO-REDUCTION    1395 5473.672871 5473.672306
#&gt; EXTENSION       1397 5473.672742 5473.672141
#&gt; EXTENSION       1399 5473.672486 5473.672003
#&gt; LO-REDUCTION    1401 5473.672458 5473.672003
#&gt; LO-REDUCTION    1403 5473.672442 5473.672003
#&gt; REFLECTION      1405 5473.672394 5473.671828
#&gt; LO-REDUCTION    1407 5473.672306 5473.671828
#&gt; LO-REDUCTION    1409 5473.672141 5473.671828
#&gt; LO-REDUCTION    1411 5473.672028 5473.671828
#&gt; REFLECTION      1413 5473.672026 5473.671795
#&gt; HI-REDUCTION    1415 5473.672003 5473.671795
#&gt; LO-REDUCTION    1417 5473.671969 5473.671795
#&gt; EXTENSION       1419 5473.671896 5473.671683
#&gt; LO-REDUCTION    1421 5473.671869 5473.671683
#&gt; LO-REDUCTION    1423 5473.671860 5473.671683
#&gt; LO-REDUCTION    1425 5473.671828 5473.671683
#&gt; LO-REDUCTION    1427 5473.671816 5473.671683
#&gt; LO-REDUCTION    1429 5473.671795 5473.671683
#&gt; LO-REDUCTION    1431 5473.671775 5473.671683
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1433 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9967236   1.4920430  -3.0005300  -0.9597687  -0.7087151   0.2986886 
#&gt; 
#&gt; $value
#&gt; [1] 5473.672
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1433 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     1.164 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=====================                                                 |  30%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6028.033114
#&gt;   Scaled convergence tolerance is 8.98247e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11593.066572 5679.510749
#&gt; LO-REDUCTION       9 7773.219637 5679.510749
#&gt; LO-REDUCTION      11 7502.989804 5679.510749
#&gt; REFLECTION        13 6880.399483 5657.142401
#&gt; LO-REDUCTION      15 6556.269186 5657.142401
#&gt; LO-REDUCTION      17 6311.413989 5657.142401
#&gt; REFLECTION        19 6237.015101 5625.528380
#&gt; REFLECTION        21 6028.033114 5454.618833
#&gt; LO-REDUCTION      23 5830.711793 5454.618833
#&gt; LO-REDUCTION      25 5828.719964 5454.618833
#&gt; LO-REDUCTION      27 5679.510749 5454.618833
#&gt; HI-REDUCTION      29 5657.142401 5454.618833
#&gt; LO-REDUCTION      31 5625.528380 5454.618833
#&gt; LO-REDUCTION      33 5539.817437 5454.618833
#&gt; LO-REDUCTION      35 5527.030671 5454.618833
#&gt; LO-REDUCTION      37 5491.365488 5454.618833
#&gt; HI-REDUCTION      39 5486.621103 5454.618833
#&gt; HI-REDUCTION      41 5470.992053 5454.618833
#&gt; LO-REDUCTION      43 5468.089849 5454.618833
#&gt; LO-REDUCTION      45 5467.820341 5454.113322
#&gt; LO-REDUCTION      47 5465.208996 5454.113322
#&gt; LO-REDUCTION      49 5462.705397 5454.113322
#&gt; HI-REDUCTION      51 5461.158106 5454.113322
#&gt; LO-REDUCTION      53 5455.090648 5452.534175
#&gt; LO-REDUCTION      55 5455.063475 5452.105396
#&gt; HI-REDUCTION      57 5455.032727 5452.105396
#&gt; EXTENSION         59 5454.804530 5449.226007
#&gt; LO-REDUCTION      61 5454.618833 5449.226007
#&gt; LO-REDUCTION      63 5454.113322 5449.226007
#&gt; LO-REDUCTION      65 5452.534175 5449.226007
#&gt; LO-REDUCTION      67 5452.364611 5449.226007
#&gt; REFLECTION        69 5452.105396 5448.962783
#&gt; REFLECTION        71 5451.195614 5448.739426
#&gt; LO-REDUCTION      73 5450.684519 5448.739426
#&gt; HI-REDUCTION      75 5450.673753 5448.739426
#&gt; REFLECTION        77 5450.654406 5448.075869
#&gt; LO-REDUCTION      79 5449.496231 5448.075869
#&gt; LO-REDUCTION      81 5449.465381 5448.075869
#&gt; LO-REDUCTION      83 5449.226007 5448.075869
#&gt; LO-REDUCTION      85 5448.962783 5448.075869
#&gt; HI-REDUCTION      87 5448.749891 5448.075869
#&gt; LO-REDUCTION      89 5448.739426 5448.075869
#&gt; LO-REDUCTION      91 5448.524554 5448.075869
#&gt; EXTENSION         93 5448.455706 5447.809098
#&gt; LO-REDUCTION      95 5448.444587 5447.809098
#&gt; EXTENSION         97 5448.209841 5447.473185
#&gt; LO-REDUCTION      99 5448.183170 5447.473185
#&gt; LO-REDUCTION     101 5448.182097 5447.473185
#&gt; LO-REDUCTION     103 5448.075869 5447.473185
#&gt; REFLECTION       105 5447.984121 5447.326068
#&gt; LO-REDUCTION     107 5447.809098 5447.326068
#&gt; LO-REDUCTION     109 5447.588732 5447.326068
#&gt; EXTENSION        111 5447.554646 5447.126744
#&gt; LO-REDUCTION     113 5447.549099 5447.126744
#&gt; EXTENSION        115 5447.473185 5446.986274
#&gt; EXTENSION        117 5447.379066 5446.802521
#&gt; EXTENSION        119 5447.336342 5446.724036
#&gt; LO-REDUCTION     121 5447.326068 5446.724036
#&gt; LO-REDUCTION     123 5447.261282 5446.724036
#&gt; LO-REDUCTION     125 5447.126744 5446.724036
#&gt; LO-REDUCTION     127 5447.011329 5446.724036
#&gt; EXTENSION        129 5446.986274 5446.536440
#&gt; EXTENSION        131 5446.821763 5446.310326
#&gt; LO-REDUCTION     133 5446.809845 5446.310326
#&gt; EXTENSION        135 5446.802521 5446.116923
#&gt; LO-REDUCTION     137 5446.759005 5446.116923
#&gt; EXTENSION        139 5446.724036 5445.882806
#&gt; EXTENSION        141 5446.536440 5445.718336
#&gt; LO-REDUCTION     143 5446.399121 5445.718336
#&gt; LO-REDUCTION     145 5446.346764 5445.718336
#&gt; REFLECTION       147 5446.310326 5445.583298
#&gt; REFLECTION       149 5446.116923 5445.548975
#&gt; LO-REDUCTION     151 5445.896350 5445.548975
#&gt; REFLECTION       153 5445.882806 5445.525148
#&gt; HI-REDUCTION     155 5445.769138 5445.525148
#&gt; LO-REDUCTION     157 5445.718336 5445.525148
#&gt; REFLECTION       159 5445.630016 5445.483059
#&gt; LO-REDUCTION     161 5445.583298 5445.483059
#&gt; HI-REDUCTION     163 5445.574337 5445.483059
#&gt; REFLECTION       165 5445.548975 5445.459615
#&gt; EXTENSION        167 5445.544776 5445.402547
#&gt; LO-REDUCTION     169 5445.525148 5445.402547
#&gt; LO-REDUCTION     171 5445.504961 5445.402547
#&gt; EXTENSION        173 5445.503302 5445.373484
#&gt; LO-REDUCTION     175 5445.483059 5445.373484
#&gt; REFLECTION       177 5445.459615 5445.337223
#&gt; LO-REDUCTION     179 5445.430656 5445.337223
#&gt; LO-REDUCTION     181 5445.422832 5445.337223
#&gt; LO-REDUCTION     183 5445.402547 5445.337223
#&gt; REFLECTION       185 5445.389938 5445.314930
#&gt; REFLECTION       187 5445.384871 5445.313483
#&gt; EXTENSION        189 5445.373484 5445.228297
#&gt; LO-REDUCTION     191 5445.339877 5445.228297
#&gt; LO-REDUCTION     193 5445.339498 5445.228297
#&gt; REFLECTION       195 5445.337223 5445.228237
#&gt; LO-REDUCTION     197 5445.314930 5445.228237
#&gt; LO-REDUCTION     199 5445.313483 5445.225666
#&gt; REFLECTION       201 5445.269404 5445.203074
#&gt; REFLECTION       203 5445.233552 5445.195186
#&gt; LO-REDUCTION     205 5445.230537 5445.195186
#&gt; LO-REDUCTION     207 5445.228297 5445.195186
#&gt; LO-REDUCTION     209 5445.228237 5445.195186
#&gt; EXTENSION        211 5445.225666 5445.176030
#&gt; LO-REDUCTION     213 5445.211798 5445.176030
#&gt; EXTENSION        215 5445.203703 5445.160404
#&gt; EXTENSION        217 5445.203074 5445.137593
#&gt; LO-REDUCTION     219 5445.202883 5445.137593
#&gt; LO-REDUCTION     221 5445.195186 5445.137593
#&gt; LO-REDUCTION     223 5445.183257 5445.137593
#&gt; REFLECTION       225 5445.176030 5445.136619
#&gt; REFLECTION       227 5445.160404 5445.133461
#&gt; REFLECTION       229 5445.157502 5445.130364
#&gt; REFLECTION       231 5445.156756 5445.127361
#&gt; REFLECTION       233 5445.152463 5445.119825
#&gt; EXTENSION        235 5445.137593 5445.088673
#&gt; LO-REDUCTION     237 5445.136619 5445.088673
#&gt; LO-REDUCTION     239 5445.133461 5445.088673
#&gt; LO-REDUCTION     241 5445.130364 5445.088673
#&gt; EXTENSION        243 5445.127361 5445.080491
#&gt; LO-REDUCTION     245 5445.119825 5445.080491
#&gt; EXTENSION        247 5445.113145 5445.054928
#&gt; LO-REDUCTION     249 5445.108688 5445.054928
#&gt; LO-REDUCTION     251 5445.102867 5445.054928
#&gt; LO-REDUCTION     253 5445.093992 5445.054928
#&gt; EXTENSION        255 5445.088673 5445.032552
#&gt; LO-REDUCTION     257 5445.080491 5445.032552
#&gt; LO-REDUCTION     259 5445.067763 5445.032552
#&gt; LO-REDUCTION     261 5445.059134 5445.032552
#&gt; EXTENSION        263 5445.055831 5445.024912
#&gt; LO-REDUCTION     265 5445.054928 5445.024912
#&gt; REFLECTION       267 5445.045246 5445.024703
#&gt; REFLECTION       269 5445.039777 5445.018654
#&gt; LO-REDUCTION     271 5445.037773 5445.018654
#&gt; LO-REDUCTION     273 5445.036212 5445.018654
#&gt; EXTENSION        275 5445.032552 5445.004600
#&gt; LO-REDUCTION     277 5445.024912 5445.004600
#&gt; LO-REDUCTION     279 5445.024703 5445.004600
#&gt; LO-REDUCTION     281 5445.022388 5445.004600
#&gt; LO-REDUCTION     283 5445.021716 5445.004600
#&gt; LO-REDUCTION     285 5445.018654 5445.004600
#&gt; LO-REDUCTION     287 5445.017086 5445.004600
#&gt; LO-REDUCTION     289 5445.013619 5445.004600
#&gt; EXTENSION        291 5445.012383 5445.000500
#&gt; LO-REDUCTION     293 5445.012338 5445.000500
#&gt; LO-REDUCTION     295 5445.009195 5445.000500
#&gt; LO-REDUCTION     297 5445.006862 5445.000500
#&gt; EXTENSION        299 5445.005402 5444.997241
#&gt; EXTENSION        301 5445.005143 5444.990511
#&gt; LO-REDUCTION     303 5445.004600 5444.990511
#&gt; LO-REDUCTION     305 5445.000668 5444.990511
#&gt; LO-REDUCTION     307 5445.000582 5444.990511
#&gt; LO-REDUCTION     309 5445.000500 5444.990511
#&gt; EXTENSION        311 5444.997241 5444.987399
#&gt; EXTENSION        313 5444.994594 5444.978708
#&gt; LO-REDUCTION     315 5444.993760 5444.978708
#&gt; LO-REDUCTION     317 5444.993651 5444.978708
#&gt; EXTENSION        319 5444.990633 5444.967591
#&gt; LO-REDUCTION     321 5444.990511 5444.967591
#&gt; LO-REDUCTION     323 5444.987399 5444.967591
#&gt; EXTENSION        325 5444.983406 5444.960729
#&gt; LO-REDUCTION     327 5444.981792 5444.960729
#&gt; EXTENSION        329 5444.978708 5444.949217
#&gt; LO-REDUCTION     331 5444.975253 5444.949217
#&gt; EXTENSION        333 5444.974529 5444.942954
#&gt; EXTENSION        335 5444.967591 5444.921546
#&gt; LO-REDUCTION     337 5444.961309 5444.921546
#&gt; LO-REDUCTION     339 5444.960729 5444.921546
#&gt; LO-REDUCTION     341 5444.954654 5444.921546
#&gt; LO-REDUCTION     343 5444.949217 5444.921546
#&gt; LO-REDUCTION     345 5444.942954 5444.921546
#&gt; EXTENSION        347 5444.939340 5444.914613
#&gt; LO-REDUCTION     349 5444.932295 5444.914613
#&gt; LO-REDUCTION     351 5444.929945 5444.914613
#&gt; REFLECTION       353 5444.928154 5444.911502
#&gt; REFLECTION       355 5444.927196 5444.908390
#&gt; LO-REDUCTION     357 5444.921546 5444.908390
#&gt; HI-REDUCTION     359 5444.915860 5444.908390
#&gt; REFLECTION       361 5444.915698 5444.907816
#&gt; REFLECTION       363 5444.914613 5444.906683
#&gt; REFLECTION       365 5444.913282 5444.905874
#&gt; REFLECTION       367 5444.911502 5444.905127
#&gt; REFLECTION       369 5444.909035 5444.905090
#&gt; REFLECTION       371 5444.908390 5444.903746
#&gt; REFLECTION       373 5444.907816 5444.903252
#&gt; REFLECTION       375 5444.906683 5444.902664
#&gt; LO-REDUCTION     377 5444.905874 5444.902664
#&gt; LO-REDUCTION     379 5444.905127 5444.902626
#&gt; HI-REDUCTION     381 5444.905090 5444.902626
#&gt; REFLECTION       383 5444.903746 5444.901483
#&gt; LO-REDUCTION     385 5444.903252 5444.901483
#&gt; HI-REDUCTION     387 5444.902966 5444.901483
#&gt; REFLECTION       389 5444.902875 5444.901288
#&gt; HI-REDUCTION     391 5444.902664 5444.901288
#&gt; LO-REDUCTION     393 5444.902626 5444.901288
#&gt; LO-REDUCTION     395 5444.902171 5444.901288
#&gt; REFLECTION       397 5444.902044 5444.901125
#&gt; REFLECTION       399 5444.901828 5444.901074
#&gt; LO-REDUCTION     401 5444.901754 5444.901074
#&gt; LO-REDUCTION     403 5444.901483 5444.901074
#&gt; LO-REDUCTION     405 5444.901462 5444.901074
#&gt; LO-REDUCTION     407 5444.901288 5444.901074
#&gt; REFLECTION       409 5444.901233 5444.900924
#&gt; REFLECTION       411 5444.901125 5444.900863
#&gt; LO-REDUCTION     413 5444.901109 5444.900863
#&gt; REFLECTION       415 5444.901098 5444.900812
#&gt; LO-REDUCTION     417 5444.901074 5444.900812
#&gt; LO-REDUCTION     419 5444.901074 5444.900812
#&gt; REFLECTION       421 5444.900956 5444.900768
#&gt; REFLECTION       423 5444.900924 5444.900719
#&gt; REFLECTION       425 5444.900879 5444.900689
#&gt; REFLECTION       427 5444.900863 5444.900630
#&gt; LO-REDUCTION     429 5444.900824 5444.900630
#&gt; REFLECTION       431 5444.900812 5444.900615
#&gt; LO-REDUCTION     433 5444.900768 5444.900615
#&gt; REFLECTION       435 5444.900719 5444.900605
#&gt; REFLECTION       437 5444.900689 5444.900584
#&gt; REFLECTION       439 5444.900660 5444.900560
#&gt; Exiting from Nelder Mead minimizer
#&gt;     441 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9980988   1.4982533  -3.0011460  -0.9732804  -0.5196167   0.2930379 
#&gt; 
#&gt; $value
#&gt; [1] 5444.901
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      441 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.356 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |============================                                          |  40%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6014.866299
#&gt;   Scaled convergence tolerance is 8.96285e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11629.499539 5667.127334
#&gt; LO-REDUCTION       9 7740.632849 5667.127334
#&gt; LO-REDUCTION      11 7442.646176 5667.127334
#&gt; REFLECTION        13 6868.402998 5666.378145
#&gt; LO-REDUCTION      15 6525.884272 5666.378145
#&gt; LO-REDUCTION      17 6268.318381 5666.378145
#&gt; REFLECTION        19 6221.735662 5644.320394
#&gt; REFLECTION        21 6014.866299 5458.215833
#&gt; LO-REDUCTION      23 5832.347360 5458.215833
#&gt; LO-REDUCTION      25 5821.801406 5458.215833
#&gt; LO-REDUCTION      27 5667.127334 5458.215833
#&gt; HI-REDUCTION      29 5666.378145 5458.215833
#&gt; LO-REDUCTION      31 5644.320394 5458.215833
#&gt; LO-REDUCTION      33 5533.494508 5458.215833
#&gt; LO-REDUCTION      35 5532.992452 5458.215833
#&gt; LO-REDUCTION      37 5529.346971 5458.215833
#&gt; LO-REDUCTION      39 5504.718962 5458.215833
#&gt; LO-REDUCTION      41 5474.266239 5458.215833
#&gt; HI-REDUCTION      43 5474.081981 5458.215833
#&gt; LO-REDUCTION      45 5470.408235 5458.215833
#&gt; LO-REDUCTION      47 5469.630015 5458.215833
#&gt; HI-REDUCTION      49 5467.929069 5458.215833
#&gt; LO-REDUCTION      51 5466.728803 5458.215833
#&gt; LO-REDUCTION      53 5463.888391 5457.493465
#&gt; HI-REDUCTION      55 5462.879859 5457.493465
#&gt; LO-REDUCTION      57 5462.214497 5457.493465
#&gt; LO-REDUCTION      59 5461.104489 5457.493465
#&gt; REFLECTION        61 5459.933627 5456.077297
#&gt; REFLECTION        63 5459.264667 5455.874931
#&gt; HI-REDUCTION      65 5458.688310 5455.874931
#&gt; LO-REDUCTION      67 5458.215833 5455.874931
#&gt; LO-REDUCTION      69 5457.963295 5455.874931
#&gt; EXTENSION         71 5457.493465 5454.249126
#&gt; EXTENSION         73 5456.948454 5453.831599
#&gt; LO-REDUCTION      75 5456.413133 5453.831599
#&gt; LO-REDUCTION      77 5456.077297 5453.831599
#&gt; REFLECTION        79 5455.910929 5453.356038
#&gt; REFLECTION        81 5455.874931 5452.866559
#&gt; LO-REDUCTION      83 5454.249126 5452.827705
#&gt; HI-REDUCTION      85 5454.080592 5452.827705
#&gt; REFLECTION        87 5453.967142 5452.439277
#&gt; REFLECTION        89 5453.831599 5452.206961
#&gt; LO-REDUCTION      91 5453.356038 5452.206961
#&gt; HI-REDUCTION      93 5453.253261 5452.206961
#&gt; LO-REDUCTION      95 5452.866559 5452.206961
#&gt; REFLECTION        97 5452.827705 5452.045233
#&gt; LO-REDUCTION      99 5452.541249 5452.034025
#&gt; LO-REDUCTION     101 5452.439277 5452.034025
#&gt; EXTENSION        103 5452.309643 5451.574222
#&gt; LO-REDUCTION     105 5452.236008 5451.574222
#&gt; LO-REDUCTION     107 5452.206961 5451.574222
#&gt; LO-REDUCTION     109 5452.115851 5451.574222
#&gt; LO-REDUCTION     111 5452.045233 5451.574222
#&gt; LO-REDUCTION     113 5452.034025 5451.574222
#&gt; EXTENSION        115 5451.932583 5451.431040
#&gt; LO-REDUCTION     117 5451.837357 5451.431040
#&gt; EXTENSION        119 5451.814867 5451.351934
#&gt; LO-REDUCTION     121 5451.776977 5451.351934
#&gt; REFLECTION       123 5451.668276 5451.343061
#&gt; LO-REDUCTION     125 5451.610466 5451.343061
#&gt; EXTENSION        127 5451.574222 5451.130540
#&gt; LO-REDUCTION     129 5451.431040 5451.130540
#&gt; LO-REDUCTION     131 5451.366329 5451.130540
#&gt; LO-REDUCTION     133 5451.358458 5451.130540
#&gt; LO-REDUCTION     135 5451.351934 5451.130540
#&gt; HI-REDUCTION     137 5451.343061 5451.130540
#&gt; EXTENSION        139 5451.271036 5451.011671
#&gt; EXTENSION        141 5451.226846 5450.943769
#&gt; LO-REDUCTION     143 5451.226243 5450.943769
#&gt; LO-REDUCTION     145 5451.172215 5450.943769
#&gt; EXTENSION        147 5451.168264 5450.832204
#&gt; EXTENSION        149 5451.130540 5450.720205
#&gt; LO-REDUCTION     151 5451.011671 5450.720205
#&gt; LO-REDUCTION     153 5450.995574 5450.720205
#&gt; EXTENSION        155 5450.963885 5450.543564
#&gt; LO-REDUCTION     157 5450.943769 5450.543564
#&gt; LO-REDUCTION     159 5450.832204 5450.543564
#&gt; LO-REDUCTION     161 5450.780376 5450.543564
#&gt; LO-REDUCTION     163 5450.764877 5450.543564
#&gt; LO-REDUCTION     165 5450.720205 5450.543564
#&gt; LO-REDUCTION     167 5450.702107 5450.543564
#&gt; EXTENSION        169 5450.661899 5450.497613
#&gt; EXTENSION        171 5450.606040 5450.409420
#&gt; LO-REDUCTION     173 5450.589431 5450.409420
#&gt; EXTENSION        175 5450.588808 5450.389355
#&gt; REFLECTION       177 5450.573340 5450.372837
#&gt; REFLECTION       179 5450.543564 5450.318501
#&gt; LO-REDUCTION     181 5450.497613 5450.318501
#&gt; LO-REDUCTION     183 5450.422708 5450.318501
#&gt; LO-REDUCTION     185 5450.409420 5450.318501
#&gt; LO-REDUCTION     187 5450.389355 5450.318501
#&gt; LO-REDUCTION     189 5450.376688 5450.318501
#&gt; EXTENSION        191 5450.372837 5450.255168
#&gt; LO-REDUCTION     193 5450.336534 5450.255168
#&gt; EXTENSION        195 5450.329958 5450.243629
#&gt; EXTENSION        197 5450.328156 5450.227941
#&gt; REFLECTION       199 5450.319306 5450.203742
#&gt; LO-REDUCTION     201 5450.318501 5450.203742
#&gt; LO-REDUCTION     203 5450.268931 5450.203742
#&gt; LO-REDUCTION     205 5450.255168 5450.203742
#&gt; EXTENSION        207 5450.243629 5450.169220
#&gt; EXTENSION        209 5450.227941 5450.129263
#&gt; LO-REDUCTION     211 5450.221449 5450.129263
#&gt; EXTENSION        213 5450.210687 5450.072071
#&gt; LO-REDUCTION     215 5450.208364 5450.072071
#&gt; EXTENSION        217 5450.203742 5449.993924
#&gt; LO-REDUCTION     219 5450.169220 5449.993924
#&gt; LO-REDUCTION     221 5450.162228 5449.993924
#&gt; LO-REDUCTION     223 5450.129263 5449.993924
#&gt; EXTENSION        225 5450.088832 5449.968093
#&gt; LO-REDUCTION     227 5450.087424 5449.968093
#&gt; REFLECTION       229 5450.072071 5449.955016
#&gt; REFLECTION       231 5450.035063 5449.935171
#&gt; LO-REDUCTION     233 5450.016952 5449.935171
#&gt; LO-REDUCTION     235 5449.993924 5449.935171
#&gt; LO-REDUCTION     237 5449.972075 5449.935171
#&gt; HI-REDUCTION     239 5449.968093 5449.935171
#&gt; LO-REDUCTION     241 5449.958885 5449.935171
#&gt; LO-REDUCTION     243 5449.955016 5449.935171
#&gt; LO-REDUCTION     245 5449.950304 5449.935171
#&gt; LO-REDUCTION     247 5449.949232 5449.935171
#&gt; LO-REDUCTION     249 5449.943774 5449.935171
#&gt; REFLECTION       251 5449.940400 5449.933002
#&gt; HI-REDUCTION     253 5449.939915 5449.933002
#&gt; LO-REDUCTION     255 5449.938024 5449.933002
#&gt; LO-REDUCTION     257 5449.937348 5449.932805
#&gt; LO-REDUCTION     259 5449.935615 5449.932653
#&gt; LO-REDUCTION     261 5449.935433 5449.932653
#&gt; REFLECTION       263 5449.935171 5449.931949
#&gt; EXTENSION        265 5449.933063 5449.926538
#&gt; LO-REDUCTION     267 5449.933002 5449.926538
#&gt; LO-REDUCTION     269 5449.932805 5449.926538
#&gt; LO-REDUCTION     271 5449.932711 5449.926538
#&gt; LO-REDUCTION     273 5449.932653 5449.926538
#&gt; LO-REDUCTION     275 5449.931949 5449.926538
#&gt; LO-REDUCTION     277 5449.931093 5449.926538
#&gt; EXTENSION        279 5449.930765 5449.925984
#&gt; EXTENSION        281 5449.929948 5449.923760
#&gt; LO-REDUCTION     283 5449.928553 5449.923760
#&gt; EXTENSION        285 5449.927247 5449.920320
#&gt; LO-REDUCTION     287 5449.927212 5449.920320
#&gt; LO-REDUCTION     289 5449.926538 5449.920320
#&gt; LO-REDUCTION     291 5449.925984 5449.920320
#&gt; LO-REDUCTION     293 5449.923780 5449.920320
#&gt; EXTENSION        295 5449.923760 5449.917438
#&gt; LO-REDUCTION     297 5449.921775 5449.917438
#&gt; LO-REDUCTION     299 5449.921170 5449.917438
#&gt; LO-REDUCTION     301 5449.921165 5449.917438
#&gt; EXTENSION        303 5449.920952 5449.914954
#&gt; LO-REDUCTION     305 5449.920320 5449.914954
#&gt; LO-REDUCTION     307 5449.919219 5449.914954
#&gt; LO-REDUCTION     309 5449.918097 5449.914954
#&gt; REFLECTION       311 5449.918058 5449.914641
#&gt; LO-REDUCTION     313 5449.917438 5449.914641
#&gt; REFLECTION       315 5449.916912 5449.914150
#&gt; REFLECTION       317 5449.915511 5449.913879
#&gt; LO-REDUCTION     319 5449.915348 5449.913879
#&gt; REFLECTION       321 5449.915159 5449.913613
#&gt; LO-REDUCTION     323 5449.914954 5449.913613
#&gt; LO-REDUCTION     325 5449.914641 5449.913613
#&gt; LO-REDUCTION     327 5449.914327 5449.913613
#&gt; REFLECTION       329 5449.914150 5449.913347
#&gt; EXTENSION        331 5449.913879 5449.912942
#&gt; HI-REDUCTION     333 5449.913784 5449.912942
#&gt; LO-REDUCTION     335 5449.913757 5449.912942
#&gt; EXTENSION        337 5449.913661 5449.912338
#&gt; LO-REDUCTION     339 5449.913613 5449.912338
#&gt; LO-REDUCTION     341 5449.913439 5449.912338
#&gt; EXTENSION        343 5449.913347 5449.912054
#&gt; LO-REDUCTION     345 5449.913143 5449.912054
#&gt; LO-REDUCTION     347 5449.912997 5449.912054
#&gt; EXTENSION        349 5449.912942 5449.911440
#&gt; EXTENSION        351 5449.912499 5449.910886
#&gt; LO-REDUCTION     353 5449.912338 5449.910886
#&gt; LO-REDUCTION     355 5449.912332 5449.910886
#&gt; LO-REDUCTION     357 5449.912173 5449.910886
#&gt; EXTENSION        359 5449.912054 5449.910548
#&gt; LO-REDUCTION     361 5449.911496 5449.910548
#&gt; LO-REDUCTION     363 5449.911440 5449.910548
#&gt; LO-REDUCTION     365 5449.911434 5449.910548
#&gt; LO-REDUCTION     367 5449.911371 5449.910548
#&gt; REFLECTION       369 5449.910886 5449.910284
#&gt; LO-REDUCTION     371 5449.910797 5449.910284
#&gt; LO-REDUCTION     373 5449.910785 5449.910284
#&gt; LO-REDUCTION     375 5449.910781 5449.910284
#&gt; LO-REDUCTION     377 5449.910699 5449.910284
#&gt; LO-REDUCTION     379 5449.910613 5449.910284
#&gt; EXTENSION        381 5449.910548 5449.910109
#&gt; LO-REDUCTION     383 5449.910511 5449.910109
#&gt; LO-REDUCTION     385 5449.910486 5449.910109
#&gt; EXTENSION        387 5449.910452 5449.909844
#&gt; LO-REDUCTION     389 5449.910299 5449.909844
#&gt; LO-REDUCTION     391 5449.910284 5449.909844
#&gt; LO-REDUCTION     393 5449.910262 5449.909844
#&gt; REFLECTION       395 5449.910216 5449.909838
#&gt; EXTENSION        397 5449.910109 5449.909256
#&gt; LO-REDUCTION     399 5449.909919 5449.909256
#&gt; LO-REDUCTION     401 5449.909917 5449.909256
#&gt; LO-REDUCTION     403 5449.909873 5449.909256
#&gt; LO-REDUCTION     405 5449.909844 5449.909256
#&gt; REFLECTION       407 5449.909838 5449.909256
#&gt; REFLECTION       409 5449.909581 5449.909074
#&gt; EXTENSION        411 5449.909505 5449.908644
#&gt; LO-REDUCTION     413 5449.909398 5449.908644
#&gt; LO-REDUCTION     415 5449.909281 5449.908644
#&gt; LO-REDUCTION     417 5449.909256 5449.908644
#&gt; EXTENSION        419 5449.909256 5449.908578
#&gt; EXTENSION        421 5449.909074 5449.908044
#&gt; LO-REDUCTION     423 5449.908961 5449.908044
#&gt; EXTENSION        425 5449.908719 5449.907819
#&gt; LO-REDUCTION     427 5449.908713 5449.907819
#&gt; EXTENSION        429 5449.908644 5449.907465
#&gt; LO-REDUCTION     431 5449.908578 5449.907465
#&gt; LO-REDUCTION     433 5449.908267 5449.907465
#&gt; LO-REDUCTION     435 5449.908044 5449.907465
#&gt; LO-REDUCTION     437 5449.907924 5449.907465
#&gt; LO-REDUCTION     439 5449.907869 5449.907465
#&gt; REFLECTION       441 5449.907819 5449.907375
#&gt; LO-REDUCTION     443 5449.907703 5449.907375
#&gt; EXTENSION        445 5449.907565 5449.907072
#&gt; LO-REDUCTION     447 5449.907545 5449.907072
#&gt; LO-REDUCTION     449 5449.907490 5449.907072
#&gt; EXTENSION        451 5449.907483 5449.906788
#&gt; EXTENSION        453 5449.907465 5449.906405
#&gt; LO-REDUCTION     455 5449.907375 5449.906405
#&gt; LO-REDUCTION     457 5449.907180 5449.906405
#&gt; LO-REDUCTION     459 5449.907145 5449.906405
#&gt; EXTENSION        461 5449.907072 5449.906258
#&gt; EXTENSION        463 5449.906788 5449.905334
#&gt; LO-REDUCTION     465 5449.906690 5449.905334
#&gt; LO-REDUCTION     467 5449.906615 5449.905334
#&gt; LO-REDUCTION     469 5449.906579 5449.905334
#&gt; EXTENSION        471 5449.906405 5449.905127
#&gt; LO-REDUCTION     473 5449.906258 5449.905127
#&gt; EXTENSION        475 5449.905918 5449.904177
#&gt; LO-REDUCTION     477 5449.905842 5449.904177
#&gt; EXTENSION        479 5449.905525 5449.903403
#&gt; LO-REDUCTION     481 5449.905379 5449.903403
#&gt; LO-REDUCTION     483 5449.905334 5449.903403
#&gt; LO-REDUCTION     485 5449.905127 5449.903403
#&gt; REFLECTION       487 5449.904460 5449.903182
#&gt; LO-REDUCTION     489 5449.904177 5449.903182
#&gt; LO-REDUCTION     491 5449.904049 5449.903182
#&gt; EXTENSION        493 5449.903815 5449.902691
#&gt; LO-REDUCTION     495 5449.903648 5449.902691
#&gt; LO-REDUCTION     497 5449.903403 5449.902691
#&gt; LO-REDUCTION     499 5449.903228 5449.902691
#&gt; LO-REDUCTION     501 5449.903224 5449.902691
#&gt; EXTENSION        503 5449.903182 5449.902562
#&gt; LO-REDUCTION     505 5449.902995 5449.902562
#&gt; LO-REDUCTION     507 5449.902944 5449.902562
#&gt; EXTENSION        509 5449.902879 5449.902415
#&gt; LO-REDUCTION     511 5449.902780 5449.902415
#&gt; LO-REDUCTION     513 5449.902692 5449.902415
#&gt; EXTENSION        515 5449.902691 5449.902340
#&gt; LO-REDUCTION     517 5449.902616 5449.902340
#&gt; LO-REDUCTION     519 5449.902562 5449.902340
#&gt; LO-REDUCTION     521 5449.902549 5449.902340
#&gt; EXTENSION        523 5449.902548 5449.902286
#&gt; LO-REDUCTION     525 5449.902430 5449.902286
#&gt; LO-REDUCTION     527 5449.902429 5449.902286
#&gt; EXTENSION        529 5449.902416 5449.902235
#&gt; LO-REDUCTION     531 5449.902415 5449.902235
#&gt; LO-REDUCTION     533 5449.902340 5449.902235
#&gt; EXTENSION        535 5449.902340 5449.902208
#&gt; LO-REDUCTION     537 5449.902299 5449.902208
#&gt; EXTENSION        539 5449.902298 5449.902147
#&gt; LO-REDUCTION     541 5449.902286 5449.902147
#&gt; LO-REDUCTION     543 5449.902252 5449.902147
#&gt; Exiting from Nelder Mead minimizer
#&gt;     545 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0439918   1.4954471  -3.0118040  -0.9612411  -0.6090079   0.2933046 
#&gt; 
#&gt; $value
#&gt; [1] 5449.902
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      545 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.448 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===================================                                   |  50%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6043.374885
#&gt;   Scaled convergence tolerance is 9.00533e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11796.145998 5695.901245
#&gt; LO-REDUCTION       9 7686.486351 5695.901245
#&gt; HI-REDUCTION      11 7473.768174 5695.901245
#&gt; LO-REDUCTION      13 6908.821592 5695.901245
#&gt; LO-REDUCTION      15 6476.747122 5695.901245
#&gt; LO-REDUCTION      17 6306.611054 5695.901245
#&gt; LO-REDUCTION      19 6251.810300 5695.901245
#&gt; EXTENSION         21 6170.090214 5513.034942
#&gt; LO-REDUCTION      23 6043.374885 5513.034942
#&gt; LO-REDUCTION      25 5783.181872 5513.034942
#&gt; LO-REDUCTION      27 5715.765027 5513.034942
#&gt; LO-REDUCTION      29 5711.271343 5513.034942
#&gt; LO-REDUCTION      31 5695.901245 5513.034942
#&gt; REFLECTION        33 5628.954136 5496.698683
#&gt; LO-REDUCTION      35 5568.931327 5496.698683
#&gt; LO-REDUCTION      37 5527.295076 5490.116427
#&gt; HI-REDUCTION      39 5526.495367 5490.116427
#&gt; REFLECTION        41 5522.541098 5489.579557
#&gt; REFLECTION        43 5513.361713 5478.339941
#&gt; HI-REDUCTION      45 5513.034942 5478.339941
#&gt; HI-REDUCTION      47 5497.712525 5478.339941
#&gt; HI-REDUCTION      49 5496.698683 5478.339941
#&gt; HI-REDUCTION      51 5490.116427 5478.339941
#&gt; REFLECTION        53 5489.579557 5477.772070
#&gt; HI-REDUCTION      55 5487.445609 5477.772070
#&gt; HI-REDUCTION      57 5484.293889 5477.772070
#&gt; LO-REDUCTION      59 5482.849186 5477.520402
#&gt; HI-REDUCTION      61 5482.277157 5477.394040
#&gt; REFLECTION        63 5479.225341 5476.121558
#&gt; LO-REDUCTION      65 5478.510368 5474.373603
#&gt; HI-REDUCTION      67 5478.339941 5474.373603
#&gt; HI-REDUCTION      69 5477.772070 5474.373603
#&gt; LO-REDUCTION      71 5477.520402 5474.373603
#&gt; HI-REDUCTION      73 5477.394040 5474.373603
#&gt; LO-REDUCTION      75 5476.121558 5474.291195
#&gt; LO-REDUCTION      77 5474.991430 5474.291195
#&gt; LO-REDUCTION      79 5474.971327 5474.090608
#&gt; LO-REDUCTION      81 5474.929083 5473.940637
#&gt; REFLECTION        83 5474.821611 5473.702223
#&gt; HI-REDUCTION      85 5474.434440 5473.702223
#&gt; HI-REDUCTION      87 5474.373603 5473.702223
#&gt; LO-REDUCTION      89 5474.291195 5473.646422
#&gt; HI-REDUCTION      91 5474.090608 5473.646422
#&gt; LO-REDUCTION      93 5473.940637 5473.604470
#&gt; LO-REDUCTION      95 5473.912582 5473.559695
#&gt; LO-REDUCTION      97 5473.851403 5473.493247
#&gt; LO-REDUCTION      99 5473.707855 5473.468966
#&gt; REFLECTION       101 5473.702223 5473.440312
#&gt; HI-REDUCTION     103 5473.646422 5473.440312
#&gt; HI-REDUCTION     105 5473.604470 5473.440312
#&gt; LO-REDUCTION     107 5473.559695 5473.440312
#&gt; EXTENSION        109 5473.493247 5473.197134
#&gt; LO-REDUCTION     111 5473.483768 5473.197134
#&gt; LO-REDUCTION     113 5473.483610 5473.197134
#&gt; LO-REDUCTION     115 5473.479223 5473.197134
#&gt; LO-REDUCTION     117 5473.468966 5473.197134
#&gt; LO-REDUCTION     119 5473.440312 5473.197134
#&gt; LO-REDUCTION     121 5473.373768 5473.197134
#&gt; EXTENSION        123 5473.337845 5473.022567
#&gt; LO-REDUCTION     125 5473.304720 5473.022567
#&gt; LO-REDUCTION     127 5473.295023 5473.022567
#&gt; EXTENSION        129 5473.283697 5472.930500
#&gt; LO-REDUCTION     131 5473.209249 5472.930500
#&gt; EXTENSION        133 5473.197134 5472.711928
#&gt; LO-REDUCTION     135 5473.140491 5472.711928
#&gt; EXTENSION        137 5473.061074 5472.631228
#&gt; EXTENSION        139 5473.022567 5472.425834
#&gt; LO-REDUCTION     141 5472.979952 5472.425834
#&gt; EXTENSION        143 5472.930500 5472.275917
#&gt; EXTENSION        145 5472.739301 5471.669936
#&gt; LO-REDUCTION     147 5472.711928 5471.669936
#&gt; LO-REDUCTION     149 5472.631228 5471.669936
#&gt; LO-REDUCTION     151 5472.441663 5471.669936
#&gt; LO-REDUCTION     153 5472.425834 5471.669936
#&gt; LO-REDUCTION     155 5472.275917 5471.669936
#&gt; REFLECTION       157 5472.157181 5471.582517
#&gt; EXTENSION        159 5472.117338 5471.240700
#&gt; LO-REDUCTION     161 5471.882640 5471.240700
#&gt; EXTENSION        163 5471.799448 5470.762953
#&gt; LO-REDUCTION     165 5471.691457 5470.762953
#&gt; LO-REDUCTION     167 5471.669936 5470.762953
#&gt; LO-REDUCTION     169 5471.582517 5470.762953
#&gt; LO-REDUCTION     171 5471.257250 5470.762953
#&gt; EXTENSION        173 5471.240700 5470.299741
#&gt; LO-REDUCTION     175 5470.921330 5470.299741
#&gt; LO-REDUCTION     177 5470.916352 5470.299741
#&gt; EXTENSION        179 5470.898152 5470.127793
#&gt; LO-REDUCTION     181 5470.765741 5470.127793
#&gt; LO-REDUCTION     183 5470.762953 5470.127793
#&gt; LO-REDUCTION     185 5470.561136 5470.127793
#&gt; EXTENSION        187 5470.511609 5469.990705
#&gt; REFLECTION       189 5470.299741 5469.984743
#&gt; LO-REDUCTION     191 5470.279520 5469.984743
#&gt; LO-REDUCTION     193 5470.236868 5469.984743
#&gt; REFLECTION       195 5470.181628 5469.919060
#&gt; LO-REDUCTION     197 5470.127793 5469.919060
#&gt; LO-REDUCTION     199 5470.059388 5469.919060
#&gt; EXTENSION        201 5470.001657 5469.844451
#&gt; LO-REDUCTION     203 5469.990705 5469.844451
#&gt; LO-REDUCTION     205 5469.986604 5469.844451
#&gt; EXTENSION        207 5469.984743 5469.797672
#&gt; REFLECTION       209 5469.965012 5469.792229
#&gt; LO-REDUCTION     211 5469.919060 5469.792229
#&gt; LO-REDUCTION     213 5469.906592 5469.792229
#&gt; REFLECTION       215 5469.901534 5469.750693
#&gt; REFLECTION       217 5469.844451 5469.726546
#&gt; EXTENSION        219 5469.807424 5469.666786
#&gt; LO-REDUCTION     221 5469.802936 5469.666786
#&gt; EXTENSION        223 5469.797672 5469.659494
#&gt; REFLECTION       225 5469.792229 5469.646684
#&gt; LO-REDUCTION     227 5469.750693 5469.646684
#&gt; REFLECTION       229 5469.726546 5469.646127
#&gt; REFLECTION       231 5469.704795 5469.642635
#&gt; REFLECTION       233 5469.666786 5469.621329
#&gt; LO-REDUCTION     235 5469.659494 5469.621329
#&gt; EXTENSION        237 5469.648653 5469.569831
#&gt; LO-REDUCTION     239 5469.646684 5469.569831
#&gt; HI-REDUCTION     241 5469.646127 5469.569831
#&gt; LO-REDUCTION     243 5469.642635 5469.569831
#&gt; LO-REDUCTION     245 5469.623586 5469.569831
#&gt; REFLECTION       247 5469.621329 5469.567654
#&gt; HI-REDUCTION     249 5469.598652 5469.567654
#&gt; LO-REDUCTION     251 5469.595443 5469.567654
#&gt; REFLECTION       253 5469.585047 5469.557956
#&gt; LO-REDUCTION     255 5469.584455 5469.557956
#&gt; LO-REDUCTION     257 5469.574759 5469.557956
#&gt; LO-REDUCTION     259 5469.569831 5469.557956
#&gt; LO-REDUCTION     261 5469.568293 5469.557956
#&gt; HI-REDUCTION     263 5469.567654 5469.557956
#&gt; LO-REDUCTION     265 5469.566450 5469.557956
#&gt; REFLECTION       267 5469.561367 5469.554745
#&gt; LO-REDUCTION     269 5469.561347 5469.554745
#&gt; EXTENSION        271 5469.560593 5469.552683
#&gt; LO-REDUCTION     273 5469.558616 5469.552683
#&gt; REFLECTION       275 5469.558583 5469.552532
#&gt; REFLECTION       277 5469.557956 5469.551269
#&gt; REFLECTION       279 5469.557350 5469.549191
#&gt; REFLECTION       281 5469.554745 5469.547667
#&gt; EXTENSION        283 5469.553039 5469.542831
#&gt; HI-REDUCTION     285 5469.552683 5469.542831
#&gt; LO-REDUCTION     287 5469.552532 5469.542831
#&gt; EXTENSION        289 5469.551269 5469.537936
#&gt; EXTENSION        291 5469.549191 5469.532347
#&gt; LO-REDUCTION     293 5469.548889 5469.532347
#&gt; EXTENSION        295 5469.547667 5469.525308
#&gt; EXTENSION        297 5469.545875 5469.520753
#&gt; LO-REDUCTION     299 5469.542831 5469.520753
#&gt; EXTENSION        301 5469.537936 5469.497027
#&gt; LO-REDUCTION     303 5469.535645 5469.497027
#&gt; EXTENSION        305 5469.532347 5469.479406
#&gt; LO-REDUCTION     307 5469.525308 5469.479406
#&gt; LO-REDUCTION     309 5469.521750 5469.479406
#&gt; EXTENSION        311 5469.520753 5469.442617
#&gt; LO-REDUCTION     313 5469.503901 5469.442617
#&gt; LO-REDUCTION     315 5469.497027 5469.442617
#&gt; LO-REDUCTION     317 5469.495988 5469.442617
#&gt; EXTENSION        319 5469.482802 5469.379141
#&gt; LO-REDUCTION     321 5469.479406 5469.379141
#&gt; LO-REDUCTION     323 5469.452139 5469.379141
#&gt; LO-REDUCTION     325 5469.450123 5469.379141
#&gt; EXTENSION        327 5469.449250 5469.336124
#&gt; EXTENSION        329 5469.442617 5469.279315
#&gt; LO-REDUCTION     331 5469.406456 5469.279315
#&gt; LO-REDUCTION     333 5469.389365 5469.279315
#&gt; EXTENSION        335 5469.388486 5469.240853
#&gt; EXTENSION        337 5469.379141 5469.173149
#&gt; EXTENSION        339 5469.336124 5469.107247
#&gt; LO-REDUCTION     341 5469.290656 5469.107247
#&gt; LO-REDUCTION     343 5469.281885 5469.107247
#&gt; LO-REDUCTION     345 5469.279315 5469.107247
#&gt; LO-REDUCTION     347 5469.240853 5469.107247
#&gt; EXTENSION        349 5469.173149 5469.010506
#&gt; LO-REDUCTION     351 5469.128455 5469.010506
#&gt; LO-REDUCTION     353 5469.126319 5469.010506
#&gt; LO-REDUCTION     355 5469.120080 5469.010506
#&gt; LO-REDUCTION     357 5469.114882 5469.010506
#&gt; LO-REDUCTION     359 5469.107247 5469.010506
#&gt; LO-REDUCTION     361 5469.066328 5469.010506
#&gt; REFLECTION       363 5469.037581 5468.998381
#&gt; REFLECTION       365 5469.035503 5468.996497
#&gt; LO-REDUCTION     367 5469.032091 5468.996497
#&gt; EXTENSION        369 5469.017024 5468.982791
#&gt; HI-REDUCTION     371 5469.012564 5468.982791
#&gt; EXTENSION        373 5469.010506 5468.958532
#&gt; LO-REDUCTION     375 5469.007211 5468.958532
#&gt; EXTENSION        377 5468.998953 5468.941575
#&gt; LO-REDUCTION     379 5468.998381 5468.941575
#&gt; LO-REDUCTION     381 5468.996497 5468.941575
#&gt; LO-REDUCTION     383 5468.982791 5468.941575
#&gt; EXTENSION        385 5468.981413 5468.929189
#&gt; EXTENSION        387 5468.960636 5468.895257
#&gt; LO-REDUCTION     389 5468.958532 5468.895257
#&gt; LO-REDUCTION     391 5468.956771 5468.895257
#&gt; EXTENSION        393 5468.952274 5468.852109
#&gt; LO-REDUCTION     395 5468.941575 5468.852109
#&gt; EXTENSION        397 5468.929189 5468.807038
#&gt; LO-REDUCTION     399 5468.907905 5468.807038
#&gt; LO-REDUCTION     401 5468.899973 5468.807038
#&gt; EXTENSION        403 5468.895257 5468.726236
#&gt; LO-REDUCTION     405 5468.869146 5468.726236
#&gt; EXTENSION        407 5468.852109 5468.659730
#&gt; LO-REDUCTION     409 5468.819797 5468.659730
#&gt; LO-REDUCTION     411 5468.814820 5468.659730
#&gt; LO-REDUCTION     413 5468.807038 5468.659730
#&gt; LO-REDUCTION     415 5468.783467 5468.659730
#&gt; EXTENSION        417 5468.726236 5468.588120
#&gt; LO-REDUCTION     419 5468.725427 5468.588120
#&gt; EXTENSION        421 5468.715863 5468.561333
#&gt; EXTENSION        423 5468.682895 5468.494516
#&gt; LO-REDUCTION     425 5468.662857 5468.494516
#&gt; LO-REDUCTION     427 5468.659730 5468.494516
#&gt; LO-REDUCTION     429 5468.644090 5468.494516
#&gt; REFLECTION       431 5468.588120 5468.487908
#&gt; REFLECTION       433 5468.561333 5468.483079
#&gt; REFLECTION       435 5468.553893 5468.481414
#&gt; LO-REDUCTION     437 5468.548663 5468.481414
#&gt; LO-REDUCTION     439 5468.546127 5468.476856
#&gt; EXTENSION        441 5468.494516 5468.422176
#&gt; LO-REDUCTION     443 5468.487908 5468.422176
#&gt; HI-REDUCTION     445 5468.483079 5468.422176
#&gt; LO-REDUCTION     447 5468.481635 5468.422176
#&gt; LO-REDUCTION     449 5468.481414 5468.422176
#&gt; EXTENSION        451 5468.476856 5468.405444
#&gt; EXTENSION        453 5468.464499 5468.393520
#&gt; LO-REDUCTION     455 5468.458981 5468.393520
#&gt; LO-REDUCTION     457 5468.440655 5468.393520
#&gt; LO-REDUCTION     459 5468.428268 5468.393520
#&gt; LO-REDUCTION     461 5468.422176 5468.393520
#&gt; LO-REDUCTION     463 5468.411817 5468.393520
#&gt; EXTENSION        465 5468.405444 5468.376048
#&gt; HI-REDUCTION     467 5468.403498 5468.376048
#&gt; LO-REDUCTION     469 5468.400047 5468.376048
#&gt; EXTENSION        471 5468.396942 5468.365320
#&gt; LO-REDUCTION     473 5468.395100 5468.365320
#&gt; LO-REDUCTION     475 5468.393520 5468.365320
#&gt; LO-REDUCTION     477 5468.392885 5468.365320
#&gt; REFLECTION       479 5468.388278 5468.359790
#&gt; EXTENSION        481 5468.376048 5468.321679
#&gt; LO-REDUCTION     483 5468.373972 5468.321679
#&gt; LO-REDUCTION     485 5468.371636 5468.321679
#&gt; EXTENSION        487 5468.367276 5468.299597
#&gt; LO-REDUCTION     489 5468.365320 5468.299597
#&gt; LO-REDUCTION     491 5468.359790 5468.299597
#&gt; EXTENSION        493 5468.340574 5468.260825
#&gt; LO-REDUCTION     495 5468.334249 5468.260825
#&gt; EXTENSION        497 5468.321679 5468.222532
#&gt; LO-REDUCTION     499 5468.312710 5468.222532
#&gt; EXTENSION        501 5468.300642 5468.200418
#&gt; LO-REDUCTION     503 5468.299597 5468.200418
#&gt; EXTENSION        505 5468.262120 5468.143175
#&gt; LO-REDUCTION     507 5468.260825 5468.143175
#&gt; LO-REDUCTION     509 5468.230098 5468.143175
#&gt; LO-REDUCTION     511 5468.222532 5468.143175
#&gt; LO-REDUCTION     513 5468.204610 5468.143175
#&gt; LO-REDUCTION     515 5468.200418 5468.143175
#&gt; LO-REDUCTION     517 5468.163181 5468.143175
#&gt; LO-REDUCTION     519 5468.160772 5468.143175
#&gt; LO-REDUCTION     521 5468.159795 5468.141855
#&gt; LO-REDUCTION     523 5468.151430 5468.141855
#&gt; REFLECTION       525 5468.151232 5468.139662
#&gt; REFLECTION       527 5468.146016 5468.133984
#&gt; LO-REDUCTION     529 5468.145071 5468.133984
#&gt; LO-REDUCTION     531 5468.143175 5468.133984
#&gt; LO-REDUCTION     533 5468.142914 5468.133984
#&gt; LO-REDUCTION     535 5468.141855 5468.133956
#&gt; LO-REDUCTION     537 5468.139662 5468.133811
#&gt; REFLECTION       539 5468.136893 5468.133621
#&gt; REFLECTION       541 5468.136295 5468.133366
#&gt; REFLECTION       543 5468.136005 5468.133171
#&gt; LO-REDUCTION     545 5468.133984 5468.132063
#&gt; REFLECTION       547 5468.133956 5468.131099
#&gt; LO-REDUCTION     549 5468.133811 5468.131099
#&gt; HI-REDUCTION     551 5468.133621 5468.131099
#&gt; EXTENSION        553 5468.133366 5468.129989
#&gt; REFLECTION       555 5468.133171 5468.129913
#&gt; LO-REDUCTION     557 5468.132063 5468.129913
#&gt; LO-REDUCTION     559 5468.131380 5468.129708
#&gt; EXTENSION        561 5468.131308 5468.127279
#&gt; LO-REDUCTION     563 5468.131099 5468.127279
#&gt; LO-REDUCTION     565 5468.130279 5468.127279
#&gt; LO-REDUCTION     567 5468.129989 5468.127279
#&gt; LO-REDUCTION     569 5468.129913 5468.127279
#&gt; LO-REDUCTION     571 5468.129708 5468.127279
#&gt; EXTENSION        573 5468.129364 5468.125951
#&gt; REFLECTION       575 5468.127856 5468.125372
#&gt; LO-REDUCTION     577 5468.127682 5468.125372
#&gt; LO-REDUCTION     579 5468.127596 5468.125372
#&gt; HI-REDUCTION     581 5468.127466 5468.125372
#&gt; REFLECTION       583 5468.127279 5468.124738
#&gt; REFLECTION       585 5468.126163 5468.124512
#&gt; LO-REDUCTION     587 5468.125951 5468.124512
#&gt; LO-REDUCTION     589 5468.125793 5468.124512
#&gt; LO-REDUCTION     591 5468.125567 5468.124512
#&gt; EXTENSION        593 5468.125372 5468.123993
#&gt; LO-REDUCTION     595 5468.125087 5468.123993
#&gt; EXTENSION        597 5468.124753 5468.123780
#&gt; EXTENSION        599 5468.124738 5468.123377
#&gt; LO-REDUCTION     601 5468.124736 5468.123377
#&gt; LO-REDUCTION     603 5468.124512 5468.123377
#&gt; EXTENSION        605 5468.124414 5468.122921
#&gt; EXTENSION        607 5468.123993 5468.121824
#&gt; LO-REDUCTION     609 5468.123780 5468.121824
#&gt; LO-REDUCTION     611 5468.123731 5468.121824
#&gt; LO-REDUCTION     613 5468.123392 5468.121824
#&gt; LO-REDUCTION     615 5468.123377 5468.121824
#&gt; LO-REDUCTION     617 5468.122921 5468.121824
#&gt; EXTENSION        619 5468.122785 5468.121109
#&gt; LO-REDUCTION     621 5468.122649 5468.121109
#&gt; LO-REDUCTION     623 5468.122326 5468.121109
#&gt; EXTENSION        625 5468.122247 5468.120000
#&gt; LO-REDUCTION     627 5468.121864 5468.120000
#&gt; LO-REDUCTION     629 5468.121824 5468.120000
#&gt; EXTENSION        631 5468.121285 5468.118764
#&gt; LO-REDUCTION     633 5468.121221 5468.118764
#&gt; LO-REDUCTION     635 5468.121109 5468.118764
#&gt; EXTENSION        637 5468.120295 5468.116419
#&gt; LO-REDUCTION     639 5468.120210 5468.116419
#&gt; LO-REDUCTION     641 5468.120000 5468.116419
#&gt; LO-REDUCTION     643 5468.119512 5468.116419
#&gt; EXTENSION        645 5468.119146 5468.114256
#&gt; LO-REDUCTION     647 5468.118764 5468.114256
#&gt; EXTENSION        649 5468.117974 5468.111823
#&gt; LO-REDUCTION     651 5468.117341 5468.111823
#&gt; LO-REDUCTION     653 5468.116721 5468.111823
#&gt; EXTENSION        655 5468.116419 5468.108851
#&gt; LO-REDUCTION     657 5468.115740 5468.108851
#&gt; EXTENSION        659 5468.114256 5468.103661
#&gt; LO-REDUCTION     661 5468.112784 5468.103661
#&gt; LO-REDUCTION     663 5468.111963 5468.103661
#&gt; LO-REDUCTION     665 5468.111823 5468.103661
#&gt; EXTENSION        667 5468.110290 5468.102029
#&gt; EXTENSION        669 5468.108851 5468.094424
#&gt; LO-REDUCTION     671 5468.105675 5468.094424
#&gt; LO-REDUCTION     673 5468.105039 5468.094424
#&gt; LO-REDUCTION     675 5468.104751 5468.094424
#&gt; EXTENSION        677 5468.103661 5468.091440
#&gt; LO-REDUCTION     679 5468.102029 5468.091440
#&gt; REFLECTION       681 5468.098007 5468.090343
#&gt; EXTENSION        683 5468.096951 5468.086131
#&gt; LO-REDUCTION     685 5468.095150 5468.086131
#&gt; EXTENSION        687 5468.094805 5468.085050
#&gt; LO-REDUCTION     689 5468.094424 5468.085050
#&gt; LO-REDUCTION     691 5468.091440 5468.085050
#&gt; REFLECTION       693 5468.090343 5468.083661
#&gt; LO-REDUCTION     695 5468.088600 5468.083556
#&gt; LO-REDUCTION     697 5468.086576 5468.083556
#&gt; REFLECTION       699 5468.086131 5468.083530
#&gt; HI-REDUCTION     701 5468.085185 5468.083530
#&gt; REFLECTION       703 5468.085050 5468.082930
#&gt; REFLECTION       705 5468.084026 5468.082609
#&gt; LO-REDUCTION     707 5468.083850 5468.082609
#&gt; EXTENSION        709 5468.083661 5468.080548
#&gt; LO-REDUCTION     711 5468.083556 5468.080548
#&gt; HI-REDUCTION     713 5468.083530 5468.080548
#&gt; LO-REDUCTION     715 5468.082930 5468.080548
#&gt; LO-REDUCTION     717 5468.082656 5468.080548
#&gt; LO-REDUCTION     719 5468.082609 5468.080548
#&gt; EXTENSION        721 5468.082233 5468.079187
#&gt; EXTENSION        723 5468.081423 5468.077390
#&gt; LO-REDUCTION     725 5468.081383 5468.077390
#&gt; LO-REDUCTION     727 5468.080946 5468.077390
#&gt; LO-REDUCTION     729 5468.080939 5468.077390
#&gt; LO-REDUCTION     731 5468.080548 5468.077390
#&gt; EXTENSION        733 5468.079187 5468.073219
#&gt; LO-REDUCTION     735 5468.078852 5468.073219
#&gt; LO-REDUCTION     737 5468.078321 5468.073219
#&gt; LO-REDUCTION     739 5468.077835 5468.073219
#&gt; EXTENSION        741 5468.077441 5468.071482
#&gt; LO-REDUCTION     743 5468.077390 5468.071482
#&gt; EXTENSION        745 5468.075959 5468.068766
#&gt; LO-REDUCTION     747 5468.075855 5468.068766
#&gt; EXTENSION        749 5468.073740 5468.066718
#&gt; LO-REDUCTION     751 5468.073219 5468.066718
#&gt; LO-REDUCTION     753 5468.072891 5468.066718
#&gt; REFLECTION       755 5468.071482 5468.065731
#&gt; REFLECTION       757 5468.069120 5468.064943
#&gt; LO-REDUCTION     759 5468.068766 5468.064943
#&gt; LO-REDUCTION     761 5468.067269 5468.064943
#&gt; LO-REDUCTION     763 5468.067155 5468.064943
#&gt; LO-REDUCTION     765 5468.066718 5468.064943
#&gt; LO-REDUCTION     767 5468.066566 5468.064943
#&gt; EXTENSION        769 5468.065763 5468.062991
#&gt; LO-REDUCTION     771 5468.065760 5468.062991
#&gt; LO-REDUCTION     773 5468.065731 5468.062991
#&gt; LO-REDUCTION     775 5468.065636 5468.062991
#&gt; LO-REDUCTION     777 5468.065531 5468.062991
#&gt; EXTENSION        779 5468.064943 5468.062208
#&gt; EXTENSION        781 5468.064655 5468.060690
#&gt; LO-REDUCTION     783 5468.064156 5468.060690
#&gt; EXTENSION        785 5468.064019 5468.059899
#&gt; EXTENSION        787 5468.063257 5468.059649
#&gt; EXTENSION        789 5468.062991 5468.058730
#&gt; LO-REDUCTION     791 5468.062208 5468.058730
#&gt; EXTENSION        793 5468.060992 5468.053710
#&gt; LO-REDUCTION     795 5468.060690 5468.053710
#&gt; LO-REDUCTION     797 5468.059899 5468.053710
#&gt; LO-REDUCTION     799 5468.059649 5468.053710
#&gt; LO-REDUCTION     801 5468.058805 5468.053710
#&gt; LO-REDUCTION     803 5468.058730 5468.053710
#&gt; LO-REDUCTION     805 5468.058130 5468.053710
#&gt; LO-REDUCTION     807 5468.057866 5468.053710
#&gt; EXTENSION        809 5468.056846 5468.052156
#&gt; LO-REDUCTION     811 5468.056783 5468.052156
#&gt; EXTENSION        813 5468.055863 5468.049609
#&gt; EXTENSION        815 5468.054770 5468.046538
#&gt; LO-REDUCTION     817 5468.053881 5468.046538
#&gt; EXTENSION        819 5468.053710 5468.043063
#&gt; LO-REDUCTION     821 5468.052164 5468.043063
#&gt; LO-REDUCTION     823 5468.052156 5468.043063
#&gt; LO-REDUCTION     825 5468.049609 5468.043063
#&gt; EXTENSION        827 5468.047627 5468.040823
#&gt; LO-REDUCTION     829 5468.046789 5468.040823
#&gt; REFLECTION       831 5468.046538 5468.040586
#&gt; LO-REDUCTION     833 5468.045404 5468.040586
#&gt; REFLECTION       835 5468.044198 5468.040408
#&gt; EXTENSION        837 5468.043063 5468.036663
#&gt; LO-REDUCTION     839 5468.042212 5468.036663
#&gt; LO-REDUCTION     841 5468.041344 5468.036663
#&gt; LO-REDUCTION     843 5468.040823 5468.036663
#&gt; LO-REDUCTION     845 5468.040586 5468.036663
#&gt; LO-REDUCTION     847 5468.040408 5468.036663
#&gt; LO-REDUCTION     849 5468.040068 5468.036663
#&gt; EXTENSION        851 5468.038968 5468.035079
#&gt; EXTENSION        853 5468.038617 5468.033262
#&gt; LO-REDUCTION     855 5468.038137 5468.033262
#&gt; EXTENSION        857 5468.037732 5468.032302
#&gt; LO-REDUCTION     859 5468.037494 5468.032302
#&gt; LO-REDUCTION     861 5468.036663 5468.032302
#&gt; EXTENSION        863 5468.035079 5468.031221
#&gt; LO-REDUCTION     865 5468.034710 5468.031221
#&gt; EXTENSION        867 5468.034670 5468.029543
#&gt; REFLECTION       869 5468.033262 5468.029315
#&gt; LO-REDUCTION     871 5468.032521 5468.029315
#&gt; LO-REDUCTION     873 5468.032302 5468.029315
#&gt; LO-REDUCTION     875 5468.032214 5468.029315
#&gt; LO-REDUCTION     877 5468.031221 5468.029315
#&gt; LO-REDUCTION     879 5468.031003 5468.029315
#&gt; EXTENSION        881 5468.030235 5468.028343
#&gt; EXTENSION        883 5468.029850 5468.028212
#&gt; EXTENSION        885 5468.029543 5468.027022
#&gt; EXTENSION        887 5468.029502 5468.026309
#&gt; LO-REDUCTION     889 5468.029394 5468.026309
#&gt; EXTENSION        891 5468.029315 5468.024796
#&gt; LO-REDUCTION     893 5468.028343 5468.024796
#&gt; LO-REDUCTION     895 5468.028212 5468.024796
#&gt; REFLECTION       897 5468.027022 5468.024020
#&gt; EXTENSION        899 5468.026589 5468.022115
#&gt; LO-REDUCTION     901 5468.026508 5468.022115
#&gt; LO-REDUCTION     903 5468.026309 5468.022115
#&gt; LO-REDUCTION     905 5468.024861 5468.022115
#&gt; LO-REDUCTION     907 5468.024796 5468.022115
#&gt; LO-REDUCTION     909 5468.024020 5468.022115
#&gt; REFLECTION       911 5468.023195 5468.022054
#&gt; EXTENSION        913 5468.023024 5468.020873
#&gt; LO-REDUCTION     915 5468.022497 5468.020873
#&gt; LO-REDUCTION     917 5468.022370 5468.020873
#&gt; LO-REDUCTION     919 5468.022144 5468.020873
#&gt; LO-REDUCTION     921 5468.022115 5468.020873
#&gt; LO-REDUCTION     923 5468.022054 5468.020873
#&gt; EXTENSION        925 5468.021653 5468.020647
#&gt; EXTENSION        927 5468.021512 5468.020159
#&gt; LO-REDUCTION     929 5468.021486 5468.020159
#&gt; EXTENSION        931 5468.021415 5468.019212
#&gt; LO-REDUCTION     933 5468.021408 5468.019212
#&gt; LO-REDUCTION     935 5468.020909 5468.019212
#&gt; EXTENSION        937 5468.020873 5468.018432
#&gt; LO-REDUCTION     939 5468.020647 5468.018432
#&gt; EXTENSION        941 5468.020159 5468.017518
#&gt; LO-REDUCTION     943 5468.019942 5468.017518
#&gt; EXTENSION        945 5468.019596 5468.015441
#&gt; LO-REDUCTION     947 5468.019212 5468.015441
#&gt; LO-REDUCTION     949 5468.018470 5468.015441
#&gt; EXTENSION        951 5468.018432 5468.012719
#&gt; LO-REDUCTION     953 5468.017660 5468.012719
#&gt; EXTENSION        955 5468.017518 5468.010974
#&gt; EXTENSION        957 5468.015447 5468.009993
#&gt; LO-REDUCTION     959 5468.015443 5468.009993
#&gt; EXTENSION        961 5468.015441 5468.006609
#&gt; EXTENSION        963 5468.013037 5468.005703
#&gt; REFLECTION       965 5468.012719 5468.005482
#&gt; REFLECTION       967 5468.010974 5468.004813
#&gt; LO-REDUCTION     969 5468.010031 5468.004756
#&gt; REFLECTION       971 5468.009993 5468.003720
#&gt; HI-REDUCTION     973 5468.006609 5468.003720
#&gt; LO-REDUCTION     975 5468.005738 5468.003720
#&gt; HI-REDUCTION     977 5468.005703 5468.003720
#&gt; HI-REDUCTION     979 5468.005482 5468.003720
#&gt; EXTENSION        981 5468.004813 5468.003342
#&gt; EXTENSION        983 5468.004756 5468.002643
#&gt; LO-REDUCTION     985 5468.004545 5468.002643
#&gt; LO-REDUCTION     987 5468.004461 5468.002643
#&gt; LO-REDUCTION     989 5468.004326 5468.002643
#&gt; EXTENSION        991 5468.003720 5468.001525
#&gt; LO-REDUCTION     993 5468.003342 5468.001525
#&gt; LO-REDUCTION     995 5468.003270 5468.001525
#&gt; EXTENSION        997 5468.003013 5468.000562
#&gt; LO-REDUCTION     999 5468.002948 5468.000562
#&gt; EXTENSION       1001 5468.002643 5468.000023
#&gt; LO-REDUCTION    1003 5468.002301 5468.000023
#&gt; LO-REDUCTION    1005 5468.002167 5468.000023
#&gt; REFLECTION      1007 5468.001525 5467.999685
#&gt; LO-REDUCTION    1009 5468.001314 5467.999685
#&gt; EXTENSION       1011 5468.000609 5467.998452
#&gt; LO-REDUCTION    1013 5468.000562 5467.998452
#&gt; LO-REDUCTION    1015 5468.000173 5467.998452
#&gt; LO-REDUCTION    1017 5468.000133 5467.998452
#&gt; LO-REDUCTION    1019 5468.000023 5467.998452
#&gt; LO-REDUCTION    1021 5467.999685 5467.998452
#&gt; LO-REDUCTION    1023 5467.999586 5467.998452
#&gt; EXTENSION       1025 5467.999402 5467.997154
#&gt; LO-REDUCTION    1027 5467.998943 5467.997154
#&gt; LO-REDUCTION    1029 5467.998911 5467.997154
#&gt; LO-REDUCTION    1031 5467.998824 5467.997154
#&gt; LO-REDUCTION    1033 5467.998678 5467.997154
#&gt; REFLECTION      1035 5467.998452 5467.997136
#&gt; EXTENSION       1037 5467.998147 5467.995987
#&gt; EXTENSION       1039 5467.997908 5467.995259
#&gt; EXTENSION       1041 5467.997300 5467.994291
#&gt; LO-REDUCTION    1043 5467.997251 5467.994291
#&gt; LO-REDUCTION    1045 5467.997154 5467.994291
#&gt; EXTENSION       1047 5467.997136 5467.993060
#&gt; EXTENSION       1049 5467.995987 5467.992110
#&gt; LO-REDUCTION    1051 5467.995259 5467.992110
#&gt; REFLECTION      1053 5467.995037 5467.991833
#&gt; LO-REDUCTION    1055 5467.994876 5467.991833
#&gt; EXTENSION       1057 5467.994291 5467.990117
#&gt; LO-REDUCTION    1059 5467.993060 5467.990117
#&gt; LO-REDUCTION    1061 5467.992361 5467.990117
#&gt; HI-REDUCTION    1063 5467.992235 5467.990117
#&gt; LO-REDUCTION    1065 5467.992110 5467.990117
#&gt; LO-REDUCTION    1067 5467.991901 5467.990117
#&gt; EXTENSION       1069 5467.991833 5467.989516
#&gt; LO-REDUCTION    1071 5467.991411 5467.989516
#&gt; LO-REDUCTION    1073 5467.990810 5467.989516
#&gt; EXTENSION       1075 5467.990351 5467.987892
#&gt; LO-REDUCTION    1077 5467.990238 5467.987892
#&gt; LO-REDUCTION    1079 5467.990117 5467.987892
#&gt; LO-REDUCTION    1081 5467.989870 5467.987892
#&gt; LO-REDUCTION    1083 5467.989822 5467.987892
#&gt; LO-REDUCTION    1085 5467.989516 5467.987892
#&gt; LO-REDUCTION    1087 5467.989122 5467.987892
#&gt; EXTENSION       1089 5467.988982 5467.987094
#&gt; LO-REDUCTION    1091 5467.988780 5467.987094
#&gt; EXTENSION       1093 5467.988413 5467.986123
#&gt; LO-REDUCTION    1095 5467.988288 5467.986123
#&gt; LO-REDUCTION    1097 5467.988113 5467.986123
#&gt; REFLECTION      1099 5467.987892 5467.986107
#&gt; REFLECTION      1101 5467.987220 5467.985766
#&gt; LO-REDUCTION    1103 5467.987094 5467.985766
#&gt; EXTENSION       1105 5467.986734 5467.985486
#&gt; REFLECTION      1107 5467.986470 5467.985328
#&gt; LO-REDUCTION    1109 5467.986123 5467.985328
#&gt; LO-REDUCTION    1111 5467.986107 5467.985328
#&gt; LO-REDUCTION    1113 5467.986020 5467.985311
#&gt; REFLECTION      1115 5467.985766 5467.985287
#&gt; LO-REDUCTION    1117 5467.985563 5467.985287
#&gt; REFLECTION      1119 5467.985486 5467.985106
#&gt; LO-REDUCTION    1121 5467.985367 5467.985106
#&gt; LO-REDUCTION    1123 5467.985342 5467.985106
#&gt; REFLECTION      1125 5467.985328 5467.985050
#&gt; LO-REDUCTION    1127 5467.985311 5467.985050
#&gt; LO-REDUCTION    1129 5467.985287 5467.985050
#&gt; REFLECTION      1131 5467.985262 5467.984964
#&gt; LO-REDUCTION    1133 5467.985106 5467.984964
#&gt; REFLECTION      1135 5467.985106 5467.984929
#&gt; LO-REDUCTION    1137 5467.985099 5467.984929
#&gt; EXTENSION       1139 5467.985098 5467.984827
#&gt; LO-REDUCTION    1141 5467.985050 5467.984827
#&gt; LO-REDUCTION    1143 5467.984972 5467.984827
#&gt; LO-REDUCTION    1145 5467.984970 5467.984827
#&gt; LO-REDUCTION    1147 5467.984964 5467.984827
#&gt; REFLECTION      1149 5467.984929 5467.984821
#&gt; REFLECTION      1151 5467.984888 5467.984794
#&gt; EXTENSION       1153 5467.984875 5467.984683
#&gt; LO-REDUCTION    1155 5467.984846 5467.984683
#&gt; LO-REDUCTION    1157 5467.984845 5467.984683
#&gt; HI-REDUCTION    1159 5467.984827 5467.984683
#&gt; EXTENSION       1161 5467.984821 5467.984628
#&gt; EXTENSION       1163 5467.984794 5467.984583
#&gt; LO-REDUCTION    1165 5467.984761 5467.984583
#&gt; EXTENSION       1167 5467.984727 5467.984510
#&gt; LO-REDUCTION    1169 5467.984699 5467.984510
#&gt; LO-REDUCTION    1171 5467.984683 5467.984510
#&gt; REFLECTION      1173 5467.984629 5467.984494
#&gt; REFLECTION      1175 5467.984628 5467.984485
#&gt; LO-REDUCTION    1177 5467.984585 5467.984485
#&gt; REFLECTION      1179 5467.984583 5467.984458
#&gt; LO-REDUCTION    1181 5467.984549 5467.984458
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1183 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0441383   1.4892360  -2.9971513  -0.9535512  -0.6292411   0.2886674 
#&gt; 
#&gt; $value
#&gt; [1] 5467.984
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1183 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.98 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==========================================                            |  60%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6056.085437
#&gt;   Scaled convergence tolerance is 9.02427e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11693.090219 5688.950062
#&gt; LO-REDUCTION       9 7788.660913 5688.950062
#&gt; LO-REDUCTION      11 7447.114547 5688.950062
#&gt; LO-REDUCTION      13 6856.234290 5688.950062
#&gt; LO-REDUCTION      15 6574.155961 5688.950062
#&gt; LO-REDUCTION      17 6332.374141 5688.950062
#&gt; REFLECTION        19 6260.072725 5678.585920
#&gt; REFLECTION        21 6056.085437 5496.654076
#&gt; LO-REDUCTION      23 5866.562684 5496.654076
#&gt; LO-REDUCTION      25 5865.662939 5496.654076
#&gt; LO-REDUCTION      27 5741.778348 5496.654076
#&gt; LO-REDUCTION      29 5688.950062 5496.654076
#&gt; LO-REDUCTION      31 5678.585920 5496.654076
#&gt; LO-REDUCTION      33 5571.474650 5496.654076
#&gt; LO-REDUCTION      35 5567.124450 5496.654076
#&gt; LO-REDUCTION      37 5558.541857 5496.654076
#&gt; LO-REDUCTION      39 5543.089749 5496.654076
#&gt; HI-REDUCTION      41 5512.663806 5496.654076
#&gt; LO-REDUCTION      43 5506.568086 5496.654076
#&gt; HI-REDUCTION      45 5506.083236 5496.654076
#&gt; HI-REDUCTION      47 5505.331311 5496.654076
#&gt; REFLECTION        49 5502.334217 5496.341813
#&gt; REFLECTION        51 5500.617124 5490.855284
#&gt; HI-REDUCTION      53 5498.345399 5490.855284
#&gt; EXTENSION         55 5498.027702 5488.103232
#&gt; LO-REDUCTION      57 5497.105969 5487.956304
#&gt; LO-REDUCTION      59 5496.654076 5487.956304
#&gt; LO-REDUCTION      61 5496.341813 5487.956304
#&gt; LO-REDUCTION      63 5493.800791 5487.956304
#&gt; REFLECTION        65 5490.855284 5486.404377
#&gt; LO-REDUCTION      67 5489.799900 5486.081070
#&gt; LO-REDUCTION      69 5488.968496 5485.863722
#&gt; HI-REDUCTION      71 5488.194913 5485.863722
#&gt; LO-REDUCTION      73 5488.103232 5485.863722
#&gt; LO-REDUCTION      75 5487.956304 5485.863722
#&gt; REFLECTION        77 5486.543420 5485.366205
#&gt; LO-REDUCTION      79 5486.404377 5485.366205
#&gt; HI-REDUCTION      81 5486.297173 5485.366205
#&gt; LO-REDUCTION      83 5486.135320 5485.273052
#&gt; LO-REDUCTION      85 5486.081070 5485.230240
#&gt; HI-REDUCTION      87 5485.863722 5485.230240
#&gt; HI-REDUCTION      89 5485.562078 5485.230240
#&gt; REFLECTION        91 5485.524239 5484.917870
#&gt; REFLECTION        93 5485.366205 5484.910965
#&gt; HI-REDUCTION      95 5485.347290 5484.910965
#&gt; LO-REDUCTION      97 5485.326674 5484.910965
#&gt; REFLECTION        99 5485.273052 5484.806278
#&gt; HI-REDUCTION     101 5485.230240 5484.806278
#&gt; REFLECTION       103 5485.027946 5484.681552
#&gt; REFLECTION       105 5484.951973 5484.660166
#&gt; LO-REDUCTION     107 5484.923877 5484.660166
#&gt; LO-REDUCTION     109 5484.917870 5484.660166
#&gt; LO-REDUCTION     111 5484.910965 5484.660166
#&gt; EXTENSION        113 5484.806278 5484.346518
#&gt; LO-REDUCTION     115 5484.719266 5484.346518
#&gt; LO-REDUCTION     117 5484.681552 5484.346518
#&gt; LO-REDUCTION     119 5484.677734 5484.346518
#&gt; LO-REDUCTION     121 5484.660829 5484.346518
#&gt; REFLECTION       123 5484.660166 5484.345915
#&gt; EXTENSION        125 5484.570809 5484.070331
#&gt; LO-REDUCTION     127 5484.438723 5484.070331
#&gt; LO-REDUCTION     129 5484.418134 5484.070331
#&gt; LO-REDUCTION     131 5484.382799 5484.070331
#&gt; LO-REDUCTION     133 5484.346518 5484.070331
#&gt; LO-REDUCTION     135 5484.345915 5484.070331
#&gt; LO-REDUCTION     137 5484.231709 5484.070331
#&gt; EXTENSION        139 5484.213584 5483.991202
#&gt; EXTENSION        141 5484.202963 5483.937937
#&gt; EXTENSION        143 5484.168706 5483.877146
#&gt; EXTENSION        145 5484.125963 5483.782153
#&gt; EXTENSION        147 5484.087489 5483.557033
#&gt; LO-REDUCTION     149 5484.070331 5483.557033
#&gt; LO-REDUCTION     151 5483.991202 5483.557033
#&gt; LO-REDUCTION     153 5483.937937 5483.557033
#&gt; LO-REDUCTION     155 5483.877146 5483.557033
#&gt; EXTENSION        157 5483.782153 5483.413859
#&gt; LO-REDUCTION     159 5483.771686 5483.413859
#&gt; EXTENSION        161 5483.761178 5483.272993
#&gt; LO-REDUCTION     163 5483.607814 5483.272993
#&gt; REFLECTION       165 5483.603324 5483.268468
#&gt; REFLECTION       167 5483.557033 5483.241107
#&gt; LO-REDUCTION     169 5483.435137 5483.241107
#&gt; LO-REDUCTION     171 5483.413859 5483.241107
#&gt; REFLECTION       173 5483.320828 5483.194961
#&gt; LO-REDUCTION     175 5483.272993 5483.194961
#&gt; HI-REDUCTION     177 5483.268468 5483.194961
#&gt; HI-REDUCTION     179 5483.244880 5483.194961
#&gt; LO-REDUCTION     181 5483.241682 5483.194961
#&gt; LO-REDUCTION     183 5483.241107 5483.194961
#&gt; REFLECTION       185 5483.223871 5483.180567
#&gt; LO-REDUCTION     187 5483.222531 5483.180567
#&gt; HI-REDUCTION     189 5483.216737 5483.180567
#&gt; EXTENSION        191 5483.206671 5483.147515
#&gt; LO-REDUCTION     193 5483.204315 5483.147515
#&gt; LO-REDUCTION     195 5483.196347 5483.147515
#&gt; LO-REDUCTION     197 5483.194961 5483.147515
#&gt; REFLECTION       199 5483.186769 5483.146370
#&gt; REFLECTION       201 5483.180567 5483.140534
#&gt; LO-REDUCTION     203 5483.166146 5483.140534
#&gt; EXTENSION        205 5483.162079 5483.104145
#&gt; LO-REDUCTION     207 5483.157345 5483.104145
#&gt; LO-REDUCTION     209 5483.147515 5483.104145
#&gt; LO-REDUCTION     211 5483.146370 5483.104145
#&gt; LO-REDUCTION     213 5483.141862 5483.104145
#&gt; LO-REDUCTION     215 5483.140534 5483.104145
#&gt; EXTENSION        217 5483.123544 5483.067946
#&gt; LO-REDUCTION     219 5483.122448 5483.067946
#&gt; LO-REDUCTION     221 5483.113234 5483.067946
#&gt; LO-REDUCTION     223 5483.109080 5483.067946
#&gt; LO-REDUCTION     225 5483.108441 5483.067946
#&gt; EXTENSION        227 5483.104145 5483.011743
#&gt; LO-REDUCTION     229 5483.080288 5483.011743
#&gt; LO-REDUCTION     231 5483.076351 5483.011743
#&gt; LO-REDUCTION     233 5483.074344 5483.011743
#&gt; EXTENSION        235 5483.070672 5482.983325
#&gt; LO-REDUCTION     237 5483.067946 5482.983325
#&gt; EXTENSION        239 5483.039311 5482.924133
#&gt; LO-REDUCTION     241 5483.038821 5482.924133
#&gt; EXTENSION        243 5483.022029 5482.871711
#&gt; LO-REDUCTION     245 5483.011743 5482.871711
#&gt; EXTENSION        247 5482.994302 5482.837950
#&gt; EXTENSION        249 5482.983325 5482.723798
#&gt; LO-REDUCTION     251 5482.943458 5482.723798
#&gt; LO-REDUCTION     253 5482.924133 5482.723798
#&gt; REFLECTION       255 5482.879505 5482.720188
#&gt; EXTENSION        257 5482.871711 5482.656759
#&gt; LO-REDUCTION     259 5482.837950 5482.656759
#&gt; EXTENSION        261 5482.752476 5482.553397
#&gt; LO-REDUCTION     263 5482.729741 5482.553397
#&gt; LO-REDUCTION     265 5482.723798 5482.553397
#&gt; LO-REDUCTION     267 5482.720188 5482.553397
#&gt; LO-REDUCTION     269 5482.662580 5482.553397
#&gt; LO-REDUCTION     271 5482.656759 5482.553397
#&gt; LO-REDUCTION     273 5482.620976 5482.553397
#&gt; REFLECTION       275 5482.615910 5482.546281
#&gt; LO-REDUCTION     277 5482.594863 5482.546281
#&gt; LO-REDUCTION     279 5482.591433 5482.546281
#&gt; EXTENSION        281 5482.583686 5482.501938
#&gt; LO-REDUCTION     283 5482.558372 5482.501938
#&gt; LO-REDUCTION     285 5482.555043 5482.501938
#&gt; LO-REDUCTION     287 5482.554036 5482.501938
#&gt; LO-REDUCTION     289 5482.553397 5482.501938
#&gt; LO-REDUCTION     291 5482.546281 5482.501938
#&gt; LO-REDUCTION     293 5482.545186 5482.501938
#&gt; EXTENSION        295 5482.531324 5482.487572
#&gt; LO-REDUCTION     297 5482.531041 5482.487572
#&gt; EXTENSION        299 5482.517435 5482.480607
#&gt; LO-REDUCTION     301 5482.516188 5482.480607
#&gt; REFLECTION       303 5482.512883 5482.474734
#&gt; LO-REDUCTION     305 5482.501938 5482.474734
#&gt; LO-REDUCTION     307 5482.494728 5482.474734
#&gt; REFLECTION       309 5482.487572 5482.474273
#&gt; HI-REDUCTION     311 5482.487301 5482.474273
#&gt; LO-REDUCTION     313 5482.480607 5482.473482
#&gt; HI-REDUCTION     315 5482.480542 5482.473482
#&gt; REFLECTION       317 5482.477628 5482.470175
#&gt; LO-REDUCTION     319 5482.477489 5482.470175
#&gt; LO-REDUCTION     321 5482.475747 5482.470175
#&gt; LO-REDUCTION     323 5482.474734 5482.470175
#&gt; LO-REDUCTION     325 5482.474273 5482.470175
#&gt; REFLECTION       327 5482.473482 5482.469795
#&gt; LO-REDUCTION     329 5482.473456 5482.469795
#&gt; EXTENSION        331 5482.471945 5482.467401
#&gt; LO-REDUCTION     333 5482.471544 5482.467401
#&gt; LO-REDUCTION     335 5482.471330 5482.467401
#&gt; LO-REDUCTION     337 5482.470175 5482.467401
#&gt; EXTENSION        339 5482.470132 5482.466549
#&gt; LO-REDUCTION     341 5482.469795 5482.466549
#&gt; LO-REDUCTION     343 5482.468960 5482.466549
#&gt; EXTENSION        345 5482.468930 5482.464918
#&gt; EXTENSION        347 5482.467612 5482.462777
#&gt; LO-REDUCTION     349 5482.467401 5482.462777
#&gt; LO-REDUCTION     351 5482.467021 5482.462777
#&gt; LO-REDUCTION     353 5482.466897 5482.462777
#&gt; REFLECTION       355 5482.466549 5482.462273
#&gt; LO-REDUCTION     357 5482.465024 5482.462273
#&gt; EXTENSION        359 5482.464918 5482.460322
#&gt; LO-REDUCTION     361 5482.463698 5482.460322
#&gt; LO-REDUCTION     363 5482.462973 5482.460322
#&gt; LO-REDUCTION     365 5482.462823 5482.460322
#&gt; LO-REDUCTION     367 5482.462777 5482.460322
#&gt; LO-REDUCTION     369 5482.462449 5482.460322
#&gt; REFLECTION       371 5482.462273 5482.460254
#&gt; LO-REDUCTION     373 5482.461373 5482.460254
#&gt; EXTENSION        375 5482.461108 5482.459238
#&gt; LO-REDUCTION     377 5482.461075 5482.459238
#&gt; LO-REDUCTION     379 5482.460859 5482.459238
#&gt; EXTENSION        381 5482.460366 5482.458610
#&gt; EXTENSION        383 5482.460322 5482.457217
#&gt; LO-REDUCTION     385 5482.460254 5482.457217
#&gt; LO-REDUCTION     387 5482.459738 5482.457217
#&gt; EXTENSION        389 5482.459275 5482.456159
#&gt; EXTENSION        391 5482.459238 5482.454059
#&gt; LO-REDUCTION     393 5482.458610 5482.454059
#&gt; LO-REDUCTION     395 5482.458050 5482.454059
#&gt; EXTENSION        397 5482.457416 5482.452676
#&gt; LO-REDUCTION     399 5482.457217 5482.452676
#&gt; EXTENSION        401 5482.456159 5482.451967
#&gt; EXTENSION        403 5482.456111 5482.447701
#&gt; EXTENSION        405 5482.454540 5482.444824
#&gt; LO-REDUCTION     407 5482.454059 5482.444824
#&gt; LO-REDUCTION     409 5482.452711 5482.444824
#&gt; LO-REDUCTION     411 5482.452676 5482.444824
#&gt; REFLECTION       413 5482.451967 5482.443942
#&gt; EXTENSION        415 5482.447701 5482.436663
#&gt; LO-REDUCTION     417 5482.447564 5482.436663
#&gt; LO-REDUCTION     419 5482.447252 5482.436663
#&gt; LO-REDUCTION     421 5482.445387 5482.436663
#&gt; LO-REDUCTION     423 5482.444824 5482.436663
#&gt; LO-REDUCTION     425 5482.443942 5482.436663
#&gt; EXTENSION        427 5482.443382 5482.434549
#&gt; LO-REDUCTION     429 5482.438667 5482.434494
#&gt; LO-REDUCTION     431 5482.438583 5482.434494
#&gt; LO-REDUCTION     433 5482.437458 5482.434362
#&gt; REFLECTION       435 5482.437097 5482.433788
#&gt; LO-REDUCTION     437 5482.436663 5482.433788
#&gt; LO-REDUCTION     439 5482.435282 5482.433788
#&gt; REFLECTION       441 5482.434795 5482.433671
#&gt; REFLECTION       443 5482.434599 5482.433372
#&gt; LO-REDUCTION     445 5482.434549 5482.433372
#&gt; LO-REDUCTION     447 5482.434494 5482.433372
#&gt; LO-REDUCTION     449 5482.434362 5482.433253
#&gt; EXTENSION        451 5482.433788 5482.432606
#&gt; EXTENSION        453 5482.433671 5482.432181
#&gt; LO-REDUCTION     455 5482.433498 5482.432181
#&gt; REFLECTION       457 5482.433402 5482.432062
#&gt; LO-REDUCTION     459 5482.433372 5482.432062
#&gt; EXTENSION        461 5482.433253 5482.431426
#&gt; EXTENSION        463 5482.432606 5482.429378
#&gt; LO-REDUCTION     465 5482.432487 5482.429378
#&gt; LO-REDUCTION     467 5482.432196 5482.429378
#&gt; LO-REDUCTION     469 5482.432181 5482.429378
#&gt; LO-REDUCTION     471 5482.432062 5482.429378
#&gt; LO-REDUCTION     473 5482.431426 5482.429378
#&gt; LO-REDUCTION     475 5482.430999 5482.429378
#&gt; EXTENSION        477 5482.430864 5482.427812
#&gt; LO-REDUCTION     479 5482.430584 5482.427812
#&gt; LO-REDUCTION     481 5482.430528 5482.427812
#&gt; EXTENSION        483 5482.429841 5482.426167
#&gt; LO-REDUCTION     485 5482.429483 5482.426167
#&gt; LO-REDUCTION     487 5482.429378 5482.426167
#&gt; EXTENSION        489 5482.428992 5482.424761
#&gt; EXTENSION        491 5482.428369 5482.424039
#&gt; EXTENSION        493 5482.427812 5482.421189
#&gt; LO-REDUCTION     495 5482.427160 5482.421189
#&gt; LO-REDUCTION     497 5482.426212 5482.421189
#&gt; LO-REDUCTION     499 5482.426167 5482.421189
#&gt; REFLECTION       501 5482.424761 5482.420755
#&gt; REFLECTION       503 5482.424039 5482.419858
#&gt; LO-REDUCTION     505 5482.422964 5482.419858
#&gt; EXTENSION        507 5482.421733 5482.417446
#&gt; LO-REDUCTION     509 5482.421428 5482.417446
#&gt; LO-REDUCTION     511 5482.421189 5482.417446
#&gt; LO-REDUCTION     513 5482.420755 5482.417446
#&gt; EXTENSION        515 5482.420532 5482.416096
#&gt; LO-REDUCTION     517 5482.419858 5482.416096
#&gt; EXTENSION        519 5482.419021 5482.413740
#&gt; LO-REDUCTION     521 5482.418588 5482.413740
#&gt; EXTENSION        523 5482.417524 5482.410604
#&gt; LO-REDUCTION     525 5482.417446 5482.410604
#&gt; LO-REDUCTION     527 5482.416670 5482.410604
#&gt; LO-REDUCTION     529 5482.416096 5482.410604
#&gt; LO-REDUCTION     531 5482.414164 5482.410604
#&gt; LO-REDUCTION     533 5482.413740 5482.410604
#&gt; LO-REDUCTION     535 5482.412993 5482.410604
#&gt; LO-REDUCTION     537 5482.412297 5482.410596
#&gt; REFLECTION       539 5482.411263 5482.410220
#&gt; REFLECTION       541 5482.411209 5482.410059
#&gt; LO-REDUCTION     543 5482.411179 5482.410059
#&gt; REFLECTION       545 5482.410619 5482.409515
#&gt; LO-REDUCTION     547 5482.410604 5482.409515
#&gt; LO-REDUCTION     549 5482.410596 5482.409515
#&gt; REFLECTION       551 5482.410220 5482.409339
#&gt; LO-REDUCTION     553 5482.410085 5482.409339
#&gt; LO-REDUCTION     555 5482.410059 5482.409339
#&gt; LO-REDUCTION     557 5482.409935 5482.409339
#&gt; EXTENSION        559 5482.409836 5482.408871
#&gt; LO-REDUCTION     561 5482.409607 5482.408871
#&gt; EXTENSION        563 5482.409557 5482.408702
#&gt; EXTENSION        565 5482.409515 5482.408201
#&gt; EXTENSION        567 5482.409398 5482.408016
#&gt; EXTENSION        569 5482.409339 5482.406689
#&gt; LO-REDUCTION     571 5482.408890 5482.406689
#&gt; LO-REDUCTION     573 5482.408871 5482.406689
#&gt; LO-REDUCTION     575 5482.408702 5482.406689
#&gt; EXTENSION        577 5482.408201 5482.405588
#&gt; LO-REDUCTION     579 5482.408016 5482.405588
#&gt; EXTENSION        581 5482.407543 5482.404334
#&gt; EXTENSION        583 5482.406969 5482.403454
#&gt; EXTENSION        585 5482.406884 5482.402006
#&gt; LO-REDUCTION     587 5482.406689 5482.402006
#&gt; EXTENSION        589 5482.405694 5482.401379
#&gt; REFLECTION       591 5482.405588 5482.400824
#&gt; LO-REDUCTION     593 5482.404334 5482.400824
#&gt; REFLECTION       595 5482.403454 5482.400472
#&gt; LO-REDUCTION     597 5482.402650 5482.400472
#&gt; LO-REDUCTION     599 5482.402006 5482.400457
#&gt; HI-REDUCTION     601 5482.401379 5482.400457
#&gt; LO-REDUCTION     603 5482.401326 5482.400457
#&gt; REFLECTION       605 5482.400893 5482.400379
#&gt; LO-REDUCTION     607 5482.400824 5482.400323
#&gt; REFLECTION       609 5482.400560 5482.400217
#&gt; LO-REDUCTION     611 5482.400494 5482.400217
#&gt; HI-REDUCTION     613 5482.400472 5482.400217
#&gt; REFLECTION       615 5482.400457 5482.400201
#&gt; LO-REDUCTION     617 5482.400379 5482.400179
#&gt; LO-REDUCTION     619 5482.400323 5482.400146
#&gt; EXTENSION        621 5482.400241 5482.400000
#&gt; LO-REDUCTION     623 5482.400234 5482.400000
#&gt; LO-REDUCTION     625 5482.400217 5482.400000
#&gt; LO-REDUCTION     627 5482.400201 5482.400000
#&gt; LO-REDUCTION     629 5482.400179 5482.400000
#&gt; REFLECTION       631 5482.400146 5482.399977
#&gt; LO-REDUCTION     633 5482.400037 5482.399945
#&gt; LO-REDUCTION     635 5482.400036 5482.399941
#&gt; Exiting from Nelder Mead minimizer
#&gt;     637 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9999494   1.5009039  -3.0005436  -0.9467793  -0.6421919   0.3018336 
#&gt; 
#&gt; $value
#&gt; [1] 5482.4
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      637 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.532 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=================================================                     |  70%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6084.262198
#&gt;   Scaled convergence tolerance is 9.06626e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11626.340618 5715.223383
#&gt; LO-REDUCTION       9 7834.866207 5715.223383
#&gt; LO-REDUCTION      11 7456.516512 5715.223383
#&gt; LO-REDUCTION      13 6822.870658 5715.223383
#&gt; LO-REDUCTION      15 6575.325221 5715.223383
#&gt; LO-REDUCTION      17 6364.141012 5715.223383
#&gt; REFLECTION        19 6291.734048 5700.314819
#&gt; REFLECTION        21 6084.262198 5518.387803
#&gt; LO-REDUCTION      23 5909.139271 5518.387803
#&gt; LO-REDUCTION      25 5908.656489 5518.387803
#&gt; LO-REDUCTION      27 5737.426650 5518.387803
#&gt; LO-REDUCTION      29 5715.223383 5518.387803
#&gt; LO-REDUCTION      31 5700.314819 5518.387803
#&gt; LO-REDUCTION      33 5600.058830 5518.387803
#&gt; LO-REDUCTION      35 5562.714286 5516.141620
#&gt; HI-REDUCTION      37 5555.596426 5516.141620
#&gt; LO-REDUCTION      39 5547.357637 5516.141620
#&gt; HI-REDUCTION      41 5526.942939 5516.141620
#&gt; HI-REDUCTION      43 5524.810296 5516.141620
#&gt; HI-REDUCTION      45 5522.489068 5516.141620
#&gt; LO-REDUCTION      47 5522.248602 5513.486514
#&gt; LO-REDUCTION      49 5520.375965 5513.483959
#&gt; LO-REDUCTION      51 5518.387803 5512.796101
#&gt; HI-REDUCTION      53 5516.783583 5512.796101
#&gt; HI-REDUCTION      55 5516.347229 5512.796101
#&gt; LO-REDUCTION      57 5516.141620 5512.796101
#&gt; LO-REDUCTION      59 5513.486514 5512.068244
#&gt; HI-REDUCTION      61 5513.483959 5511.963158
#&gt; HI-REDUCTION      63 5513.248988 5511.963158
#&gt; REFLECTION        65 5513.244222 5511.726275
#&gt; LO-REDUCTION      67 5512.927062 5511.479912
#&gt; LO-REDUCTION      69 5512.796101 5511.479912
#&gt; HI-REDUCTION      71 5512.120034 5511.479912
#&gt; REFLECTION        73 5512.068244 5511.212077
#&gt; LO-REDUCTION      75 5511.963158 5511.212077
#&gt; REFLECTION        77 5511.726275 5511.106301
#&gt; HI-REDUCTION      79 5511.594318 5511.106301
#&gt; LO-REDUCTION      81 5511.584725 5511.106301
#&gt; EXTENSION         83 5511.479912 5510.597635
#&gt; HI-REDUCTION      85 5511.379695 5510.597635
#&gt; EXTENSION         87 5511.231441 5510.178312
#&gt; LO-REDUCTION      89 5511.212077 5510.178312
#&gt; LO-REDUCTION      91 5511.209614 5510.178312
#&gt; EXTENSION         93 5511.106301 5509.875600
#&gt; LO-REDUCTION      95 5510.979825 5509.875600
#&gt; EXTENSION         97 5510.597635 5509.575838
#&gt; REFLECTION        99 5510.409798 5509.552913
#&gt; LO-REDUCTION     101 5510.298189 5509.535775
#&gt; LO-REDUCTION     103 5510.178312 5509.535775
#&gt; REFLECTION       105 5510.055602 5509.365110
#&gt; LO-REDUCTION     107 5509.875600 5509.365110
#&gt; EXTENSION        109 5509.745528 5508.987604
#&gt; EXTENSION        111 5509.575838 5508.532395
#&gt; LO-REDUCTION     113 5509.552913 5508.532395
#&gt; LO-REDUCTION     115 5509.535775 5508.532395
#&gt; LO-REDUCTION     117 5509.527933 5508.532395
#&gt; EXTENSION        119 5509.365110 5508.296098
#&gt; LO-REDUCTION     121 5509.124646 5508.296098
#&gt; EXTENSION        123 5508.987604 5508.218992
#&gt; EXTENSION        125 5508.977839 5507.695832
#&gt; LO-REDUCTION     127 5508.852507 5507.695832
#&gt; LO-REDUCTION     129 5508.532395 5507.695832
#&gt; LO-REDUCTION     131 5508.509960 5507.695832
#&gt; LO-REDUCTION     133 5508.296098 5507.695832
#&gt; LO-REDUCTION     135 5508.218992 5507.695832
#&gt; LO-REDUCTION     137 5508.083462 5507.695832
#&gt; LO-REDUCTION     139 5508.064525 5507.695832
#&gt; EXTENSION        141 5507.958535 5507.470393
#&gt; LO-REDUCTION     143 5507.896494 5507.470393
#&gt; LO-REDUCTION     145 5507.864514 5507.470393
#&gt; LO-REDUCTION     147 5507.859305 5507.470393
#&gt; EXTENSION        149 5507.837479 5507.382558
#&gt; REFLECTION       151 5507.695832 5507.328976
#&gt; REFLECTION       153 5507.649553 5507.313825
#&gt; EXTENSION        155 5507.615046 5507.142561
#&gt; LO-REDUCTION     157 5507.491799 5507.142561
#&gt; LO-REDUCTION     159 5507.470393 5507.142561
#&gt; LO-REDUCTION     161 5507.382558 5507.142561
#&gt; LO-REDUCTION     163 5507.328976 5507.142561
#&gt; LO-REDUCTION     165 5507.313825 5507.142561
#&gt; LO-REDUCTION     167 5507.245121 5507.142561
#&gt; EXTENSION        169 5507.238929 5507.050344
#&gt; LO-REDUCTION     171 5507.178347 5507.050344
#&gt; LO-REDUCTION     173 5507.177258 5507.050344
#&gt; LO-REDUCTION     175 5507.173622 5507.050344
#&gt; EXTENSION        177 5507.166701 5506.974368
#&gt; LO-REDUCTION     179 5507.142561 5506.974368
#&gt; LO-REDUCTION     181 5507.090794 5506.974368
#&gt; LO-REDUCTION     183 5507.089587 5506.974368
#&gt; EXTENSION        185 5507.081847 5506.838011
#&gt; LO-REDUCTION     187 5507.050344 5506.838011
#&gt; LO-REDUCTION     189 5506.997606 5506.838011
#&gt; LO-REDUCTION     191 5506.990077 5506.838011
#&gt; EXTENSION        193 5506.977747 5506.780893
#&gt; EXTENSION        195 5506.974368 5506.726870
#&gt; LO-REDUCTION     197 5506.897296 5506.726870
#&gt; LO-REDUCTION     199 5506.892681 5506.726870
#&gt; EXTENSION        201 5506.889037 5506.681902
#&gt; REFLECTION       203 5506.838011 5506.631854
#&gt; HI-REDUCTION     205 5506.780893 5506.631854
#&gt; EXTENSION        207 5506.750701 5506.585112
#&gt; LO-REDUCTION     209 5506.742175 5506.585112
#&gt; LO-REDUCTION     211 5506.726870 5506.585112
#&gt; REFLECTION       213 5506.724557 5506.550645
#&gt; LO-REDUCTION     215 5506.681902 5506.550645
#&gt; LO-REDUCTION     217 5506.631854 5506.550645
#&gt; REFLECTION       219 5506.621015 5506.546622
#&gt; HI-REDUCTION     221 5506.611945 5506.546622
#&gt; REFLECTION       223 5506.588000 5506.528171
#&gt; LO-REDUCTION     225 5506.585112 5506.528171
#&gt; EXTENSION        227 5506.568812 5506.484979
#&gt; LO-REDUCTION     229 5506.554652 5506.484979
#&gt; EXTENSION        231 5506.550645 5506.432361
#&gt; LO-REDUCTION     233 5506.546622 5506.432361
#&gt; LO-REDUCTION     235 5506.532700 5506.432361
#&gt; EXTENSION        237 5506.528171 5506.354677
#&gt; LO-REDUCTION     239 5506.492124 5506.354677
#&gt; LO-REDUCTION     241 5506.484979 5506.354677
#&gt; EXTENSION        243 5506.444064 5506.242095
#&gt; LO-REDUCTION     245 5506.441524 5506.242095
#&gt; LO-REDUCTION     247 5506.432361 5506.242095
#&gt; EXTENSION        249 5506.387783 5506.186619
#&gt; EXTENSION        251 5506.360545 5506.151983
#&gt; LO-REDUCTION     253 5506.354677 5506.151983
#&gt; EXTENSION        255 5506.316230 5506.044325
#&gt; EXTENSION        257 5506.314687 5505.862455
#&gt; LO-REDUCTION     259 5506.242095 5505.862455
#&gt; LO-REDUCTION     261 5506.188359 5505.862455
#&gt; LO-REDUCTION     263 5506.186619 5505.862455
#&gt; LO-REDUCTION     265 5506.151983 5505.862455
#&gt; REFLECTION       267 5506.044325 5505.859369
#&gt; EXTENSION        269 5506.003211 5505.680125
#&gt; LO-REDUCTION     271 5505.921448 5505.680125
#&gt; LO-REDUCTION     273 5505.920802 5505.680125
#&gt; EXTENSION        275 5505.863177 5505.516553
#&gt; LO-REDUCTION     277 5505.862455 5505.516553
#&gt; LO-REDUCTION     279 5505.859369 5505.516553
#&gt; EXTENSION        281 5505.692970 5505.392371
#&gt; LO-REDUCTION     283 5505.680478 5505.392371
#&gt; REFLECTION       285 5505.680125 5505.355869
#&gt; LO-REDUCTION     287 5505.573727 5505.352848
#&gt; LO-REDUCTION     289 5505.566489 5505.352848
#&gt; REFLECTION       291 5505.516553 5505.321669
#&gt; LO-REDUCTION     293 5505.420169 5505.321669
#&gt; REFLECTION       295 5505.392371 5505.306305
#&gt; LO-REDUCTION     297 5505.376064 5505.306305
#&gt; LO-REDUCTION     299 5505.367504 5505.299958
#&gt; REFLECTION       301 5505.355869 5505.262234
#&gt; LO-REDUCTION     303 5505.352848 5505.262234
#&gt; LO-REDUCTION     305 5505.321669 5505.262234
#&gt; LO-REDUCTION     307 5505.314130 5505.262234
#&gt; LO-REDUCTION     309 5505.306305 5505.262234
#&gt; LO-REDUCTION     311 5505.299958 5505.262234
#&gt; LO-REDUCTION     313 5505.293246 5505.262234
#&gt; LO-REDUCTION     315 5505.272288 5505.259350
#&gt; LO-REDUCTION     317 5505.271654 5505.259350
#&gt; LO-REDUCTION     319 5505.266242 5505.257230
#&gt; LO-REDUCTION     321 5505.266143 5505.257230
#&gt; HI-REDUCTION     323 5505.265500 5505.257230
#&gt; HI-REDUCTION     325 5505.262234 5505.257230
#&gt; REFLECTION       327 5505.261251 5505.256515
#&gt; LO-REDUCTION     329 5505.259350 5505.256496
#&gt; HI-REDUCTION     331 5505.259313 5505.256496
#&gt; REFLECTION       333 5505.259157 5505.255024
#&gt; LO-REDUCTION     335 5505.258168 5505.255024
#&gt; REFLECTION       337 5505.257230 5505.254207
#&gt; HI-REDUCTION     339 5505.256901 5505.254207
#&gt; EXTENSION        341 5505.256515 5505.252418
#&gt; HI-REDUCTION     343 5505.256496 5505.252418
#&gt; LO-REDUCTION     345 5505.255187 5505.252418
#&gt; EXTENSION        347 5505.255042 5505.251984
#&gt; HI-REDUCTION     349 5505.255024 5505.251984
#&gt; LO-REDUCTION     351 5505.254371 5505.251984
#&gt; REFLECTION       353 5505.254207 5505.251673
#&gt; EXTENSION        355 5505.253438 5505.250812
#&gt; EXTENSION        357 5505.253317 5505.248276
#&gt; LO-REDUCTION     359 5505.252418 5505.248276
#&gt; LO-REDUCTION     361 5505.252243 5505.248276
#&gt; LO-REDUCTION     363 5505.251984 5505.248276
#&gt; REFLECTION       365 5505.251673 5505.248208
#&gt; LO-REDUCTION     367 5505.250812 5505.248208
#&gt; REFLECTION       369 5505.250331 5505.248208
#&gt; EXTENSION        371 5505.249888 5505.245739
#&gt; LO-REDUCTION     373 5505.249060 5505.245739
#&gt; LO-REDUCTION     375 5505.248993 5505.245739
#&gt; EXTENSION        377 5505.248276 5505.243511
#&gt; LO-REDUCTION     379 5505.248208 5505.243511
#&gt; LO-REDUCTION     381 5505.248208 5505.243511
#&gt; EXTENSION        383 5505.246222 5505.241511
#&gt; LO-REDUCTION     385 5505.245826 5505.241511
#&gt; EXTENSION        387 5505.245739 5505.238923
#&gt; EXTENSION        389 5505.244484 5505.235803
#&gt; LO-REDUCTION     391 5505.243717 5505.235803
#&gt; LO-REDUCTION     393 5505.243511 5505.235803
#&gt; LO-REDUCTION     395 5505.241860 5505.235803
#&gt; REFLECTION       397 5505.241511 5505.235557
#&gt; REFLECTION       399 5505.238923 5505.235048
#&gt; REFLECTION       401 5505.236533 5505.233641
#&gt; LO-REDUCTION     403 5505.236351 5505.233641
#&gt; LO-REDUCTION     405 5505.236219 5505.233641
#&gt; LO-REDUCTION     407 5505.235803 5505.233641
#&gt; HI-REDUCTION     409 5505.235557 5505.233641
#&gt; LO-REDUCTION     411 5505.235048 5505.233641
#&gt; LO-REDUCTION     413 5505.234308 5505.233641
#&gt; LO-REDUCTION     415 5505.234110 5505.233501
#&gt; LO-REDUCTION     417 5505.234038 5505.233501
#&gt; LO-REDUCTION     419 5505.234007 5505.233501
#&gt; REFLECTION       421 5505.233739 5505.233307
#&gt; LO-REDUCTION     423 5505.233665 5505.233307
#&gt; HI-REDUCTION     425 5505.233641 5505.233307
#&gt; REFLECTION       427 5505.233543 5505.233258
#&gt; HI-REDUCTION     429 5505.233541 5505.233258
#&gt; EXTENSION        431 5505.233501 5505.233042
#&gt; LO-REDUCTION     433 5505.233340 5505.233042
#&gt; LO-REDUCTION     435 5505.233333 5505.233042
#&gt; EXTENSION        437 5505.233314 5505.232847
#&gt; LO-REDUCTION     439 5505.233307 5505.232847
#&gt; LO-REDUCTION     441 5505.233258 5505.232847
#&gt; LO-REDUCTION     443 5505.233124 5505.232847
#&gt; LO-REDUCTION     445 5505.233090 5505.232847
#&gt; LO-REDUCTION     447 5505.233042 5505.232847
#&gt; REFLECTION       449 5505.233026 5505.232836
#&gt; EXTENSION        451 5505.232985 5505.232540
#&gt; LO-REDUCTION     453 5505.232924 5505.232540
#&gt; LO-REDUCTION     455 5505.232898 5505.232540
#&gt; LO-REDUCTION     457 5505.232866 5505.232540
#&gt; LO-REDUCTION     459 5505.232847 5505.232540
#&gt; LO-REDUCTION     461 5505.232836 5505.232540
#&gt; LO-REDUCTION     463 5505.232834 5505.232540
#&gt; EXTENSION        465 5505.232713 5505.232260
#&gt; LO-REDUCTION     467 5505.232707 5505.232260
#&gt; LO-REDUCTION     469 5505.232693 5505.232260
#&gt; EXTENSION        471 5505.232578 5505.231981
#&gt; LO-REDUCTION     473 5505.232572 5505.231981
#&gt; LO-REDUCTION     475 5505.232540 5505.231981
#&gt; EXTENSION        477 5505.232426 5505.231886
#&gt; EXTENSION        479 5505.232372 5505.231698
#&gt; EXTENSION        481 5505.232260 5505.231632
#&gt; LO-REDUCTION     483 5505.232188 5505.231632
#&gt; EXTENSION        485 5505.232047 5505.231316
#&gt; LO-REDUCTION     487 5505.231981 5505.231316
#&gt; HI-REDUCTION     489 5505.231886 5505.231316
#&gt; LO-REDUCTION     491 5505.231698 5505.231316
#&gt; LO-REDUCTION     493 5505.231655 5505.231316
#&gt; LO-REDUCTION     495 5505.231654 5505.231316
#&gt; HI-REDUCTION     497 5505.231632 5505.231316
#&gt; EXTENSION        499 5505.231602 5505.231263
#&gt; EXTENSION        501 5505.231465 5505.230966
#&gt; LO-REDUCTION     503 5505.231443 5505.230966
#&gt; LO-REDUCTION     505 5505.231403 5505.230966
#&gt; LO-REDUCTION     507 5505.231375 5505.230966
#&gt; LO-REDUCTION     509 5505.231316 5505.230966
#&gt; LO-REDUCTION     511 5505.231263 5505.230966
#&gt; REFLECTION       513 5505.231259 5505.230954
#&gt; EXTENSION        515 5505.231130 5505.230548
#&gt; LO-REDUCTION     517 5505.231075 5505.230548
#&gt; LO-REDUCTION     519 5505.231019 5505.230548
#&gt; LO-REDUCTION     521 5505.231007 5505.230548
#&gt; LO-REDUCTION     523 5505.230966 5505.230548
#&gt; EXTENSION        525 5505.230954 5505.230466
#&gt; EXTENSION        527 5505.230776 5505.230018
#&gt; LO-REDUCTION     529 5505.230667 5505.230018
#&gt; EXTENSION        531 5505.230602 5505.229805
#&gt; LO-REDUCTION     533 5505.230596 5505.229805
#&gt; LO-REDUCTION     535 5505.230548 5505.229805
#&gt; LO-REDUCTION     537 5505.230466 5505.229805
#&gt; EXTENSION        539 5505.230121 5505.229216
#&gt; LO-REDUCTION     541 5505.230106 5505.229216
#&gt; LO-REDUCTION     543 5505.230035 5505.229216
#&gt; LO-REDUCTION     545 5505.230018 5505.229216
#&gt; EXTENSION        547 5505.229881 5505.229049
#&gt; EXTENSION        549 5505.229805 5505.228969
#&gt; EXTENSION        551 5505.229540 5505.228538
#&gt; LO-REDUCTION     553 5505.229480 5505.228538
#&gt; REFLECTION       555 5505.229287 5505.228525
#&gt; LO-REDUCTION     557 5505.229216 5505.228525
#&gt; LO-REDUCTION     559 5505.229049 5505.228525
#&gt; HI-REDUCTION     561 5505.228969 5505.228525
#&gt; LO-REDUCTION     563 5505.228730 5505.228525
#&gt; LO-REDUCTION     565 5505.228704 5505.228525
#&gt; EXTENSION        567 5505.228701 5505.228348
#&gt; LO-REDUCTION     569 5505.228689 5505.228348
#&gt; LO-REDUCTION     571 5505.228632 5505.228348
#&gt; LO-REDUCTION     573 5505.228612 5505.228348
#&gt; EXTENSION        575 5505.228538 5505.228198
#&gt; LO-REDUCTION     577 5505.228525 5505.228198
#&gt; EXTENSION        579 5505.228514 5505.228037
#&gt; EXTENSION        581 5505.228426 5505.227946
#&gt; LO-REDUCTION     583 5505.228365 5505.227946
#&gt; EXTENSION        585 5505.228348 5505.227689
#&gt; LO-REDUCTION     587 5505.228201 5505.227689
#&gt; LO-REDUCTION     589 5505.228198 5505.227689
#&gt; EXTENSION        591 5505.228037 5505.227469
#&gt; LO-REDUCTION     593 5505.227971 5505.227469
#&gt; LO-REDUCTION     595 5505.227946 5505.227469
#&gt; LO-REDUCTION     597 5505.227828 5505.227469
#&gt; EXTENSION        599 5505.227711 5505.227157
#&gt; LO-REDUCTION     601 5505.227689 5505.227157
#&gt; LO-REDUCTION     603 5505.227648 5505.227157
#&gt; LO-REDUCTION     605 5505.227611 5505.227157
#&gt; LO-REDUCTION     607 5505.227511 5505.227157
#&gt; LO-REDUCTION     609 5505.227469 5505.227157
#&gt; LO-REDUCTION     611 5505.227392 5505.227157
#&gt; EXTENSION        613 5505.227353 5505.227041
#&gt; EXTENSION        615 5505.227320 5505.226924
#&gt; EXTENSION        617 5505.227299 5505.226772
#&gt; LO-REDUCTION     619 5505.227234 5505.226772
#&gt; EXTENSION        621 5505.227207 5505.226483
#&gt; LO-REDUCTION     623 5505.227157 5505.226483
#&gt; LO-REDUCTION     625 5505.227041 5505.226483
#&gt; LO-REDUCTION     627 5505.226924 5505.226483
#&gt; EXTENSION        629 5505.226834 5505.226319
#&gt; EXTENSION        631 5505.226772 5505.226272
#&gt; LO-REDUCTION     633 5505.226733 5505.226272
#&gt; REFLECTION       635 5505.226611 5505.226232
#&gt; EXTENSION        637 5505.226487 5505.226009
#&gt; LO-REDUCTION     639 5505.226483 5505.226009
#&gt; HI-REDUCTION     641 5505.226334 5505.226009
#&gt; EXTENSION        643 5505.226319 5505.225914
#&gt; LO-REDUCTION     645 5505.226272 5505.225914
#&gt; REFLECTION       647 5505.226232 5505.225894
#&gt; REFLECTION       649 5505.226208 5505.225791
#&gt; LO-REDUCTION     651 5505.226069 5505.225791
#&gt; LO-REDUCTION     653 5505.226009 5505.225791
#&gt; LO-REDUCTION     655 5505.225951 5505.225791
#&gt; LO-REDUCTION     657 5505.225937 5505.225791
#&gt; LO-REDUCTION     659 5505.225914 5505.225791
#&gt; REFLECTION       661 5505.225894 5505.225771
#&gt; EXTENSION        663 5505.225844 5505.225726
#&gt; EXTENSION        665 5505.225838 5505.225690
#&gt; REFLECTION       667 5505.225828 5505.225687
#&gt; LO-REDUCTION     669 5505.225806 5505.225687
#&gt; LO-REDUCTION     671 5505.225791 5505.225687
#&gt; EXTENSION        673 5505.225771 5505.225562
#&gt; HI-REDUCTION     675 5505.225726 5505.225562
#&gt; LO-REDUCTION     677 5505.225710 5505.225562
#&gt; LO-REDUCTION     679 5505.225690 5505.225562
#&gt; LO-REDUCTION     681 5505.225690 5505.225562
#&gt; LO-REDUCTION     683 5505.225687 5505.225562
#&gt; EXTENSION        685 5505.225684 5505.225538
#&gt; REFLECTION       687 5505.225642 5505.225532
#&gt; REFLECTION       689 5505.225622 5505.225525
#&gt; Exiting from Nelder Mead minimizer
#&gt;     691 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9957518   1.4986357  -2.9986512  -0.9593963  -0.6073558   0.3056941 
#&gt; 
#&gt; $value
#&gt; [1] 5505.226
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      691 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.58 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |========================================================              |  80%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6128.060786
#&gt;   Scaled convergence tolerance is 9.13152e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11591.514798 5737.637543
#&gt; LO-REDUCTION       9 7773.991045 5737.637543
#&gt; LO-REDUCTION      11 7622.747268 5737.637543
#&gt; REFLECTION        13 6956.511042 5735.606577
#&gt; LO-REDUCTION      15 6664.690366 5735.606577
#&gt; LO-REDUCTION      17 6385.367857 5735.606577
#&gt; REFLECTION        19 6348.504538 5711.523660
#&gt; REFLECTION        21 6128.060786 5511.451329
#&gt; LO-REDUCTION      23 5924.263459 5511.451329
#&gt; LO-REDUCTION      25 5898.022447 5511.451329
#&gt; LO-REDUCTION      27 5737.637543 5511.451329
#&gt; HI-REDUCTION      29 5735.606577 5511.451329
#&gt; LO-REDUCTION      31 5711.523660 5511.451329
#&gt; LO-REDUCTION      33 5598.009438 5511.451329
#&gt; LO-REDUCTION      35 5588.328530 5511.451329
#&gt; LO-REDUCTION      37 5546.129005 5511.451329
#&gt; HI-REDUCTION      39 5545.700206 5511.451329
#&gt; HI-REDUCTION      41 5520.227553 5511.451329
#&gt; LO-REDUCTION      43 5520.035476 5507.808843
#&gt; LO-REDUCTION      45 5518.761065 5507.808843
#&gt; LO-REDUCTION      47 5517.258569 5506.984642
#&gt; HI-REDUCTION      49 5516.244456 5506.984642
#&gt; REFLECTION        51 5512.201177 5506.687674
#&gt; LO-REDUCTION      53 5511.451329 5505.480231
#&gt; HI-REDUCTION      55 5510.677698 5505.480231
#&gt; LO-REDUCTION      57 5509.181361 5504.641074
#&gt; LO-REDUCTION      59 5507.808843 5503.765086
#&gt; HI-REDUCTION      61 5506.984642 5503.765086
#&gt; LO-REDUCTION      63 5506.687674 5503.765086
#&gt; HI-REDUCTION      65 5505.604090 5503.765086
#&gt; REFLECTION        67 5505.480231 5503.268863
#&gt; LO-REDUCTION      69 5504.641074 5503.268863
#&gt; EXTENSION         71 5504.577955 5501.895146
#&gt; LO-REDUCTION      73 5504.096058 5501.895146
#&gt; LO-REDUCTION      75 5503.790697 5501.895146
#&gt; LO-REDUCTION      77 5503.765086 5501.895146
#&gt; LO-REDUCTION      79 5503.614815 5501.895146
#&gt; EXTENSION         81 5503.268863 5500.919510
#&gt; LO-REDUCTION      83 5502.858489 5500.919510
#&gt; REFLECTION        85 5502.123302 5500.701834
#&gt; HI-REDUCTION      87 5502.104222 5500.701834
#&gt; LO-REDUCTION      89 5502.093500 5500.701834
#&gt; LO-REDUCTION      91 5501.895146 5500.701834
#&gt; EXTENSION         93 5501.217692 5498.863510
#&gt; LO-REDUCTION      95 5500.943278 5498.863510
#&gt; HI-REDUCTION      97 5500.922567 5498.863510
#&gt; LO-REDUCTION      99 5500.919510 5498.863510
#&gt; LO-REDUCTION     101 5500.843042 5498.863510
#&gt; LO-REDUCTION     103 5500.701834 5498.863510
#&gt; EXTENSION        105 5500.371602 5498.303311
#&gt; LO-REDUCTION     107 5500.356002 5498.303311
#&gt; EXTENSION        109 5499.815884 5497.455313
#&gt; LO-REDUCTION     111 5499.531989 5497.455313
#&gt; EXTENSION        113 5498.976542 5497.039400
#&gt; LO-REDUCTION     115 5498.863510 5497.039400
#&gt; REFLECTION       117 5498.491777 5497.035839
#&gt; LO-REDUCTION     119 5498.303311 5496.991762
#&gt; LO-REDUCTION     121 5497.800827 5496.991762
#&gt; LO-REDUCTION     123 5497.455313 5496.875775
#&gt; HI-REDUCTION     125 5497.207688 5496.875775
#&gt; REFLECTION       127 5497.185781 5496.689103
#&gt; REFLECTION       129 5497.039400 5496.576199
#&gt; HI-REDUCTION     131 5497.035839 5496.576199
#&gt; LO-REDUCTION     133 5496.991762 5496.576199
#&gt; LO-REDUCTION     135 5496.987781 5496.576199
#&gt; LO-REDUCTION     137 5496.875775 5496.576199
#&gt; REFLECTION       139 5496.776008 5496.552622
#&gt; EXTENSION        141 5496.704860 5496.283468
#&gt; LO-REDUCTION     143 5496.689103 5496.283468
#&gt; LO-REDUCTION     145 5496.680706 5496.283468
#&gt; EXTENSION        147 5496.622123 5496.136861
#&gt; LO-REDUCTION     149 5496.576199 5496.136861
#&gt; EXTENSION        151 5496.552622 5495.951177
#&gt; EXTENSION        153 5496.430923 5495.705573
#&gt; EXTENSION        155 5496.384294 5495.354065
#&gt; EXTENSION        157 5496.283468 5494.972112
#&gt; LO-REDUCTION     159 5496.191580 5494.972112
#&gt; LO-REDUCTION     161 5496.136861 5494.972112
#&gt; REFLECTION       163 5495.951177 5494.895590
#&gt; LO-REDUCTION     165 5495.705573 5494.895590
#&gt; EXTENSION        167 5495.354065 5494.523823
#&gt; EXTENSION        169 5495.144453 5494.373814
#&gt; LO-REDUCTION     171 5495.017010 5494.373814
#&gt; REFLECTION       173 5494.972112 5494.309465
#&gt; LO-REDUCTION     175 5494.900162 5494.309465
#&gt; LO-REDUCTION     177 5494.895590 5494.309465
#&gt; LO-REDUCTION     179 5494.565639 5494.309465
#&gt; LO-REDUCTION     181 5494.523823 5494.309465
#&gt; LO-REDUCTION     183 5494.445513 5494.309465
#&gt; REFLECTION       185 5494.430962 5494.294433
#&gt; REFLECTION       187 5494.373814 5494.279524
#&gt; LO-REDUCTION     189 5494.334876 5494.256839
#&gt; REFLECTION       191 5494.323365 5494.247568
#&gt; HI-REDUCTION     193 5494.322381 5494.247568
#&gt; LO-REDUCTION     195 5494.309465 5494.240376
#&gt; REFLECTION       197 5494.294433 5494.215253
#&gt; LO-REDUCTION     199 5494.279524 5494.215253
#&gt; LO-REDUCTION     201 5494.256839 5494.215253
#&gt; LO-REDUCTION     203 5494.254087 5494.210923
#&gt; LO-REDUCTION     205 5494.247568 5494.209846
#&gt; LO-REDUCTION     207 5494.240725 5494.209846
#&gt; LO-REDUCTION     209 5494.240376 5494.209846
#&gt; REFLECTION       211 5494.222781 5494.204122
#&gt; HI-REDUCTION     213 5494.215253 5494.204122
#&gt; HI-REDUCTION     215 5494.214758 5494.204122
#&gt; LO-REDUCTION     217 5494.210923 5494.201514
#&gt; EXTENSION        219 5494.210578 5494.192113
#&gt; LO-REDUCTION     221 5494.209846 5494.192113
#&gt; HI-REDUCTION     223 5494.206655 5494.192113
#&gt; LO-REDUCTION     225 5494.204977 5494.192113
#&gt; LO-REDUCTION     227 5494.204122 5494.192113
#&gt; LO-REDUCTION     229 5494.201514 5494.192113
#&gt; REFLECTION       231 5494.199243 5494.191376
#&gt; LO-REDUCTION     233 5494.197588 5494.191376
#&gt; REFLECTION       235 5494.195763 5494.191256
#&gt; LO-REDUCTION     237 5494.194880 5494.191256
#&gt; REFLECTION       239 5494.194376 5494.190071
#&gt; HI-REDUCTION     241 5494.192113 5494.190071
#&gt; LO-REDUCTION     243 5494.191633 5494.190071
#&gt; REFLECTION       245 5494.191376 5494.189186
#&gt; LO-REDUCTION     247 5494.191307 5494.189186
#&gt; LO-REDUCTION     249 5494.191256 5494.189186
#&gt; LO-REDUCTION     251 5494.190628 5494.189009
#&gt; HI-REDUCTION     253 5494.190390 5494.189009
#&gt; LO-REDUCTION     255 5494.190071 5494.189009
#&gt; REFLECTION       257 5494.189401 5494.188628
#&gt; LO-REDUCTION     259 5494.189268 5494.188628
#&gt; REFLECTION       261 5494.189196 5494.188399
#&gt; LO-REDUCTION     263 5494.189186 5494.188396
#&gt; LO-REDUCTION     265 5494.189088 5494.188396
#&gt; LO-REDUCTION     267 5494.189009 5494.188396
#&gt; REFLECTION       269 5494.188660 5494.188112
#&gt; HI-REDUCTION     271 5494.188628 5494.188112
#&gt; LO-REDUCTION     273 5494.188515 5494.188112
#&gt; LO-REDUCTION     275 5494.188461 5494.188112
#&gt; HI-REDUCTION     277 5494.188399 5494.188112
#&gt; HI-REDUCTION     279 5494.188396 5494.188112
#&gt; LO-REDUCTION     281 5494.188357 5494.188112
#&gt; EXTENSION        283 5494.188265 5494.188020
#&gt; LO-REDUCTION     285 5494.188262 5494.188020
#&gt; LO-REDUCTION     287 5494.188253 5494.188020
#&gt; REFLECTION       289 5494.188223 5494.188018
#&gt; REFLECTION       291 5494.188173 5494.187968
#&gt; LO-REDUCTION     293 5494.188112 5494.187968
#&gt; LO-REDUCTION     295 5494.188092 5494.187968
#&gt; LO-REDUCTION     297 5494.188090 5494.187968
#&gt; EXTENSION        299 5494.188020 5494.187812
#&gt; LO-REDUCTION     301 5494.188018 5494.187812
#&gt; LO-REDUCTION     303 5494.188000 5494.187812
#&gt; LO-REDUCTION     305 5494.187980 5494.187812
#&gt; LO-REDUCTION     307 5494.187970 5494.187812
#&gt; LO-REDUCTION     309 5494.187968 5494.187812
#&gt; LO-REDUCTION     311 5494.187951 5494.187812
#&gt; REFLECTION       313 5494.187914 5494.187792
#&gt; EXTENSION        315 5494.187891 5494.187770
#&gt; REFLECTION       317 5494.187864 5494.187752
#&gt; EXTENSION        319 5494.187850 5494.187674
#&gt; LO-REDUCTION     321 5494.187817 5494.187674
#&gt; LO-REDUCTION     323 5494.187812 5494.187674
#&gt; LO-REDUCTION     325 5494.187792 5494.187674
#&gt; LO-REDUCTION     327 5494.187770 5494.187674
#&gt; Exiting from Nelder Mead minimizer
#&gt;     329 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0361056   1.4918212  -2.9997785  -0.9486484  -0.7859652   0.2995161 
#&gt; 
#&gt; $value
#&gt; [1] 5494.188
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      329 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.272 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===============================================================       |  90%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6225.753565
#&gt;   Scaled convergence tolerance is 9.2771e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11356.034057 5819.456131
#&gt; LO-REDUCTION       9 8011.282054 5819.456131
#&gt; LO-REDUCTION      11 7838.792041 5819.456131
#&gt; LO-REDUCTION      13 7195.304798 5819.456131
#&gt; LO-REDUCTION      15 6468.458178 5819.456131
#&gt; EXTENSION         17 6452.160991 5578.191445
#&gt; LO-REDUCTION      19 6318.912090 5578.191445
#&gt; LO-REDUCTION      21 6225.753565 5578.191445
#&gt; LO-REDUCTION      23 5982.476820 5578.191445
#&gt; LO-REDUCTION      25 5884.369681 5578.191445
#&gt; LO-REDUCTION      27 5819.456131 5578.191445
#&gt; LO-REDUCTION      29 5754.701533 5565.787062
#&gt; LO-REDUCTION      31 5681.255280 5565.787062
#&gt; LO-REDUCTION      33 5617.946645 5565.787062
#&gt; LO-REDUCTION      35 5605.882488 5565.787062
#&gt; LO-REDUCTION      37 5601.533110 5565.787062
#&gt; REFLECTION        39 5592.657249 5552.854791
#&gt; REFLECTION        41 5578.191445 5548.424578
#&gt; REFLECTION        43 5573.142745 5537.081491
#&gt; LO-REDUCTION      45 5572.970801 5537.081491
#&gt; LO-REDUCTION      47 5567.256153 5537.081491
#&gt; HI-REDUCTION      49 5565.787062 5537.081491
#&gt; LO-REDUCTION      51 5552.854791 5537.081491
#&gt; HI-REDUCTION      53 5548.424578 5537.081491
#&gt; LO-REDUCTION      55 5547.445832 5537.081491
#&gt; LO-REDUCTION      57 5545.900443 5537.081491
#&gt; REFLECTION        59 5544.507048 5535.243600
#&gt; LO-REDUCTION      61 5542.806697 5535.243600
#&gt; REFLECTION        63 5542.206548 5532.774357
#&gt; REFLECTION        65 5537.859596 5531.275161
#&gt; LO-REDUCTION      67 5537.342148 5531.275161
#&gt; REFLECTION        69 5537.081491 5530.349867
#&gt; REFLECTION        71 5535.300496 5529.519164
#&gt; REFLECTION        73 5535.243600 5528.121052
#&gt; LO-REDUCTION      75 5532.903717 5528.121052
#&gt; REFLECTION        77 5532.774357 5527.943771
#&gt; REFLECTION        79 5531.275161 5527.540633
#&gt; LO-REDUCTION      81 5530.349867 5527.152804
#&gt; LO-REDUCTION      83 5529.519164 5526.943006
#&gt; REFLECTION        85 5528.414905 5526.660974
#&gt; HI-REDUCTION      87 5528.121052 5526.660974
#&gt; REFLECTION        89 5527.943771 5525.731964
#&gt; LO-REDUCTION      91 5527.540633 5525.723722
#&gt; HI-REDUCTION      93 5527.152804 5525.723722
#&gt; LO-REDUCTION      95 5526.943006 5525.723722
#&gt; HI-REDUCTION      97 5526.928033 5525.723722
#&gt; REFLECTION        99 5526.660974 5525.615209
#&gt; HI-REDUCTION     101 5526.270839 5525.615209
#&gt; REFLECTION       103 5526.155472 5525.391104
#&gt; REFLECTION       105 5526.127768 5525.247207
#&gt; LO-REDUCTION     107 5525.835955 5525.247207
#&gt; REFLECTION       109 5525.731964 5525.200690
#&gt; REFLECTION       111 5525.723722 5525.082767
#&gt; LO-REDUCTION     113 5525.615209 5525.082767
#&gt; REFLECTION       115 5525.391104 5524.837767
#&gt; LO-REDUCTION     117 5525.256396 5524.837767
#&gt; LO-REDUCTION     119 5525.247207 5524.837767
#&gt; REFLECTION       121 5525.200690 5524.721437
#&gt; LO-REDUCTION     123 5525.157050 5524.721437
#&gt; REFLECTION       125 5525.082767 5524.681807
#&gt; REFLECTION       127 5525.005475 5524.680449
#&gt; EXTENSION        129 5524.850574 5524.354690
#&gt; LO-REDUCTION     131 5524.837767 5524.354690
#&gt; LO-REDUCTION     133 5524.752558 5524.354690
#&gt; EXTENSION        135 5524.721437 5523.992196
#&gt; LO-REDUCTION     137 5524.681807 5523.992196
#&gt; EXTENSION        139 5524.680449 5523.851306
#&gt; LO-REDUCTION     141 5524.442517 5523.851306
#&gt; EXTENSION        143 5524.390871 5523.417560
#&gt; LO-REDUCTION     145 5524.354690 5523.417560
#&gt; EXTENSION        147 5524.297359 5523.394787
#&gt; EXTENSION        149 5524.000405 5522.143811
#&gt; LO-REDUCTION     151 5523.992196 5522.143811
#&gt; LO-REDUCTION     153 5523.851306 5522.143811
#&gt; LO-REDUCTION     155 5523.682417 5522.143811
#&gt; LO-REDUCTION     157 5523.417560 5522.143811
#&gt; LO-REDUCTION     159 5523.394787 5522.143811
#&gt; EXTENSION        161 5522.996485 5521.297361
#&gt; LO-REDUCTION     163 5522.670744 5521.297361
#&gt; LO-REDUCTION     165 5522.662090 5521.297361
#&gt; EXTENSION        167 5522.582104 5520.519206
#&gt; EXTENSION        169 5522.270130 5519.744558
#&gt; LO-REDUCTION     171 5522.143811 5519.744558
#&gt; EXTENSION        173 5521.582659 5519.651556
#&gt; EXTENSION        175 5521.315195 5518.136263
#&gt; LO-REDUCTION     177 5521.297361 5518.136263
#&gt; EXTENSION        179 5520.519206 5517.384774
#&gt; LO-REDUCTION     181 5520.378639 5517.384774
#&gt; LO-REDUCTION     183 5519.744558 5517.384774
#&gt; LO-REDUCTION     185 5519.651556 5517.384774
#&gt; LO-REDUCTION     187 5518.896228 5517.376596
#&gt; EXTENSION        189 5518.483760 5516.769126
#&gt; REFLECTION       191 5518.136263 5516.623346
#&gt; HI-REDUCTION     193 5517.908096 5516.623346
#&gt; LO-REDUCTION     195 5517.441377 5516.623346
#&gt; LO-REDUCTION     197 5517.384774 5516.623346
#&gt; REFLECTION       199 5517.376596 5516.410802
#&gt; LO-REDUCTION     201 5517.191739 5516.389233
#&gt; LO-REDUCTION     203 5516.769126 5516.389233
#&gt; LO-REDUCTION     205 5516.657279 5516.389233
#&gt; REFLECTION       207 5516.642765 5516.307435
#&gt; REFLECTION       209 5516.623346 5516.268305
#&gt; LO-REDUCTION     211 5516.541986 5516.268305
#&gt; LO-REDUCTION     213 5516.469567 5516.268305
#&gt; LO-REDUCTION     215 5516.410802 5516.268305
#&gt; LO-REDUCTION     217 5516.389233 5516.268305
#&gt; LO-REDUCTION     219 5516.334480 5516.260710
#&gt; LO-REDUCTION     221 5516.310345 5516.256974
#&gt; LO-REDUCTION     223 5516.307435 5516.256974
#&gt; REFLECTION       225 5516.286567 5516.214080
#&gt; HI-REDUCTION     227 5516.277821 5516.214080
#&gt; HI-REDUCTION     229 5516.268305 5516.214080
#&gt; LO-REDUCTION     231 5516.265415 5516.214080
#&gt; LO-REDUCTION     233 5516.260710 5516.214080
#&gt; LO-REDUCTION     235 5516.256974 5516.214080
#&gt; LO-REDUCTION     237 5516.248937 5516.214080
#&gt; LO-REDUCTION     239 5516.241659 5516.214080
#&gt; REFLECTION       241 5516.237165 5516.209821
#&gt; LO-REDUCTION     243 5516.236210 5516.209821
#&gt; EXTENSION        245 5516.221618 5516.183931
#&gt; LO-REDUCTION     247 5516.220113 5516.183931
#&gt; LO-REDUCTION     249 5516.217142 5516.183931
#&gt; LO-REDUCTION     251 5516.214080 5516.183931
#&gt; LO-REDUCTION     253 5516.211410 5516.183931
#&gt; EXTENSION        255 5516.209821 5516.176821
#&gt; LO-REDUCTION     257 5516.202589 5516.176821
#&gt; EXTENSION        259 5516.198639 5516.173349
#&gt; LO-REDUCTION     261 5516.194730 5516.173349
#&gt; REFLECTION       263 5516.186573 5516.171690
#&gt; LO-REDUCTION     265 5516.183931 5516.171690
#&gt; LO-REDUCTION     267 5516.182816 5516.171690
#&gt; LO-REDUCTION     269 5516.177937 5516.171690
#&gt; LO-REDUCTION     271 5516.176821 5516.171559
#&gt; HI-REDUCTION     273 5516.176281 5516.171559
#&gt; EXTENSION        275 5516.175435 5516.168890
#&gt; EXTENSION        277 5516.173349 5516.161196
#&gt; LO-REDUCTION     279 5516.172907 5516.161196
#&gt; LO-REDUCTION     281 5516.172722 5516.161196
#&gt; LO-REDUCTION     283 5516.171690 5516.161196
#&gt; EXTENSION        285 5516.171559 5516.156885
#&gt; LO-REDUCTION     287 5516.168890 5516.156885
#&gt; EXTENSION        289 5516.166938 5516.150811
#&gt; LO-REDUCTION     291 5516.166803 5516.150811
#&gt; EXTENSION        293 5516.163906 5516.137094
#&gt; LO-REDUCTION     295 5516.161196 5516.137094
#&gt; EXTENSION        297 5516.158375 5516.124353
#&gt; LO-REDUCTION     299 5516.156885 5516.124353
#&gt; LO-REDUCTION     301 5516.153603 5516.124353
#&gt; EXTENSION        303 5516.150811 5516.103449
#&gt; LO-REDUCTION     305 5516.143147 5516.103449
#&gt; EXTENSION        307 5516.138589 5516.087040
#&gt; LO-REDUCTION     309 5516.137094 5516.087040
#&gt; EXTENSION        311 5516.125696 5516.053662
#&gt; LO-REDUCTION     313 5516.124353 5516.053662
#&gt; LO-REDUCTION     315 5516.114817 5516.053662
#&gt; EXTENSION        317 5516.103449 5516.020438
#&gt; LO-REDUCTION     319 5516.092709 5516.020438
#&gt; LO-REDUCTION     321 5516.087040 5516.020438
#&gt; EXTENSION        323 5516.063298 5515.972998
#&gt; LO-REDUCTION     325 5516.060675 5515.972998
#&gt; LO-REDUCTION     327 5516.053662 5515.972998
#&gt; LO-REDUCTION     329 5516.035639 5515.972998
#&gt; LO-REDUCTION     331 5516.026388 5515.972998
#&gt; EXTENSION        333 5516.020438 5515.963092
#&gt; LO-REDUCTION     335 5516.011917 5515.963092
#&gt; EXTENSION        337 5515.987686 5515.947040
#&gt; EXTENSION        339 5515.985913 5515.910723
#&gt; LO-REDUCTION     341 5515.980442 5515.910723
#&gt; LO-REDUCTION     343 5515.972998 5515.910723
#&gt; LO-REDUCTION     345 5515.969482 5515.910723
#&gt; LO-REDUCTION     347 5515.963092 5515.910723
#&gt; EXTENSION        349 5515.947040 5515.887448
#&gt; LO-REDUCTION     351 5515.940114 5515.887448
#&gt; EXTENSION        353 5515.929439 5515.859170
#&gt; EXTENSION        355 5515.923338 5515.837668
#&gt; LO-REDUCTION     357 5515.922284 5515.837668
#&gt; LO-REDUCTION     359 5515.910723 5515.837668
#&gt; REFLECTION       361 5515.887521 5515.827984
#&gt; LO-REDUCTION     363 5515.887448 5515.827984
#&gt; LO-REDUCTION     365 5515.863704 5515.827984
#&gt; EXTENSION        367 5515.859170 5515.799540
#&gt; LO-REDUCTION     369 5515.837967 5515.799540
#&gt; LO-REDUCTION     371 5515.837668 5515.799540
#&gt; LO-REDUCTION     373 5515.834113 5515.799540
#&gt; LO-REDUCTION     375 5515.831272 5515.799540
#&gt; LO-REDUCTION     377 5515.827984 5515.799540
#&gt; LO-REDUCTION     379 5515.818989 5515.799540
#&gt; LO-REDUCTION     381 5515.818329 5515.799540
#&gt; LO-REDUCTION     383 5515.817390 5515.799540
#&gt; EXTENSION        385 5515.812537 5515.785677
#&gt; LO-REDUCTION     387 5515.808710 5515.785677
#&gt; EXTENSION        389 5515.804939 5515.778561
#&gt; LO-REDUCTION     391 5515.802961 5515.778561
#&gt; EXTENSION        393 5515.800037 5515.770281
#&gt; EXTENSION        395 5515.799540 5515.758437
#&gt; LO-REDUCTION     397 5515.795278 5515.758437
#&gt; EXTENSION        399 5515.785677 5515.728927
#&gt; LO-REDUCTION     401 5515.781336 5515.728927
#&gt; LO-REDUCTION     403 5515.778561 5515.728927
#&gt; LO-REDUCTION     405 5515.770281 5515.728927
#&gt; EXTENSION        407 5515.766422 5515.721480
#&gt; EXTENSION        409 5515.758437 5515.678174
#&gt; LO-REDUCTION     411 5515.746503 5515.678174
#&gt; LO-REDUCTION     413 5515.743994 5515.678174
#&gt; EXTENSION        415 5515.741052 5515.650608
#&gt; LO-REDUCTION     417 5515.728927 5515.650608
#&gt; LO-REDUCTION     419 5515.721480 5515.650608
#&gt; EXTENSION        421 5515.713030 5515.596578
#&gt; EXTENSION        423 5515.690298 5515.546370
#&gt; LO-REDUCTION     425 5515.678174 5515.546370
#&gt; LO-REDUCTION     427 5515.672823 5515.546370
#&gt; EXTENSION        429 5515.654671 5515.492663
#&gt; EXTENSION        431 5515.650608 5515.410059
#&gt; LO-REDUCTION     433 5515.596578 5515.410059
#&gt; LO-REDUCTION     435 5515.593130 5515.410059
#&gt; EXTENSION        437 5515.564827 5515.314994
#&gt; EXTENSION        439 5515.546370 5515.215205
#&gt; LO-REDUCTION     441 5515.492663 5515.215205
#&gt; EXTENSION        443 5515.425451 5515.092870
#&gt; LO-REDUCTION     445 5515.418692 5515.092870
#&gt; LO-REDUCTION     447 5515.410059 5515.092870
#&gt; LO-REDUCTION     449 5515.319639 5515.092870
#&gt; LO-REDUCTION     451 5515.314994 5515.092870
#&gt; EXTENSION        453 5515.215205 5514.985337
#&gt; LO-REDUCTION     455 5515.191301 5514.985337
#&gt; LO-REDUCTION     457 5515.173460 5514.985337
#&gt; LO-REDUCTION     459 5515.171086 5514.985337
#&gt; EXTENSION        461 5515.100400 5514.880650
#&gt; LO-REDUCTION     463 5515.092870 5514.880650
#&gt; HI-REDUCTION     465 5515.043398 5514.880650
#&gt; LO-REDUCTION     467 5515.013183 5514.880650
#&gt; LO-REDUCTION     469 5515.008915 5514.880650
#&gt; EXTENSION        471 5514.985337 5514.789062
#&gt; LO-REDUCTION     473 5514.981137 5514.789062
#&gt; LO-REDUCTION     475 5514.904345 5514.789062
#&gt; LO-REDUCTION     477 5514.895063 5514.789062
#&gt; LO-REDUCTION     479 5514.885775 5514.789062
#&gt; LO-REDUCTION     481 5514.880650 5514.789062
#&gt; LO-REDUCTION     483 5514.861509 5514.789062
#&gt; EXTENSION        485 5514.843049 5514.761969
#&gt; LO-REDUCTION     487 5514.820984 5514.761969
#&gt; EXTENSION        489 5514.802813 5514.729968
#&gt; LO-REDUCTION     491 5514.797045 5514.729968
#&gt; LO-REDUCTION     493 5514.793959 5514.729968
#&gt; LO-REDUCTION     495 5514.789062 5514.729968
#&gt; LO-REDUCTION     497 5514.766824 5514.729968
#&gt; LO-REDUCTION     499 5514.761969 5514.729968
#&gt; LO-REDUCTION     501 5514.759440 5514.729968
#&gt; EXTENSION        503 5514.754148 5514.692336
#&gt; LO-REDUCTION     505 5514.745056 5514.692336
#&gt; LO-REDUCTION     507 5514.742938 5514.692336
#&gt; LO-REDUCTION     509 5514.738931 5514.692336
#&gt; LO-REDUCTION     511 5514.733428 5514.692336
#&gt; LO-REDUCTION     513 5514.729968 5514.692336
#&gt; REFLECTION       515 5514.725903 5514.689458
#&gt; EXTENSION        517 5514.707478 5514.635234
#&gt; LO-REDUCTION     519 5514.704308 5514.635234
#&gt; LO-REDUCTION     521 5514.696985 5514.635234
#&gt; LO-REDUCTION     523 5514.695447 5514.635234
#&gt; LO-REDUCTION     525 5514.692336 5514.635234
#&gt; EXTENSION        527 5514.689458 5514.625456
#&gt; EXTENSION        529 5514.658077 5514.563944
#&gt; LO-REDUCTION     531 5514.655722 5514.563944
#&gt; LO-REDUCTION     533 5514.645505 5514.563944
#&gt; LO-REDUCTION     535 5514.639075 5514.563944
#&gt; LO-REDUCTION     537 5514.635234 5514.563944
#&gt; REFLECTION       539 5514.625456 5514.560405
#&gt; EXTENSION        541 5514.582945 5514.515940
#&gt; LO-REDUCTION     543 5514.580553 5514.515940
#&gt; LO-REDUCTION     545 5514.574367 5514.515940
#&gt; REFLECTION       547 5514.566307 5514.514367
#&gt; LO-REDUCTION     549 5514.563944 5514.514367
#&gt; EXTENSION        551 5514.560405 5514.469813
#&gt; LO-REDUCTION     553 5514.533604 5514.469813
#&gt; LO-REDUCTION     555 5514.524382 5514.469813
#&gt; LO-REDUCTION     557 5514.518449 5514.469813
#&gt; LO-REDUCTION     559 5514.515940 5514.469813
#&gt; LO-REDUCTION     561 5514.514367 5514.469813
#&gt; REFLECTION       563 5514.501411 5514.459067
#&gt; REFLECTION       565 5514.495158 5514.453763
#&gt; EXTENSION        567 5514.480884 5514.438791
#&gt; LO-REDUCTION     569 5514.470767 5514.438791
#&gt; HI-REDUCTION     571 5514.470746 5514.438791
#&gt; EXTENSION        573 5514.469813 5514.415591
#&gt; LO-REDUCTION     575 5514.459067 5514.415591
#&gt; LO-REDUCTION     577 5514.455111 5514.415591
#&gt; LO-REDUCTION     579 5514.453763 5514.415591
#&gt; LO-REDUCTION     581 5514.449262 5514.415591
#&gt; REFLECTION       583 5514.438791 5514.412354
#&gt; EXTENSION        585 5514.434083 5514.408345
#&gt; LO-REDUCTION     587 5514.432744 5514.408345
#&gt; EXTENSION        589 5514.423121 5514.368142
#&gt; LO-REDUCTION     591 5514.419005 5514.368142
#&gt; LO-REDUCTION     593 5514.415591 5514.368142
#&gt; LO-REDUCTION     595 5514.412354 5514.368142
#&gt; LO-REDUCTION     597 5514.410443 5514.368142
#&gt; LO-REDUCTION     599 5514.408345 5514.368142
#&gt; EXTENSION        601 5514.394271 5514.339640
#&gt; LO-REDUCTION     603 5514.389360 5514.339640
#&gt; LO-REDUCTION     605 5514.383087 5514.339640
#&gt; EXTENSION        607 5514.381170 5514.332113
#&gt; EXTENSION        609 5514.380958 5514.325013
#&gt; EXTENSION        611 5514.368142 5514.289599
#&gt; EXTENSION        613 5514.346558 5514.245332
#&gt; LO-REDUCTION     615 5514.342483 5514.245332
#&gt; LO-REDUCTION     617 5514.339640 5514.245332
#&gt; LO-REDUCTION     619 5514.332113 5514.245332
#&gt; LO-REDUCTION     621 5514.325013 5514.245332
#&gt; LO-REDUCTION     623 5514.304460 5514.245332
#&gt; EXTENSION        625 5514.295290 5514.218112
#&gt; LO-REDUCTION     627 5514.289599 5514.218112
#&gt; LO-REDUCTION     629 5514.288883 5514.218112
#&gt; REFLECTION       631 5514.277998 5514.214222
#&gt; REFLECTION       633 5514.263210 5514.204797
#&gt; EXTENSION        635 5514.245332 5514.137763
#&gt; LO-REDUCTION     637 5514.234911 5514.137763
#&gt; LO-REDUCTION     639 5514.221338 5514.137763
#&gt; LO-REDUCTION     641 5514.218112 5514.137763
#&gt; LO-REDUCTION     643 5514.214222 5514.137763
#&gt; EXTENSION        645 5514.204797 5514.129708
#&gt; EXTENSION        647 5514.188123 5514.070795
#&gt; LO-REDUCTION     649 5514.162644 5514.070795
#&gt; EXTENSION        651 5514.162118 5514.039614
#&gt; LO-REDUCTION     653 5514.151618 5514.039614
#&gt; LO-REDUCTION     655 5514.137763 5514.039614
#&gt; LO-REDUCTION     657 5514.129708 5514.039614
#&gt; EXTENSION        659 5514.105948 5513.976589
#&gt; LO-REDUCTION     661 5514.079806 5513.976589
#&gt; EXTENSION        663 5514.070795 5513.955013
#&gt; LO-REDUCTION     665 5514.054162 5513.955013
#&gt; LO-REDUCTION     667 5514.050521 5513.955013
#&gt; EXTENSION        669 5514.039614 5513.916715
#&gt; LO-REDUCTION     671 5514.002684 5513.916715
#&gt; EXTENSION        673 5513.976589 5513.885293
#&gt; REFLECTION       675 5513.956854 5513.875884
#&gt; HI-REDUCTION     677 5513.955373 5513.875884
#&gt; LO-REDUCTION     679 5513.955013 5513.875884
#&gt; LO-REDUCTION     681 5513.920364 5513.875884
#&gt; REFLECTION       683 5513.916715 5513.865336
#&gt; REFLECTION       685 5513.906226 5513.854668
#&gt; HI-REDUCTION     687 5513.885293 5513.854668
#&gt; LO-REDUCTION     689 5513.878491 5513.854668
#&gt; HI-REDUCTION     691 5513.877152 5513.854668
#&gt; EXTENSION        693 5513.875884 5513.830084
#&gt; LO-REDUCTION     695 5513.871846 5513.830084
#&gt; LO-REDUCTION     697 5513.865336 5513.830084
#&gt; LO-REDUCTION     699 5513.864976 5513.830084
#&gt; LO-REDUCTION     701 5513.862189 5513.830084
#&gt; REFLECTION       703 5513.854668 5513.827888
#&gt; EXTENSION        705 5513.842016 5513.798779
#&gt; LO-REDUCTION     707 5513.840665 5513.798779
#&gt; LO-REDUCTION     709 5513.834586 5513.798779
#&gt; LO-REDUCTION     711 5513.830112 5513.798779
#&gt; EXTENSION        713 5513.830084 5513.776200
#&gt; EXTENSION        715 5513.827888 5513.755214
#&gt; LO-REDUCTION     717 5513.809747 5513.755214
#&gt; LO-REDUCTION     719 5513.803363 5513.755214
#&gt; EXTENSION        721 5513.801314 5513.749888
#&gt; LO-REDUCTION     723 5513.798779 5513.749693
#&gt; EXTENSION        725 5513.776200 5513.724009
#&gt; LO-REDUCTION     727 5513.773826 5513.724009
#&gt; REFLECTION       729 5513.764015 5513.722671
#&gt; LO-REDUCTION     731 5513.755214 5513.721300
#&gt; LO-REDUCTION     733 5513.749888 5513.721300
#&gt; LO-REDUCTION     735 5513.749693 5513.717878
#&gt; HI-REDUCTION     737 5513.730413 5513.717878
#&gt; LO-REDUCTION     739 5513.728236 5513.717878
#&gt; REFLECTION       741 5513.725595 5513.713702
#&gt; HI-REDUCTION     743 5513.724009 5513.713702
#&gt; LO-REDUCTION     745 5513.722671 5513.713702
#&gt; LO-REDUCTION     747 5513.721482 5513.713702
#&gt; LO-REDUCTION     749 5513.721300 5513.713702
#&gt; LO-REDUCTION     751 5513.718632 5513.713702
#&gt; REFLECTION       753 5513.718515 5513.713234
#&gt; LO-REDUCTION     755 5513.717878 5513.713234
#&gt; REFLECTION       757 5513.717366 5513.712182
#&gt; LO-REDUCTION     759 5513.715550 5513.712182
#&gt; LO-REDUCTION     761 5513.714557 5513.712182
#&gt; REFLECTION       763 5513.713793 5513.711374
#&gt; LO-REDUCTION     765 5513.713702 5513.711374
#&gt; EXTENSION        767 5513.713234 5513.708395
#&gt; LO-REDUCTION     769 5513.712781 5513.708395
#&gt; LO-REDUCTION     771 5513.712650 5513.708395
#&gt; LO-REDUCTION     773 5513.712384 5513.708395
#&gt; LO-REDUCTION     775 5513.712182 5513.708395
#&gt; EXTENSION        777 5513.711532 5513.706128
#&gt; LO-REDUCTION     779 5513.711374 5513.706128
#&gt; LO-REDUCTION     781 5513.710564 5513.706128
#&gt; EXTENSION        783 5513.709956 5513.703784
#&gt; EXTENSION        785 5513.709401 5513.699678
#&gt; LO-REDUCTION     787 5513.708395 5513.699678
#&gt; EXTENSION        789 5513.707360 5513.695863
#&gt; LO-REDUCTION     791 5513.706177 5513.695863
#&gt; LO-REDUCTION     793 5513.706128 5513.695863
#&gt; LO-REDUCTION     795 5513.703784 5513.695863
#&gt; EXTENSION        797 5513.703252 5513.689396
#&gt; EXTENSION        799 5513.699678 5513.679787
#&gt; LO-REDUCTION     801 5513.697542 5513.679787
#&gt; LO-REDUCTION     803 5513.697132 5513.679787
#&gt; LO-REDUCTION     805 5513.696101 5513.679787
#&gt; EXTENSION        807 5513.695863 5513.670520
#&gt; LO-REDUCTION     809 5513.689396 5513.670520
#&gt; EXTENSION        811 5513.687642 5513.663925
#&gt; EXTENSION        813 5513.684791 5513.647517
#&gt; LO-REDUCTION     815 5513.680744 5513.647517
#&gt; EXTENSION        817 5513.679787 5513.635412
#&gt; LO-REDUCTION     819 5513.671690 5513.635412
#&gt; EXTENSION        821 5513.670520 5513.626780
#&gt; EXTENSION        823 5513.663925 5513.621834
#&gt; EXTENSION        825 5513.649662 5513.594967
#&gt; LO-REDUCTION     827 5513.647517 5513.594967
#&gt; LO-REDUCTION     829 5513.641313 5513.594967
#&gt; LO-REDUCTION     831 5513.635412 5513.594967
#&gt; LO-REDUCTION     833 5513.626780 5513.594967
#&gt; LO-REDUCTION     835 5513.621834 5513.594967
#&gt; LO-REDUCTION     837 5513.612175 5513.594967
#&gt; EXTENSION        839 5513.611906 5513.585752
#&gt; LO-REDUCTION     841 5513.608071 5513.585752
#&gt; LO-REDUCTION     843 5513.606559 5513.585752
#&gt; EXTENSION        845 5513.605383 5513.570825
#&gt; EXTENSION        847 5513.602676 5513.560206
#&gt; LO-REDUCTION     849 5513.594967 5513.560206
#&gt; EXTENSION        851 5513.588614 5513.544544
#&gt; EXTENSION        853 5513.587335 5513.513961
#&gt; LO-REDUCTION     855 5513.585752 5513.513961
#&gt; EXTENSION        857 5513.570825 5513.458881
#&gt; LO-REDUCTION     859 5513.561371 5513.458881
#&gt; LO-REDUCTION     861 5513.560206 5513.458881
#&gt; EXTENSION        863 5513.544544 5513.399518
#&gt; LO-REDUCTION     865 5513.520051 5513.399518
#&gt; EXTENSION        867 5513.513961 5513.348690
#&gt; LO-REDUCTION     869 5513.499323 5513.348690
#&gt; EXTENSION        871 5513.476973 5513.272483
#&gt; EXTENSION        873 5513.458881 5513.161121
#&gt; LO-REDUCTION     875 5513.404324 5513.161121
#&gt; LO-REDUCTION     877 5513.399518 5513.161121
#&gt; EXTENSION        879 5513.361489 5513.122024
#&gt; EXTENSION        881 5513.348690 5512.981628
#&gt; LO-REDUCTION     883 5513.272483 5512.981628
#&gt; REFLECTION       885 5513.191790 5512.971738
#&gt; REFLECTION       887 5513.183856 5512.951610
#&gt; LO-REDUCTION     889 5513.161121 5512.951610
#&gt; LO-REDUCTION     891 5513.122024 5512.951610
#&gt; REFLECTION       893 5513.011446 5512.898801
#&gt; LO-REDUCTION     895 5512.987236 5512.898801
#&gt; LO-REDUCTION     897 5512.981628 5512.898801
#&gt; LO-REDUCTION     899 5512.976751 5512.898801
#&gt; EXTENSION        901 5512.971738 5512.819551
#&gt; LO-REDUCTION     903 5512.951610 5512.819551
#&gt; LO-REDUCTION     905 5512.942368 5512.819551
#&gt; LO-REDUCTION     907 5512.928563 5512.819551
#&gt; REFLECTION       909 5512.918164 5512.807058
#&gt; LO-REDUCTION     911 5512.898801 5512.807058
#&gt; EXTENSION        913 5512.863564 5512.720941
#&gt; LO-REDUCTION     915 5512.845748 5512.720941
#&gt; EXTENSION        917 5512.828190 5512.653020
#&gt; LO-REDUCTION     919 5512.819719 5512.653020
#&gt; LO-REDUCTION     921 5512.819551 5512.653020
#&gt; LO-REDUCTION     923 5512.807058 5512.653020
#&gt; REFLECTION       925 5512.764031 5512.646329
#&gt; REFLECTION       927 5512.720941 5512.620901
#&gt; EXTENSION        929 5512.719816 5512.575354
#&gt; EXTENSION        931 5512.689847 5512.494636
#&gt; LO-REDUCTION     933 5512.659925 5512.494636
#&gt; LO-REDUCTION     935 5512.653020 5512.494636
#&gt; LO-REDUCTION     937 5512.646329 5512.494636
#&gt; EXTENSION        939 5512.620901 5512.331497
#&gt; LO-REDUCTION     941 5512.575354 5512.331497
#&gt; LO-REDUCTION     943 5512.541191 5512.331497
#&gt; LO-REDUCTION     945 5512.518726 5512.331497
#&gt; LO-REDUCTION     947 5512.508843 5512.331497
#&gt; EXTENSION        949 5512.494636 5512.277266
#&gt; EXTENSION        951 5512.454148 5512.173314
#&gt; LO-REDUCTION     953 5512.401984 5512.173314
#&gt; EXTENSION        955 5512.399827 5512.084520
#&gt; EXTENSION        957 5512.359013 5511.972709
#&gt; LO-REDUCTION     959 5512.331497 5511.972709
#&gt; LO-REDUCTION     961 5512.277266 5511.972709
#&gt; EXTENSION        963 5512.203715 5511.821864
#&gt; LO-REDUCTION     965 5512.173314 5511.821864
#&gt; LO-REDUCTION     967 5512.103888 5511.821864
#&gt; EXTENSION        969 5512.084520 5511.733663
#&gt; LO-REDUCTION     971 5512.076363 5511.733663
#&gt; EXTENSION        973 5511.972709 5511.685839
#&gt; LO-REDUCTION     975 5511.969704 5511.685839
#&gt; EXTENSION        977 5511.848347 5511.470325
#&gt; LO-REDUCTION     979 5511.845283 5511.470325
#&gt; LO-REDUCTION     981 5511.821864 5511.470325
#&gt; LO-REDUCTION     983 5511.772778 5511.470325
#&gt; LO-REDUCTION     985 5511.733663 5511.470325
#&gt; LO-REDUCTION     987 5511.685839 5511.470325
#&gt; LO-REDUCTION     989 5511.662371 5511.470325
#&gt; EXTENSION        991 5511.626581 5511.395988
#&gt; EXTENSION        993 5511.560887 5511.251686
#&gt; LO-REDUCTION     995 5511.552683 5511.251686
#&gt; LO-REDUCTION     997 5511.476179 5511.251686
#&gt; LO-REDUCTION     999 5511.471362 5511.251686
#&gt; EXTENSION       1001 5511.470325 5511.167006
#&gt; LO-REDUCTION    1003 5511.395988 5511.167006
#&gt; LO-REDUCTION    1005 5511.338916 5511.167006
#&gt; EXTENSION       1007 5511.313179 5511.152113
#&gt; EXTENSION       1009 5511.263148 5511.063223
#&gt; LO-REDUCTION    1011 5511.257738 5511.063223
#&gt; LO-REDUCTION    1013 5511.251686 5511.063223
#&gt; LO-REDUCTION    1015 5511.203955 5511.063223
#&gt; REFLECTION      1017 5511.167006 5511.031004
#&gt; HI-REDUCTION    1019 5511.152113 5511.031004
#&gt; REFLECTION      1021 5511.106929 5511.018616
#&gt; EXTENSION       1023 5511.090819 5510.977846
#&gt; EXTENSION       1025 5511.089405 5510.958064
#&gt; EXTENSION       1027 5511.076467 5510.798443
#&gt; LO-REDUCTION    1029 5511.063223 5510.798443
#&gt; LO-REDUCTION    1031 5511.031004 5510.798443
#&gt; LO-REDUCTION    1033 5511.018616 5510.798443
#&gt; EXTENSION       1035 5510.977846 5510.728684
#&gt; LO-REDUCTION    1037 5510.958064 5510.728684
#&gt; EXTENSION       1039 5510.938966 5510.596111
#&gt; LO-REDUCTION    1041 5510.845166 5510.596111
#&gt; EXTENSION       1043 5510.807738 5510.528360
#&gt; EXTENSION       1045 5510.798443 5510.449758
#&gt; LO-REDUCTION    1047 5510.783144 5510.449758
#&gt; LO-REDUCTION    1049 5510.728684 5510.449758
#&gt; EXTENSION       1051 5510.604369 5510.096914
#&gt; LO-REDUCTION    1053 5510.596111 5510.096914
#&gt; LO-REDUCTION    1055 5510.528360 5510.096914
#&gt; LO-REDUCTION    1057 5510.486542 5510.096914
#&gt; LO-REDUCTION    1059 5510.461298 5510.096914
#&gt; LO-REDUCTION    1061 5510.449758 5510.096914
#&gt; REFLECTION      1063 5510.365186 5510.090192
#&gt; LO-REDUCTION    1065 5510.334768 5510.090192
#&gt; EXTENSION       1067 5510.333428 5510.004710
#&gt; EXTENSION       1069 5510.159026 5509.772725
#&gt; LO-REDUCTION    1071 5510.110846 5509.772725
#&gt; LO-REDUCTION    1073 5510.101768 5509.772725
#&gt; LO-REDUCTION    1075 5510.096914 5509.772725
#&gt; LO-REDUCTION    1077 5510.090192 5509.772725
#&gt; LO-REDUCTION    1079 5510.004710 5509.772725
#&gt; LO-REDUCTION    1081 5509.927031 5509.772725
#&gt; EXTENSION       1083 5509.912971 5509.587511
#&gt; LO-REDUCTION    1085 5509.858080 5509.587511
#&gt; EXTENSION       1087 5509.822392 5509.453258
#&gt; LO-REDUCTION    1089 5509.794723 5509.453258
#&gt; EXTENSION       1091 5509.794234 5509.316383
#&gt; LO-REDUCTION    1093 5509.772725 5509.316383
#&gt; EXTENSION       1095 5509.605011 5508.992826
#&gt; LO-REDUCTION    1097 5509.587511 5508.992826
#&gt; LO-REDUCTION    1099 5509.559530 5508.992826
#&gt; EXTENSION       1101 5509.453258 5508.507935
#&gt; LO-REDUCTION    1103 5509.348833 5508.507935
#&gt; LO-REDUCTION    1105 5509.316383 5508.507935
#&gt; EXTENSION       1107 5509.109853 5508.201128
#&gt; LO-REDUCTION    1109 5509.077878 5508.201128
#&gt; LO-REDUCTION    1111 5508.992826 5508.201128
#&gt; EXTENSION       1113 5508.838422 5507.745078
#&gt; LO-REDUCTION    1115 5508.709282 5507.745078
#&gt; EXTENSION       1117 5508.507935 5507.443108
#&gt; LO-REDUCTION    1119 5508.358899 5507.443108
#&gt; LO-REDUCTION    1121 5508.278756 5507.443108
#&gt; LO-REDUCTION    1123 5508.201128 5507.443108
#&gt; LO-REDUCTION    1125 5507.788700 5507.443108
#&gt; LO-REDUCTION    1127 5507.786351 5507.443108
#&gt; EXTENSION       1129 5507.745078 5507.327468
#&gt; LO-REDUCTION    1131 5507.563061 5507.327468
#&gt; LO-REDUCTION    1133 5507.524843 5507.327468
#&gt; EXTENSION       1135 5507.509728 5507.305096
#&gt; LO-REDUCTION    1137 5507.454497 5507.305096
#&gt; REFLECTION      1139 5507.443108 5507.291333
#&gt; HI-REDUCTION    1141 5507.437471 5507.291333
#&gt; EXTENSION       1143 5507.405737 5507.204985
#&gt; LO-REDUCTION    1145 5507.366727 5507.204985
#&gt; EXTENSION       1147 5507.335292 5507.181186
#&gt; HI-REDUCTION    1149 5507.327468 5507.181186
#&gt; LO-REDUCTION    1151 5507.305096 5507.181186
#&gt; REFLECTION      1153 5507.291333 5507.158763
#&gt; REFLECTION      1155 5507.243697 5507.135857
#&gt; HI-REDUCTION    1157 5507.232216 5507.135857
#&gt; LO-REDUCTION    1159 5507.208811 5507.135857
#&gt; LO-REDUCTION    1161 5507.204985 5507.135265
#&gt; LO-REDUCTION    1163 5507.182930 5507.135265
#&gt; HI-REDUCTION    1165 5507.181186 5507.135265
#&gt; REFLECTION      1167 5507.158763 5507.117548
#&gt; LO-REDUCTION    1169 5507.149848 5507.117548
#&gt; LO-REDUCTION    1171 5507.147103 5507.117548
#&gt; LO-REDUCTION    1173 5507.137067 5507.117548
#&gt; LO-REDUCTION    1175 5507.135857 5507.117548
#&gt; LO-REDUCTION    1177 5507.135265 5507.117548
#&gt; EXTENSION       1179 5507.125130 5507.109834
#&gt; EXTENSION       1181 5507.123415 5507.101627
#&gt; LO-REDUCTION    1183 5507.122760 5507.101627
#&gt; LO-REDUCTION    1185 5507.122371 5507.101627
#&gt; LO-REDUCTION    1187 5507.119083 5507.101627
#&gt; EXTENSION       1189 5507.117548 5507.084545
#&gt; LO-REDUCTION    1191 5507.109834 5507.084545
#&gt; LO-REDUCTION    1193 5507.106945 5507.084545
#&gt; LO-REDUCTION    1195 5507.105479 5507.084545
#&gt; LO-REDUCTION    1197 5507.101654 5507.084545
#&gt; EXTENSION       1199 5507.101627 5507.065095
#&gt; LO-REDUCTION    1201 5507.091231 5507.065095
#&gt; LO-REDUCTION    1203 5507.087942 5507.065095
#&gt; LO-REDUCTION    1205 5507.085514 5507.065095
#&gt; LO-REDUCTION    1207 5507.085030 5507.065095
#&gt; LO-REDUCTION    1209 5507.084545 5507.065095
#&gt; LO-REDUCTION    1211 5507.080205 5507.065095
#&gt; EXTENSION       1213 5507.078683 5507.048873
#&gt; LO-REDUCTION    1215 5507.069644 5507.048873
#&gt; LO-REDUCTION    1217 5507.067806 5507.048873
#&gt; LO-REDUCTION    1219 5507.066716 5507.048873
#&gt; LO-REDUCTION    1221 5507.065226 5507.048873
#&gt; LO-REDUCTION    1223 5507.065095 5507.048873
#&gt; REFLECTION      1225 5507.055018 5507.047206
#&gt; EXTENSION       1227 5507.054687 5507.044017
#&gt; EXTENSION       1229 5507.053825 5507.040729
#&gt; LO-REDUCTION    1231 5507.052658 5507.040729
#&gt; LO-REDUCTION    1233 5507.050515 5507.040729
#&gt; LO-REDUCTION    1235 5507.048873 5507.040729
#&gt; LO-REDUCTION    1237 5507.047206 5507.040729
#&gt; HI-REDUCTION    1239 5507.045667 5507.040729
#&gt; LO-REDUCTION    1241 5507.045022 5507.040729
#&gt; EXTENSION       1243 5507.044118 5507.037707
#&gt; LO-REDUCTION    1245 5507.044017 5507.037707
#&gt; REFLECTION      1247 5507.043741 5507.037680
#&gt; REFLECTION      1249 5507.041595 5507.036462
#&gt; EXTENSION       1251 5507.041566 5507.033337
#&gt; EXTENSION       1253 5507.040729 5507.030506
#&gt; LO-REDUCTION    1255 5507.038996 5507.030506
#&gt; LO-REDUCTION    1257 5507.037707 5507.030506
#&gt; EXTENSION       1259 5507.037680 5507.024697
#&gt; EXTENSION       1261 5507.036462 5507.021196
#&gt; EXTENSION       1263 5507.033337 5507.016161
#&gt; LO-REDUCTION    1265 5507.031952 5507.016161
#&gt; EXTENSION       1267 5507.031006 5507.009783
#&gt; LO-REDUCTION    1269 5507.030506 5507.009783
#&gt; EXTENSION       1271 5507.024697 5507.000062
#&gt; LO-REDUCTION    1273 5507.021196 5507.000062
#&gt; LO-REDUCTION    1275 5507.020403 5507.000062
#&gt; LO-REDUCTION    1277 5507.016161 5507.000062
#&gt; LO-REDUCTION    1279 5507.013791 5507.000062
#&gt; REFLECTION      1281 5507.010608 5506.999625
#&gt; EXTENSION       1283 5507.009783 5506.994243
#&gt; LO-REDUCTION    1285 5507.005248 5506.994243
#&gt; EXTENSION       1287 5507.003941 5506.992959
#&gt; REFLECTION      1289 5507.000363 5506.992129
#&gt; HI-REDUCTION    1291 5507.000062 5506.992129
#&gt; REFLECTION      1293 5506.999625 5506.990813
#&gt; EXTENSION       1295 5506.996507 5506.986072
#&gt; LO-REDUCTION    1297 5506.995276 5506.986072
#&gt; LO-REDUCTION    1299 5506.994243 5506.986072
#&gt; LO-REDUCTION    1301 5506.992959 5506.986072
#&gt; LO-REDUCTION    1303 5506.992129 5506.986072
#&gt; LO-REDUCTION    1305 5506.990813 5506.986072
#&gt; LO-REDUCTION    1307 5506.990020 5506.986072
#&gt; EXTENSION       1309 5506.988542 5506.982099
#&gt; LO-REDUCTION    1311 5506.988505 5506.982099
#&gt; LO-REDUCTION    1313 5506.987968 5506.982099
#&gt; LO-REDUCTION    1315 5506.987858 5506.982099
#&gt; LO-REDUCTION    1317 5506.986902 5506.982099
#&gt; LO-REDUCTION    1319 5506.986072 5506.982099
#&gt; EXTENSION       1321 5506.985325 5506.980963
#&gt; EXTENSION       1323 5506.985147 5506.980574
#&gt; EXTENSION       1325 5506.984755 5506.977761
#&gt; LO-REDUCTION    1327 5506.982372 5506.977761
#&gt; LO-REDUCTION    1329 5506.982349 5506.977761
#&gt; LO-REDUCTION    1331 5506.982099 5506.977761
#&gt; LO-REDUCTION    1333 5506.980963 5506.977761
#&gt; LO-REDUCTION    1335 5506.980574 5506.977761
#&gt; HI-REDUCTION    1337 5506.978918 5506.977761
#&gt; LO-REDUCTION    1339 5506.978756 5506.977761
#&gt; LO-REDUCTION    1341 5506.978656 5506.977761
#&gt; LO-REDUCTION    1343 5506.978646 5506.977761
#&gt; REFLECTION      1345 5506.978406 5506.977647
#&gt; LO-REDUCTION    1347 5506.978285 5506.977647
#&gt; REFLECTION      1349 5506.978155 5506.977544
#&gt; REFLECTION      1351 5506.978010 5506.977463
#&gt; REFLECTION      1353 5506.977959 5506.977461
#&gt; LO-REDUCTION    1355 5506.977863 5506.977461
#&gt; REFLECTION      1357 5506.977761 5506.977266
#&gt; LO-REDUCTION    1359 5506.977647 5506.977266
#&gt; HI-REDUCTION    1361 5506.977544 5506.977266
#&gt; LO-REDUCTION    1363 5506.977541 5506.977266
#&gt; LO-REDUCTION    1365 5506.977463 5506.977266
#&gt; LO-REDUCTION    1367 5506.977461 5506.977266
#&gt; LO-REDUCTION    1369 5506.977433 5506.977266
#&gt; REFLECTION      1371 5506.977322 5506.977210
#&gt; HI-REDUCTION    1373 5506.977317 5506.977210
#&gt; LO-REDUCTION    1375 5506.977309 5506.977210
#&gt; LO-REDUCTION    1377 5506.977309 5506.977210
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1379 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0089707   1.5098705  -3.0111892  -0.9564737  -0.8279869   0.2933689 
#&gt; 
#&gt; $value
#&gt; [1] 5506.977
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1379 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      1.16 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |======================================================================| 100%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6215.170738
#&gt;   Scaled convergence tolerance is 9.26133e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11685.848766 5784.578888
#&gt; LO-REDUCTION       9 7879.473045 5784.578888
#&gt; LO-REDUCTION      11 7833.899590 5784.578888
#&gt; REFLECTION        13 7070.083531 5761.354662
#&gt; LO-REDUCTION      15 6763.699677 5761.354662
#&gt; LO-REDUCTION      17 6463.608813 5761.354662
#&gt; REFLECTION        19 6445.079554 5750.430984
#&gt; REFLECTION        21 6215.170738 5535.918858
#&gt; REFLECTION        23 5975.198418 5535.229174
#&gt; LO-REDUCTION      25 5956.281639 5535.229174
#&gt; LO-REDUCTION      27 5784.578888 5535.229174
#&gt; HI-REDUCTION      29 5761.354662 5535.229174
#&gt; LO-REDUCTION      31 5750.430984 5535.229174
#&gt; LO-REDUCTION      33 5623.779297 5534.845380
#&gt; LO-REDUCTION      35 5617.036540 5534.845380
#&gt; LO-REDUCTION      37 5570.558579 5533.778030
#&gt; LO-REDUCTION      39 5569.457560 5533.778030
#&gt; LO-REDUCTION      41 5537.278780 5533.778030
#&gt; LO-REDUCTION      43 5537.009799 5529.741057
#&gt; HI-REDUCTION      45 5535.918858 5529.741057
#&gt; HI-REDUCTION      47 5535.588367 5528.169520
#&gt; HI-REDUCTION      49 5535.229174 5528.169520
#&gt; REFLECTION        51 5534.845380 5525.847368
#&gt; HI-REDUCTION      53 5533.778030 5525.847368
#&gt; LO-REDUCTION      55 5529.937985 5525.847368
#&gt; LO-REDUCTION      57 5529.741057 5525.847368
#&gt; REFLECTION        59 5529.018714 5525.451752
#&gt; LO-REDUCTION      61 5528.358933 5525.451752
#&gt; LO-REDUCTION      63 5528.169520 5525.451752
#&gt; HI-REDUCTION      65 5528.114980 5525.451752
#&gt; LO-REDUCTION      67 5527.018739 5525.451752
#&gt; REFLECTION        69 5526.009505 5524.493921
#&gt; LO-REDUCTION      71 5525.847368 5524.493921
#&gt; LO-REDUCTION      73 5525.800408 5524.493921
#&gt; EXTENSION         75 5525.635981 5523.009716
#&gt; LO-REDUCTION      77 5525.504940 5523.009716
#&gt; LO-REDUCTION      79 5525.451752 5523.009716
#&gt; LO-REDUCTION      81 5524.837487 5523.009716
#&gt; EXTENSION         83 5524.789748 5522.912687
#&gt; REFLECTION        85 5524.518451 5522.521204
#&gt; EXTENSION         87 5524.493921 5521.251323
#&gt; LO-REDUCTION      89 5523.715569 5521.251323
#&gt; LO-REDUCTION      91 5523.417614 5521.251323
#&gt; REFLECTION        93 5523.009716 5521.045920
#&gt; REFLECTION        95 5522.912687 5520.814960
#&gt; LO-REDUCTION      97 5522.521204 5520.793620
#&gt; REFLECTION        99 5521.653281 5520.054718
#&gt; LO-REDUCTION     101 5521.386208 5520.054718
#&gt; LO-REDUCTION     103 5521.251323 5520.054718
#&gt; LO-REDUCTION     105 5521.045920 5520.054718
#&gt; EXTENSION        107 5520.814960 5519.879008
#&gt; LO-REDUCTION     109 5520.793620 5519.879008
#&gt; LO-REDUCTION     111 5520.631543 5519.879008
#&gt; LO-REDUCTION     113 5520.469409 5519.879008
#&gt; LO-REDUCTION     115 5520.377866 5519.836683
#&gt; LO-REDUCTION     117 5520.085533 5519.788785
#&gt; REFLECTION       119 5520.054718 5519.775877
#&gt; LO-REDUCTION     121 5520.001131 5519.775877
#&gt; HI-REDUCTION     123 5519.926840 5519.775877
#&gt; REFLECTION       125 5519.879008 5519.761698
#&gt; LO-REDUCTION     127 5519.836683 5519.761528
#&gt; LO-REDUCTION     129 5519.814571 5519.741063
#&gt; LO-REDUCTION     131 5519.793475 5519.726648
#&gt; REFLECTION       133 5519.788785 5519.717551
#&gt; HI-REDUCTION     135 5519.775877 5519.717551
#&gt; LO-REDUCTION     137 5519.761698 5519.713104
#&gt; HI-REDUCTION     139 5519.761528 5519.713104
#&gt; LO-REDUCTION     141 5519.741063 5519.706065
#&gt; LO-REDUCTION     143 5519.729036 5519.702874
#&gt; LO-REDUCTION     145 5519.726648 5519.698551
#&gt; REFLECTION       147 5519.717551 5519.696380
#&gt; HI-REDUCTION     149 5519.714170 5519.696380
#&gt; LO-REDUCTION     151 5519.713104 5519.694722
#&gt; REFLECTION       153 5519.706065 5519.688062
#&gt; HI-REDUCTION     155 5519.702874 5519.688062
#&gt; REFLECTION       157 5519.698551 5519.687693
#&gt; LO-REDUCTION     159 5519.696894 5519.687693
#&gt; EXTENSION        161 5519.696380 5519.673575
#&gt; HI-REDUCTION     163 5519.694722 5519.673575
#&gt; LO-REDUCTION     165 5519.694090 5519.673575
#&gt; LO-REDUCTION     167 5519.689905 5519.673575
#&gt; LO-REDUCTION     169 5519.688062 5519.673575
#&gt; LO-REDUCTION     171 5519.687693 5519.673575
#&gt; EXTENSION        173 5519.686863 5519.668281
#&gt; REFLECTION       175 5519.678961 5519.666795
#&gt; LO-REDUCTION     177 5519.677362 5519.666795
#&gt; LO-REDUCTION     179 5519.677241 5519.666795
#&gt; REFLECTION       181 5519.676346 5519.664487
#&gt; LO-REDUCTION     183 5519.673575 5519.664487
#&gt; EXTENSION        185 5519.670407 5519.661252
#&gt; EXTENSION        187 5519.669049 5519.660046
#&gt; EXTENSION        189 5519.668281 5519.653119
#&gt; LO-REDUCTION     191 5519.666953 5519.653119
#&gt; EXTENSION        193 5519.666795 5519.642192
#&gt; LO-REDUCTION     195 5519.664487 5519.642192
#&gt; LO-REDUCTION     197 5519.661252 5519.642192
#&gt; LO-REDUCTION     199 5519.660046 5519.642192
#&gt; LO-REDUCTION     201 5519.655248 5519.642192
#&gt; LO-REDUCTION     203 5519.653713 5519.642192
#&gt; LO-REDUCTION     205 5519.653119 5519.642192
#&gt; REFLECTION       207 5519.652867 5519.639706
#&gt; EXTENSION        209 5519.646695 5519.621322
#&gt; LO-REDUCTION     211 5519.643135 5519.621322
#&gt; LO-REDUCTION     213 5519.642731 5519.621322
#&gt; LO-REDUCTION     215 5519.642457 5519.621322
#&gt; LO-REDUCTION     217 5519.642192 5519.621322
#&gt; LO-REDUCTION     219 5519.639706 5519.621322
#&gt; EXTENSION        221 5519.635476 5519.609352
#&gt; LO-REDUCTION     223 5519.635309 5519.609352
#&gt; LO-REDUCTION     225 5519.630197 5519.609352
#&gt; LO-REDUCTION     227 5519.627613 5519.609352
#&gt; EXTENSION        229 5519.623902 5519.593159
#&gt; LO-REDUCTION     231 5519.621322 5519.593159
#&gt; LO-REDUCTION     233 5519.615747 5519.593159
#&gt; LO-REDUCTION     235 5519.610472 5519.593159
#&gt; REFLECTION       237 5519.609480 5519.592238
#&gt; EXTENSION        239 5519.609352 5519.573262
#&gt; LO-REDUCTION     241 5519.599765 5519.573262
#&gt; LO-REDUCTION     243 5519.595041 5519.573262
#&gt; LO-REDUCTION     245 5519.594589 5519.573262
#&gt; EXTENSION        247 5519.593159 5519.565949
#&gt; LO-REDUCTION     249 5519.592238 5519.565949
#&gt; EXTENSION        251 5519.585795 5519.557656
#&gt; LO-REDUCTION     253 5519.582771 5519.557656
#&gt; EXTENSION        255 5519.580902 5519.544374
#&gt; LO-REDUCTION     257 5519.575976 5519.544374
#&gt; EXTENSION        259 5519.573262 5519.530772
#&gt; LO-REDUCTION     261 5519.565949 5519.530772
#&gt; LO-REDUCTION     263 5519.560592 5519.530772
#&gt; LO-REDUCTION     265 5519.557656 5519.530772
#&gt; EXTENSION        267 5519.547635 5519.514223
#&gt; LO-REDUCTION     269 5519.544749 5519.514223
#&gt; LO-REDUCTION     271 5519.544374 5519.514223
#&gt; LO-REDUCTION     273 5519.537279 5519.514223
#&gt; EXTENSION        275 5519.535266 5519.505071
#&gt; LO-REDUCTION     277 5519.530772 5519.505071
#&gt; LO-REDUCTION     279 5519.528104 5519.505071
#&gt; REFLECTION       281 5519.523386 5519.504435
#&gt; EXTENSION        283 5519.517586 5519.499038
#&gt; LO-REDUCTION     285 5519.514223 5519.499038
#&gt; LO-REDUCTION     287 5519.511853 5519.499038
#&gt; REFLECTION       289 5519.511497 5519.498703
#&gt; REFLECTION       291 5519.505114 5519.496940
#&gt; EXTENSION        293 5519.505071 5519.489283
#&gt; LO-REDUCTION     295 5519.504435 5519.489283
#&gt; LO-REDUCTION     297 5519.501907 5519.489283
#&gt; LO-REDUCTION     299 5519.499038 5519.489283
#&gt; LO-REDUCTION     301 5519.498703 5519.489283
#&gt; LO-REDUCTION     303 5519.496940 5519.489283
#&gt; LO-REDUCTION     305 5519.496916 5519.489283
#&gt; EXTENSION        307 5519.494954 5519.484276
#&gt; LO-REDUCTION     309 5519.492576 5519.484276
#&gt; LO-REDUCTION     311 5519.492396 5519.484276
#&gt; EXTENSION        313 5519.491737 5519.481328
#&gt; LO-REDUCTION     315 5519.491459 5519.481328
#&gt; EXTENSION        317 5519.489283 5519.477105
#&gt; LO-REDUCTION     319 5519.486473 5519.477105
#&gt; LO-REDUCTION     321 5519.485797 5519.477105
#&gt; LO-REDUCTION     323 5519.484459 5519.477105
#&gt; EXTENSION        325 5519.484276 5519.471717
#&gt; LO-REDUCTION     327 5519.481328 5519.471717
#&gt; LO-REDUCTION     329 5519.479403 5519.471717
#&gt; LO-REDUCTION     331 5519.479086 5519.471717
#&gt; LO-REDUCTION     333 5519.477584 5519.471717
#&gt; LO-REDUCTION     335 5519.477105 5519.471717
#&gt; LO-REDUCTION     337 5519.476288 5519.471717
#&gt; EXTENSION        339 5519.475977 5519.470338
#&gt; LO-REDUCTION     341 5519.475251 5519.470338
#&gt; EXTENSION        343 5519.474492 5519.468879
#&gt; REFLECTION       345 5519.473613 5519.468612
#&gt; EXTENSION        347 5519.472902 5519.463419
#&gt; LO-REDUCTION     349 5519.471717 5519.463419
#&gt; LO-REDUCTION     351 5519.471204 5519.463419
#&gt; EXTENSION        353 5519.470338 5519.458616
#&gt; LO-REDUCTION     355 5519.468879 5519.458616
#&gt; LO-REDUCTION     357 5519.468612 5519.458616
#&gt; LO-REDUCTION     359 5519.466060 5519.458616
#&gt; EXTENSION        361 5519.464586 5519.454064
#&gt; LO-REDUCTION     363 5519.463419 5519.454064
#&gt; LO-REDUCTION     365 5519.463080 5519.454064
#&gt; LO-REDUCTION     367 5519.461636 5519.454064
#&gt; REFLECTION       369 5519.459312 5519.453836
#&gt; REFLECTION       371 5519.458616 5519.453201
#&gt; REFLECTION       373 5519.455976 5519.452229
#&gt; EXTENSION        375 5519.455402 5519.450175
#&gt; LO-REDUCTION     377 5519.454321 5519.450175
#&gt; LO-REDUCTION     379 5519.454064 5519.450175
#&gt; LO-REDUCTION     381 5519.453836 5519.450175
#&gt; LO-REDUCTION     383 5519.453201 5519.450175
#&gt; LO-REDUCTION     385 5519.452229 5519.450175
#&gt; EXTENSION        387 5519.451160 5519.449029
#&gt; EXTENSION        389 5519.451042 5519.448378
#&gt; EXTENSION        391 5519.450722 5519.447844
#&gt; LO-REDUCTION     393 5519.450695 5519.447844
#&gt; EXTENSION        395 5519.450490 5519.446375
#&gt; LO-REDUCTION     397 5519.450175 5519.446375
#&gt; LO-REDUCTION     399 5519.449029 5519.446375
#&gt; LO-REDUCTION     401 5519.448819 5519.446375
#&gt; EXTENSION        403 5519.448378 5519.445975
#&gt; LO-REDUCTION     405 5519.447844 5519.445975
#&gt; LO-REDUCTION     407 5519.447690 5519.445975
#&gt; EXTENSION        409 5519.447127 5519.445108
#&gt; LO-REDUCTION     411 5519.446480 5519.445108
#&gt; LO-REDUCTION     413 5519.446375 5519.445108
#&gt; LO-REDUCTION     415 5519.446212 5519.445108
#&gt; REFLECTION       417 5519.446112 5519.445008
#&gt; HI-REDUCTION     419 5519.445975 5519.445008
#&gt; REFLECTION       421 5519.445555 5519.444763
#&gt; REFLECTION       423 5519.445507 5519.444756
#&gt; EXTENSION        425 5519.445439 5519.444213
#&gt; LO-REDUCTION     427 5519.445372 5519.444213
#&gt; LO-REDUCTION     429 5519.445108 5519.444213
#&gt; EXTENSION        431 5519.445008 5519.443880
#&gt; LO-REDUCTION     433 5519.444763 5519.443880
#&gt; EXTENSION        435 5519.444756 5519.443664
#&gt; EXTENSION        437 5519.444573 5519.443428
#&gt; REFLECTION       439 5519.444241 5519.443259
#&gt; LO-REDUCTION     441 5519.444213 5519.443259
#&gt; REFLECTION       443 5519.444087 5519.443245
#&gt; REFLECTION       445 5519.443880 5519.443173
#&gt; LO-REDUCTION     447 5519.443664 5519.443095
#&gt; LO-REDUCTION     449 5519.443428 5519.443095
#&gt; HI-REDUCTION     451 5519.443318 5519.443095
#&gt; LO-REDUCTION     453 5519.443259 5519.443051
#&gt; HI-REDUCTION     455 5519.443245 5519.443051
#&gt; LO-REDUCTION     457 5519.443173 5519.443017
#&gt; HI-REDUCTION     459 5519.443117 5519.443017
#&gt; HI-REDUCTION     461 5519.443117 5519.443017
#&gt; Exiting from Nelder Mead minimizer
#&gt;     463 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0614925   1.4902238  -3.0092588  -0.9795222  -0.5812197   0.3231082 
#&gt; 
#&gt; $value
#&gt; [1] 5519.443
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      463 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.392 
#&gt; 
#&gt; Assemble the answers
#&gt; </div><div class='input'>
<span class='co'># use method L-BFGS-B instead of Nelder-Mead and print report every 50 iterations</span>
 <span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                            <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"L-BFGS-B"</span>,
                                               <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>REPORT</span><span class='kw'>=</span><span class='fl'>50</span>)),
                            <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 32
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.120456
#&gt; final function value 5472.96
#&gt; 
#&gt; final  value 5472.961311 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0357392   1.4920300  -3.0020515  -0.9571233  -0.6439850   0.3010139 
#&gt; 
#&gt; $value
#&gt; [1] 5472.961
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       32 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       32 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.324 
#&gt; 
#&gt; Assemble the answers</div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 28
#&gt; function evaluations 34
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.00462363
#&gt; final function value 5473.46
#&gt; 
#&gt; final  value 5473.462836 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0731093   1.4913288  -3.0099144  -0.9500778  -0.5953297   0.3030915 
#&gt; 
#&gt; $value
#&gt; [1] 5473.463
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       34 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       34 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.348 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==============                                                        |  20%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 28
#&gt; function evaluations 33
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0612692
#&gt; final function value 5450.43
#&gt; 
#&gt; final  value 5450.427936 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9606173   1.5095946  -2.9940229  -0.9653955  -0.4511782   0.3020235 
#&gt; 
#&gt; $value
#&gt; [1] 5450.428
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       33 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       33 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.336 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=====================                                                 |  30%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 22
#&gt; function evaluations 28
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.469583
#&gt; final function value 5493.55
#&gt; 
#&gt; final  value 5493.550348 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9881538   1.5030700  -3.0070534  -0.9659097  -0.6483936   0.3086602 
#&gt; 
#&gt; $value
#&gt; [1] 5493.55
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       28 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       28 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.288 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |============================                                          |  40%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 31
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.175097
#&gt; final function value 5526.25
#&gt; 
#&gt; final  value 5526.248185 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.1085637   1.4805549  -3.0072809  -0.9653451  -0.5857109   0.3248862 
#&gt; 
#&gt; $value
#&gt; [1] 5526.248
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       31 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       31 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.316 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===================================                                   |  50%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 24
#&gt; function evaluations 29
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.11768
#&gt; final function value 5485.98
#&gt; 
#&gt; final  value 5485.980134 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0464405   1.4829503  -2.9937814  -0.9718872  -0.4428655   0.3109413 
#&gt; 
#&gt; $value
#&gt; [1] 5485.98
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       29 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       29 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.296 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==========================================                            |  60%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 32
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0128927
#&gt; final function value 5498.78
#&gt; 
#&gt; final  value 5498.781614 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9421760   1.5015355  -2.9873331  -0.9480472  -0.7343086   0.3072647 
#&gt; 
#&gt; $value
#&gt; [1] 5498.782
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       32 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       32 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.332 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=================================================                     |  70%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 26
#&gt; function evaluations 31
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.139709
#&gt; final function value 5438.85
#&gt; 
#&gt; final  value 5438.846053 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0377315   1.4836788  -2.9934377  -0.9475450  -0.6444932   0.2875233 
#&gt; 
#&gt; $value
#&gt; [1] 5438.846
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       31 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       31 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.32 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |========================================================              |  80%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 29
#&gt; function evaluations 34
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.267603
#&gt; final function value 5462.12
#&gt; 
#&gt; final  value 5462.118656 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0859584   1.4890582  -2.9968629  -0.9440391  -0.8517738   0.2812046 
#&gt; 
#&gt; $value
#&gt; [1] 5462.119
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       34 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       34 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.348 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===============================================================       |  90%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 28
#&gt; function evaluations 34
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0781317
#&gt; final function value 5459
#&gt; 
#&gt; final  value 5458.999460 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0258269   1.4804376  -2.9788649  -0.9635785  -0.6244057   0.2963759 
#&gt; 
#&gt; $value
#&gt; [1] 5458.999
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       34 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       34 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.348 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |======================================================================| 100%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function(params, vec.y, m.data.exo.endo, vec.data.endo.pstar){
#&gt; 
#&gt;   # Extract params from optimx inputs --------------------------------------------------------
#&gt;   params.endo.exo &lt;- params[setdiff(names(params), c("sigma", "rho"))]
#&gt;   sigma           &lt;- params["sigma"]
#&gt;   rho             &lt;- params["rho"]
#&gt; 
#&gt;   # Constrain rho to [0,1] and sigma to [0, +Inf]
#&gt;   #   (incl bound because can be very large which flips to 0 and 1)
#&gt;   #   The vcov is not derived from the hessian anymore, but BFGS still does not accept
#&gt;   #     NA/Inf
#&gt;   rho &lt;- exp(rho)
#&gt;   rho &lt;- rho / (1+rho)
#&gt; 
#&gt;   sigma &lt;- exp(sigma)
#&gt; 
#&gt;   # epsilon, incl. endo regressor ------------------------------------------------------------
#&gt; 
#&gt;   # Reorder params to fit matrix col order
#&gt;   params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt; 
#&gt;   eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt; 
#&gt;   # PPnorm -----------------------------------------------------------------------------------
#&gt;   # residulas - epsilon should be normally distributed
#&gt;   ppnorm &lt;- pnorm(eps.1, mean=0, sd=sigma)
#&gt;   ppnorm[ppnorm &gt;= 0.999998]   &lt;- 0.999998
#&gt;   ppnorm[ppnorm &lt;= 0.0001]     &lt;- 0.0001
#&gt; 
#&gt;   # epsilon star -----------------------------------------------------------------------------
#&gt;   eps.star &lt;- stats::qnorm(ppnorm)
#&gt; 
#&gt;   # l.eps ------------------------------------------------------------------------------------
#&gt;   # l.eps &lt;- sum(log(dnorm(eps.1,mean=0,sd=sigma)))
#&gt;   l.eps &lt;- sum(dnorm(eps.1,mean=0,sd=sigma, log = TRUE))
#&gt; 
#&gt;   # s
#&gt;   s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2*(1-rho^2)) -
#&gt;              (rho*vec.data.endo.pstar*eps.star)/(1-rho^2))
#&gt;   # mm
#&gt;   mm &lt;- (length(vec.y)/2)* log(1-rho^2)
#&gt;   # LL
#&gt;   log.LL &lt;- -mm - s + l.eps
#&gt;   return(-1 * log.LL)
#&gt; 
#&gt; }
#&gt; &lt;bytecode: 0x102f5a50&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 28
#&gt; function evaluations 33
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0120737
#&gt; final function value 5494.03
#&gt; 
#&gt; final  value 5494.025823 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0062738   1.4969426  -3.0068112  -0.9538850  -0.6389391   0.3067347 
#&gt; 
#&gt; $value
#&gt; [1] 5494.026
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       33 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       33 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;     0.344 
#&gt; 
#&gt; Assemble the answers
#&gt; </div><div class='input'>
<span class='co'># For coef(), the parameter "complete" determines if only the</span>
<span class='co'># main model parameters or also the auxiliary coefficients are returned</span>

<span class='no'>c1.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>) <span class='co'># also returns rho and sigma</span>
<span class='co'># same as above</span>
<span class='no'>c1.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># only main model coefs</span>
<span class='no'>c1.main.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>


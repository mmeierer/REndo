<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection • REndo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection" />
<meta property="og:description" content="Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/REndo-introduction.html">REndo: A Package to Address Endogeneity Without External Instrumental Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mmeierer/REndo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models Endogenous Regressors using Gaussian Copula</h1>
    <small class="dont-index">Source: <a href='https://github.com/mmeierer/REndo/blob/master/R/f_copulacorrection_interface.R'><code>R/f_copulacorrection_interface.R</code></a></small>
    <div class="hidden name"><code>copulaCorrection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution.</p>
    </div>

    <pre class="usage"><span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, num.boots <span class='op'>=</span> <span class='fl'>1000</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fitted. See the "Details" section for the exact notation.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the data of all parts specified in the formula parameter.</p></td>
    </tr>
    <tr>
      <th>num.boots</th>
      <td><p>Number of bootstrapping iterations. Defaults to 1000.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments for the log-likelihood optimization function in the case of a single continuous endogenous
 regressor. Ignored with a warning otherwise.</p><dl>
<dt>start.params</dt><dd><p>A named vector containing a set of parameters to use in the first optimization iteration.
The names have to correspond exactly to the names of the components specified in the <code>formula</code> parameter.
If not provided, a linear model is fitted to derive them.</p></dd>
<dt>optimx.args</dt><dd><p>A named list of arguments which are passed to <code><a href='https://rdrr.io/pkg/optimx/man/optimx.html'>optimx</a></code>. This allows users to tweak optimization settings to their liking.</p></dd>

</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For all cases, an object of classes <code>rendo.copula.correction</code>, <code>rendo.boots</code>, and <code>rendo.base</code> is returned
which is a list and contains the following components:</p>
<dt>formula</dt><dd><p>The formula given to specify the fitted model.</p></dd>
<dt>terms</dt><dd><p>The terms object used for model fitting.</p></dd>
<dt>model</dt><dd><p>The model.frame used for model fitting.</p></dd>
<dt>coefficients</dt><dd><p>A named vector of all coefficients resulting from model fitting.</p></dd>
<dt>names.main.coefs</dt><dd><p>a vector specifying which coefficients are from the model. For internal usage.</p></dd>
<dt>names.vars.continuous</dt><dd><p>The names of the continuous endogenous regressors.</p></dd>
<dt>names.vars.discrete</dt><dd><p>The names of the discrete endogenous regressors.</p></dd>
<dt>fitted.values</dt><dd><p>Fitted values at the found solution.</p></dd>
<dt>residuals</dt><dd><p>The residuals at the found solution.</p></dd>
<dt>boots.params</dt><dd><p>The bootstrapped coefficients.</p></dd>

For the case of a single continuous endogenous regressor, the returned object further
contains the following components:
<dt>start.params</dt><dd><p>A named vector with the initial set of parameters used to optimize the log-likelihood function.</p></dd>
<dt>res.optimx</dt><dd><p>The result object returned by the function <code>optimx</code> after optimizing the log-likelihood function.</p></dd>

For all other cases, the returned object further contains the following component:
<dt>res.lm.real.data</dt><dd><p>The linear model fitted on the original data together with generated p.star data.</p></dd>

The function summary can be used to obtain and print a summary of the results.
Depending on the returned object, the generic accessor functions coefficients, fitted.values,
residuals, vcov, logLik, AIC, BIC, and nobs are available.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method</h3>


<p>The underlying idea of the joint estimation method is that using information contained in the observed data,
one selects marginal distributions for the endogenous regressor and the structural error term, respectively.
Then, the copula model enables the construction of a flexible multivariate joint distribution allowing a wide range
of correlations between the two marginals.</p>

<p>Consider the model:
<br><center>Y<sub>t</sub>=&beta;<sub>0</sub>+&beta;<sub>1</sub>P<sub>t</sub>+&beta;<sub>2</sub>X<sub>t</sub>+&epsilon;<sub>t</sub></center></p>
<p>where \(t=1,..,T\) indexes either time or cross-sectional units, Y<sub>t</sub> is a \(1x1\) response variable,
X<sub>t</sub> is a \(kxn\) exogenous regressor,
P<sub>t</sub> is a \(kx1\) continuous endogenous regressor,
&epsilon;<sub>t</sub> is a normally distributed structural error term with mean zero and
E(&epsilon;<sup>2</sup>)=&sigma;<sub>&epsilon;</sub><sup>2</sup>,
\(\alpha\) and \(\beta\) are model parameters.</p>
<p>The marginal distribution of the endogenous regressor P<sub>t</sub> is obtained using the Epanechnikov
kernel density estimator (Epanechnikov, 1969), as below:
<br><center>h&#770;(p)=1/(T&#183;b) &sum;(K&#183;((p-P<sub>t</sub>)/b))</center></p>
<p>where P<sub>t</sub> is the endogenous regressor,
K(x)=0.75&#183;(1-x<sup>2</sup>)&#183;I(|x|<=1)
and the bandwidth \(b\) is the one proposed by Silverman (1986),
and is equal to b=0.9&#183;T<sup>-1.5</sup>&#183;min(s, IQR/1.34).
\(IQR\) is the interquartile range while \(s\) is the data sample standard deviation
and \(T\) is the number of time periods observed in the data.
After obtaining the joint distribution of the error term and the continuous endogenous regressor, the model parameters are estimated using
maximum likelihood estimation.</p>
<p>The additional parameters used during model fitting and printed in <code>summary</code> hence are:</p><dl>
<dt><code>rho</code></dt><dd><p>The correlation between the endogenous regressor and the error.</p></dd>
<dt><code>sigma</code></dt><dd><p>The variance of the model's error.</p></dd>

</dl>


<p>With more than one continuous endogenous regressor or an endogenous discrete regressor, an alternative approach to the
estimation using Gaussian copula should be applied. This approach is similar to the control function approach (Petrin and Train, 2010).
The core idea is to apply OLS estimation on the original set of explanatory variables in the model equation above, plus an additional regressor
P<sub>t</sub>&#42;=&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
Here, H(P<sub>t</sub>) is the marginal distribution of the endogenous regressor \(P\).
Including this regressor solves the correlation between the endogenous regressor and the structural error, \(\epsilon\),
OLS providing consistent parameter estimates. Due to identification problems, the discrete endogenous regressor cannot have a binomial
distribution.</p>
<p>Hence, only in the case of a single continuous endogenous regressor maximum likelihood estimation is used.
In all other cases, augmented OLS based on Gaussian copula is applied. This includes cases of multiple endogenous regressors
of both discrete and continuous distributions.</p>
<p>In the case of discrete endogenous regressors, a random seed needs to be assigned because the marginal distribution function of
the endogenous regressor is a step function in this case. This means that the value of P&#42;
lies between 2 values, &Phi;<sup>-1</sup>(H(P<sub>t</sub>-1)) and
&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
However, the reported upper and lower bounds of the 95% bootstrapped confidence interval gives indication of the variance of the estimates.</p><p>Since the inference procedure in both cases, augmented OLS and maximum likelihood, occurs in two stages (first the empirical distribution of the endogenous
regressor is computed and then used in constructing the likelihood function), the standard errors are not correct. Therefore, in both cases, the standard errors
and the confidence intervals are obtained based on the sampling distributions resulted from bootstrapping. Since the distribution of the bootstrapped parameters
is highly skewed, we report the percentile confidence intervals. Moreover, the variance-covariance matrix is also computed based on the bootstrapped
parameters, and not based on the Hessian.</p>


<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Formula parameter</h3>
<p>The <code>formula</code> argument follows a two part notation:</p>
<p>A two-sided formula describing the model (e.g. <code>y ~ X1 + X2 + P</code>) to be estimated and a
second right-hand side part in which the endogenous regressors and their distributional
assumptions are indicated (e.g. <code>continuous(P)</code>). These two parts are separated by a single vertical bar (<code><a href='https://rdrr.io/r/base/Logic.html'>|</a></code>).
In the second part, the special functions <code>continuous</code>, <code>discrete</code>, or a combination
of both, are used to indicate the endogenous regressors and their respective distribution.
Both functions use the <code>...</code> parameter in which the respective endogenous regressors is specified.</p>
<p>Note that no argument to <code>continuous</code> or <code>discrete</code> is to be supplied as character
but as symbols without quotation marks.</p>
<p>See the example section for illustrations on how to specify the <code>formula</code> parameter.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Park, S. and Gupta, S., (2012), "Handling Endogenous Regressors by Joint Estimation Using Copulas", Marketing Science, 31(4), 567-86.</p>
<p>Epanechnikov V (1969). "Nonparametric Estimation of a Multidimensional Probability Density." Teoriya veroyatnostei i ee primeneniya, 14(1), 156–161.
Silverman B (1986). "Density Estimation for Statistics and Data Analysis". CRC Monographs on Statistics and Applied Probability. London: Chapman &amp; Hall.</p>
<p>Petrin A, Train K (2010). "A Control Function Approach to Endogeneity in Consumer Choice Models." Journal of Marketing Research, 47(1), 3–13.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.rendo.copula.correction.html'>summary</a></code> for how fitted models are summarized</p>
<p><code><a href='vcov.rendo.boots.html'>vcov</a></code> for how the variance-covariance matrix is derived</p>
<p><code><a href='confint.rendo.boots.html'>confint</a></code> for how confidence intervals are derived</p>
<p><code><a href='https://rdrr.io/pkg/optimx/man/optimx.html'>optimx</a></code> for possible elements of parameter <code>optimx.arg</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataCopCont"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataCopCont2"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataCopDis"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataCopDis2"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dataCopDisCont"</span><span class='op'>)</span>

<span class='co'># \donttest{</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Single continuous: log-likelihood optimization</span>
<span class='va'>c1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>, num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont</span><span class='op'>)</span>
<span class='co'># same as above, with start.parameters and number of bootstrappings</span>
<span class='va'>c1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>, num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont</span>,
                       start.params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"(Intercept)"</span><span class='op'>=</span><span class='fl'>1</span>, X1<span class='op'>=</span><span class='fl'>1</span>, X2<span class='op'>=</span><span class='op'>-</span><span class='fl'>2</span>, P<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># All following examples fit linear model with Gaussian copulas</span>

<span class='co'># 2 continuous endogenous regressors</span>
<span class='va'>c2</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P1</span><span class='op'>+</span><span class='va'>P2</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P1</span>, <span class='va'>P2</span><span class='op'>)</span>,
                        num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont2</span><span class='op'>)</span>
<span class='co'># same as above</span>
<span class='va'>c2</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P1</span><span class='op'>+</span><span class='va'>P2</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P2</span><span class='op'>)</span>,
                        num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont2</span><span class='op'>)</span>

<span class='co'># single discrete endogenous regressor</span>
<span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>discrete</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>, num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopDis</span><span class='op'>)</span>

<span class='co'># two discrete endogenous regressor</span>
<span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P1</span><span class='op'>+</span><span class='va'>P2</span><span class='op'>|</span><span class='fu'>discrete</span><span class='op'>(</span><span class='va'>P1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>discrete</span><span class='op'>(</span><span class='va'>P2</span><span class='op'>)</span>,
                        num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopDis2</span><span class='op'>)</span>
<span class='co'># same as above but less bootstrap runs</span>
<span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P1</span><span class='op'>+</span><span class='va'>P2</span><span class='op'>|</span><span class='fu'>discrete</span><span class='op'>(</span><span class='va'>P1</span>, <span class='va'>P2</span><span class='op'>)</span>, num.boots <span class='op'>=</span> <span class='fl'>10</span>,
                       data<span class='op'>=</span><span class='va'>dataCopDis2</span><span class='op'>)</span>

<span class='co'># single discrete, single continuous</span>
<span class='va'>cd</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P1</span><span class='op'>+</span><span class='va'>P2</span><span class='op'>|</span><span class='fu'>discrete</span><span class='op'>(</span><span class='va'>P1</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P2</span><span class='op'>)</span>,
                        num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopDisCont</span><span class='op'>)</span>

<span class='co'># For single continuous only: use own optimization settings (see optimx())</span>
<span class='co'># set maximum number of iterations to 50'000</span>
<span class='va'>res.c1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>,
                           optimx.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>itnmax <span class='op'>=</span> <span class='fl'>50000</span><span class='op'>)</span>,
                            num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont</span><span class='op'>)</span>

<span class='co'># print detailed tracing information on progress</span>
 <span class='va'>res.c1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>,
                            optimx.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trace <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>,
                             num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont</span><span class='op'>)</span>

<span class='co'># use method L-BFGS-B instead of Nelder-Mead and print report every 50 iterations</span>
 <span class='va'>res.c1</span> <span class='op'>&lt;-</span> <span class='fu'>copulaCorrection</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>X1</span><span class='op'>+</span><span class='va'>X2</span><span class='op'>+</span><span class='va'>P</span><span class='op'>|</span><span class='fu'>continuous</span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span>,
                            optimx.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"L-BFGS-B"</span>,
                                               control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trace <span class='op'>=</span> <span class='fl'>2</span>, REPORT<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>,
                             num.boots<span class='op'>=</span><span class='fl'>10</span>, data<span class='op'>=</span><span class='va'>dataCopCont</span><span class='op'>)</span>

<span class='co'># For coef(), the parameter "complete" determines if only the</span>
<span class='co'># main model parameters or also the auxiliary coefficients are returned</span>

<span class='va'>c1.all.coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>res.c1</span><span class='op'>)</span> <span class='co'># also returns rho and sigma</span>
<span class='co'># same as above</span>
<span class='va'>c1.all.coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>res.c1</span>, complete <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># only main model coefs</span>
<span class='va'>c1.main.coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>res.c1</span>, complete <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='op'>}</span><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/f_heterrorsIV.R
\name{hetErrorsIV}
\alias{hetErrorsIV}
\title{Fitting Linear Models with Endogenous Regressors using Heteroskedastic Covariance Restictions}
\usage{
hetErrorsIV(formula, data, verbose = TRUE)
}
\arguments{
\item{formula}{A symbolic description of the model to be fitted. See the "Details" section for the exact notation.}

\item{data}{A data.frame containing the data of all parts specified in the formula parameter.}

\item{verbose}{Show details about the running of the function.}
}
\value{
Returns an object of classes \code{rendo.ivreg} and \code{ivreg}, It extends the object returned from
function \code{ivreg} of package \code{AER} and slightly modifies it by adapting the \code{call}
and \code{formula} components. The \code{summary} function prints additional diagnostic information as
described in \code{summary.ivreg}'s documentation.

All generic accessor functions for \code{ivreg} such as \code{anova}, \code{hatalues}, or \code{vcov} are available.
}
\description{
This function estimates the model parameters and associated standard errors for a
linear regression model with one or more endogenous regressors. Identification is achieved
through heteroscedastic covariance restrictions within the triangular system as proposed in Lewbel(2012).
}
\details{
The method proposed in Lewbel(2012) identifies structural parameters in regression models with endogenous
regressors by means of variables that are uncorrelated with the product of heteroskedastic errors.
The instruments are constructed as simple functions of the model's data. The method can be applied when
no external instruments are available or to supplement external instruments to improve the efficiency of the
IV estimator.
Consider the model in the equation below:
 \deqn{ y_t=\beta_0+ \beta_1 P_t + \beta_2 X_t + \epsilon_t}
where \eqn{t=1,..,T} indexes either time or cross-sectional units. The endogeneity problem arises from the correlation of
\eqn{P_t} and \eqn{\epsilon_t}. As such:
\deqn{P_{t}=\gamma Z_{t}+\nu_{t}},
where \eqn{Z_{t}} is a subset of variables in \eqn{X_{t}}.
The errors, \eqn{\epsilon} and \eqn{\nu}, may be correlated with each other. Structural parameters are identified by an
ordinary two-stage least squares regression of \eqn{Y} on \eqn{X} and \eqn{P}, using \eqn{X} and \eqn{[Z-E(Z)]\nu} as instruments.
A vital assumption for identification is that \eqn{cov(Z,\nu^2) \neq 0}. The strength of the instrument is proportional
to the covariance of \eqn{(Z-\bar{Z}) \nu} with \eqn{\nu}, which corresponds to the degree of heteroskedasticity of \eqn{\nu} with respect to \eqn{Z} (Lewbel 2012).
The assumption that the covariance between \eqn{Z} and the squared error is different from zero can be empirically tested (it is checked in the background when calling the
hetErrorsIV() function). If it is zero or close to zero, the instrument is weak, producing imprecise estimates, with large standard errors.


The \code{formula} argument has the following notation:
A two-sided formula object describing the MODEL (??), a single endogenous regressor, and
the internal instrumental variables to be built, each part separated by a single vertical bar (\code{|}).
The MODEL (??) part consists of the response on the left of the \code{~} operator and the term labels
on the right-hand side. The sole endogenous regressor is specified in the second right-hand side part
of the formula by separating it with a vertical bar from the MODEL(??). The instrumental variables
that should be built are specified as (multiple) functions, one for each instrument, and
separated from the endogenous regressor by a vertical bar. The function to build the
internal variables is \code{IIV} and uses the following arguments:

\describe{
\item{\code{...}}{The exogenous regressors to build the internal instruments from.
If more than one is given, separate instruments are built for each.}
}

Note that no argument to \code{IIV} is to be supplied as character but as symbols without quotation marks.

Optionally, additional external instrumental variables to be used during the instrumental variable
regression and already present in the data can be specified, again separated by a vertical bar,
as the fourth right-hand side part.

See the example section for illustrations on how to specify the \code{formula} parameter.
}
\examples{
data("dataHetIV")
# P is the endogenous regressor in all examples

# 2 IVs, one from X1, one from X2
het <- hetErrorsIV(y~X1+X2+P|P|IIV(X1)+IIV(X2), data= dataHetIV)
# same as above
het <- hetErrorsIV(y~X1+X2+P|P|IIV(X1, X2), data= dataHetIV)

# use X2 as external IV
het <- hetErrorsIV(y~X1+P|P|IIV(X1) | X2, data= dataHetIV)

summary(het)

}
\references{
Lewbel, A. (2012). Using Heteroskedasticity to Identify and Estimate Mismeasured and Endogenous Regressor Models, Journal of Business & Economic Statistics, 30(1), 67-80.

Angrist, J. and Pischke, J.S. (2009). Mostly Harmless Econometrics: An Empiricists Companion, Princeton University Press.
}
\seealso{
\code{\link[AER]{ivreg}}
}

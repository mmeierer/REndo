<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting Linear Models with Endogenous Regressors using Latent Instrumental Variables • REndo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fitting Linear Models with Endogenous Regressors using Latent Instrumental Variables">
<meta property="og:description" content="Fits linear models with endogenous regressor using latent instrumental variable approaches. 
    The methods included in the package are Lewbels (1997) &lt;doi:10.2307/2171884&gt; higher moments approach as well as 
    Lewbels (2012) &lt;doi:10.1080/07350015.2012.643126&gt; heteroscedasticity approach, Park and Guptas (2012) &lt;doi:10.1287/mksc.1120.0718&gt; joint estimation method 
    that uses Gaussian copula and Kim and Freess (2007) &lt;doi:10.1007/s11336-007-9008-1&gt; multilevel generalized
    method of moment approach that deals with endogeneity in a multilevel setting.
    These are statistical techniques to address the endogeneity problem where no external instrumental variables are needed.
    Note that with version 2.0.0 sweeping changes were introduced which greatly improve functionality and usability but break backwards compatibility.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/REndo-introduction.html">REndo: A Package to Address Endogeneity Without External Instrumental Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mmeierer/REndo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="the-rendo-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#the-rendo-package" class="anchor"></a>The REndo Package</h1></div>
<p>Endogeneity arises when the independence assumption between an explanatory variable and the error in a statistical model is violated. Among its most common causes are omitted variable bias (e.g. like ability in the returns to education estimation), measurement error (e.g. survey response bias), or simultaneity (e.g. advertising and sales).</p>
<p>Instrumental variable estimation is a common treatment when endogeneity is of concern. However valid, strong external instruments are difficult to find. Consequently, statistical methods to correct for endogeneity without external instruments have been advanced. They are called <strong>internal instrumental variable models (IIV)</strong>.</p>
<p>REndo implements the following instrument-free methods:</p>
<ol style="list-style-type: decimal">
<li><p>latent instrumental variables approach (Ebbes, Wedel, Boeckenholt, and Steerneman 2005)</p></li>
<li><p>higher moments estimation (Lewbel 1997)</p></li>
<li><p>heteroskedastic error approach (Lewbel 2012)</p></li>
<li><p>joint estimation using copula (Park and Gupta 2012)</p></li>
<li><p>multilevel GMM (Kim and Frees 2007)</p></li>
</ol>
<div id="the-new-version---rendo-200" class="section level2">
<h2 class="hasAnchor">
<a href="#the-new-version---rendo-200" class="anchor"></a>The new version - REndo 2.0.0</h2>
<p>The new version of <strong>REndo</strong> comes with a lot of improvements in terms of code optimization as well as different syntax for all functions.</p>
</div>
<div id="walk-through" class="section level2">
<h2 class="hasAnchor">
<a href="#walk-through" class="anchor"></a>Walk-Through</h2>
<p>Below, we present the syntax for each of the 5 implemented instrument-free methods:</p>
<div id="latent-instrumental-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#latent-instrumental-variables" class="anchor"></a><strong>Latent Instrumental Variables</strong>
</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">latentIV</span>(y <span class="op">~</span><span class="st"> </span>P, data, <span class="dt">start.params=</span><span class="kw">c</span>()) </span></code></pre></div>
<p>The first argument is the formula of the model to be estimated, <strong>y ~ P</strong>, where <strong>y</strong> is the response and <strong>P</strong> is the endogenous regressor. The second argument is the name of the dataset used and the last one, <strong>start.params=c()</strong>, which is optional, is a vector with the initial parameter values. When not indicated, the initial parameter values are taken to be the coefficients returned by the OLS estimator of <strong>y</strong> on <strong>P</strong>.</p>
</div>
<div id="copula-correction" class="section level3">
<h3 class="hasAnchor">
<a href="#copula-correction" class="anchor"></a><strong>Copula Correction</strong>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">copulaCorrection</span>( y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2 <span class="op">+</span><span class="st"> </span>P1 <span class="op">+</span><span class="st"> </span>P2 <span class="op">|</span><span class="st"> </span><span class="kw">continuous</span>(P1) <span class="op">+</span><span class="st"> </span><span class="kw">discrete</span>(P2), data, <span class="dt">start.params=</span><span class="kw">c</span>(), num.boots)</span></code></pre></div>
<p>The first argument is a two-part formula of the model to be estimated, with the second part of the RHS defining the endogenous regressor, here <strong>continuous(P1) + discrete(P2)</strong>. The second argument is the name of the data, the third argument of the function, <strong>start.params</strong>, is optional and represents the initial parameter values supplied by the user (when missing, the OLS estimates are considered); while the fourth argument, <strong>num.boots</strong>, also optional, is the number of bootstraps to be performed (the default is 1000). Of course, defining the endogenous regressors depends on the number of endogenous regressors and their assumed distribution. Transformations of the explanatory variables, such as I(X), ln(X) are supported.</p>
</div>
<div id="higher-moments" class="section level3">
<h3 class="hasAnchor">
<a href="#higher-moments" class="anchor"></a><strong>Higher Moments</strong>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">higherMomentsIV</span>(y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2 <span class="op">+</span><span class="st"> </span>P <span class="op">|</span><span class="st"> </span>P <span class="op">|</span><span class="st"> </span><span class="kw">IIV</span>(<span class="dt">iiv =</span> gp, <span class="dt">g=</span> x2, X1, X2) <span class="op">+</span><span class="st"> </span><span class="kw">IIV</span>(<span class="dt">iiv =</span> yp) <span class="op">|</span><span class="st"> </span>Z1, data)</span></code></pre></div>
<p>Here, <strong>y</strong> is the response; the first RHS of the formula, <strong>X1 + X2 + P</strong>, is the model to be estimated; the second part, <strong>P</strong>, specifies the endogenous regressors; the third part, <strong>IIV()</strong>, specifies the format of the internal instruments; the fourth part, <strong>Z1</strong>, is optional, allowing the user to add any external instruments available.</p>
<p>Regarding the third part of the formula, <strong>IIV()</strong>, it has a set of three arguments:</p>
<ul>
<li>
<strong>iiv</strong> - specifies the form of the instrument,</li>
<li>
<strong>g</strong> - specifies the transformation to be done on the exogenous regressors,</li>
<li>the set of exogenous variables from which the internal instruments should be built (it can be one or all of the exogenous variables).</li>
</ul>
<p>A set of six instruments can be constructed, which should be specified in the <strong>iiv</strong> argument of <strong>IIV()</strong>:</p>
<ul>
<li>
<strong>g</strong> - for <img src="https://latex.codecogs.com/png.latex?%28G_%7Bt%7D%20-%20%5Cbar%7BG%7D%29%20%22(G_%7Bt%7D%20-%20%5Cbar%7BG%7D)%22" alt="(G_{t} - \bar{G})">,</li>
<li>
<strong>gp</strong> - for <img src="https://latex.codecogs.com/png.latex?%28G_%7Bt%7D%20-%20%5Cbar%7BG%7D%29%28P_%7Bt%7D-%5Cbar%7BP%7D%29%20%22(G_%7Bt%7D%20-%20%5Cbar%7BG%7D)(P_%7Bt%7D-%5Cbar%7BP%7D)%22" alt="(G_{t} - \bar{G})(P_{t}-\bar{P})">,</li>
<li>
<strong>gy</strong> - for <img src="https://latex.codecogs.com/png.latex?%28G_%7Bt%7D%20-%20%5Cbar%7BG%7D%29%28Y_%7Bt%7D-%5Cbar%7BY%7D%29%20%22(G_%7Bt%7D%20-%20%5Cbar%7BG%7D)(Y_%7Bt%7D-%5Cbar%7BY%7D)%22" alt="(G_{t} - \bar{G})(Y_{t}-\bar{Y})">,</li>
<li>
<strong>yp</strong> - for <img src="https://latex.codecogs.com/png.latex?%28Y_%7Bt%7D%20-%20%5Cbar%7BY%7D%29%28P_%7Bt%7D-%5Cbar%7BP%7D%29%20%22(Y_%7Bt%7D%20-%20%5Cbar%7BY%7D)(P_%7Bt%7D-%5Cbar%7BP%7D)%22" alt="(Y_{t} - \bar{Y})(P_{t}-\bar{P})">,</li>
<li>
<strong>p2</strong> - for <img src="https://latex.codecogs.com/png.latex?%28P_%7Bt%7D%20-%20%5Cbar%7BP%7D%29%5E2%20%22(P_%7Bt%7D%20-%20%5Cbar%7BP%7D)%5E2%22" alt="(P_{t} - \bar{P})^2">,</li>
<li>
<strong>y2</strong> - for <img src="https://latex.codecogs.com/png.latex?%28Y_%7Bt%7D%20-%20%5Cbar%7BY%7D%29%5E2%20%22(Y_%7Bt%7D%20-%20%5Cbar%7BY%7D)%5E2%22" alt="(Y_{t} - \bar{Y})^2">.</li>
</ul>
<p>where <embed src="https://latex.codecogs.com/png.latex?G%3DG%28X_%7Bt%7D%29%20%22G=G(X_%7Bt%7D)%22"></embed> can be either <embed src="https://latex.codecogs.com/png.latex?x%5E2" title="x^2"></embed>, <embed src="https://latex.codecogs.com/png.latex?x%5E3" title="x^3"></embed>, <embed src="https://latex.codecogs.com/png.latex?ln%28x%29" title="ln(x)"></embed> or <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bx%7D%20%22%5Cfrac%7B1%7D%7Bx%7D%22" alt="\frac{1}{x}"> and should be specified in the <strong>g</strong> argument of the third RHS of the formula, as <strong>x2, x3, lnx</strong> or <strong>1/x</strong>. In case of internal instruments built only from the endogenous regressor, e.g. <strong>p2</strong>, or from the response and the endogenous regressor, like for example in <strong>yp</strong>, there is no need to specify <strong>g</strong> or the set of exogenous regressors in the <strong>IIV()</strong> part of the formula. The function returns a set of tests for checking the validity of the instruments and the endogeneity assumption.</p>
</div>
<div id="heteroskedastic-errors" class="section level3">
<h3 class="hasAnchor">
<a href="#heteroskedastic-errors" class="anchor"></a><strong>Heteroskedastic Errors</strong>
</h3>
<pre><code><a href="reference/hetErrorsIV.html"> hetErrorsIV(y ~ X1 + X2 + X3 + P | P | IIV(X1,X2) | Z1, data)</a></code></pre>
<p>Here, <strong>y</strong> is the response variable, <strong>X1 + X2 + X3 + P</strong> represents the model to be estimated; the second part, <strong>P</strong>, specifies the endogenous regressors, the third part, <strong>IIV(X1, X2)</strong>, specifies the exogenous heteroskedastic variables from which the instruments are derived, while the final part <strong>Z1</strong> is optional, allowing the user to include additional external instrumental variables. Like in the higher moments approach, allowing the inclusion of additional external variables is a convenient feature of the function, since it increases the efficiency of the estimates. Transformation of the explanatory variables, such as I(X), ln(X) are possible both in the model specification as well as in the IIV() specification.</p>
</div>
<div id="multilevel-gmm" class="section level3">
<h3 class="hasAnchor">
<a href="#multilevel-gmm" class="anchor"></a><strong>Multilevel GMM</strong>
</h3>
<pre><code><a href="reference/multilevelIV.html">multilevelIV(y ~ X11 + X12 + X21 + X22 + X23 + X31 + X33 + X34 + (1|CID) + (1|SID) | endo(X12), data)  </a></code></pre>
<p>The call of the function has a two-part formula and an argument for data specification. In the formula, the first part is the model specification, with fixed and random parameter specification, and the second part which specifies the regressors assumed endogenous, here <strong>endo(X12)</strong>. The function returns the parameter estimates obtained with fixed effects, random effects and the GMM estimator proposed by Kim and Frees (2007), such that a comparison across models can be done.</p>
</div>
</div>
<div id="installation-instructions" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-instructions" class="anchor"></a>Installation Instructions</h2>
<p>Install the stable version from CRAN:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">install.packages</span>(<span class="st">"REndo"</span>)</span></code></pre></div>
<p>Install the development version from GitHub:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"mmeierer/REndo"</span>, <span class="dt">ref =</span> <span class="st">"development"</span>)</span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=REndo">https://​cloud.r-project.org/​package=REndo</a>
</li>
<li>Browse source code at <br><a href="https://github.com/mmeierer/REndo/">https://​github.com/​mmeierer/​REndo/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mmeierer/REndo/issues">https://​github.com/​mmeierer/​REndo/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Raluca Gui <br><small class="roles"> Maintainer, author </small>  </li>
<li>Markus Meierer <br><small class="roles"> Author </small>  </li>
<li>Rene Algesheimer <br><small class="roles"> Author </small>  </li>
<li>Patrik Schilter <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mmeierer/REndo/actions"><img src="https://github.com/mmeierer/REndo/workflows/R-CMD-check/badge.svg?branch=development" alt="R CMD checks"></a></li>
<li><a href="https://github.com/mmeierer/REndo/actions"><img src="https://github.com/mmeierer/REndo/workflows/coverage/badge.svg?branch=development" alt="Tests"></a></li>
<li><a href="https://codecov.io/github/mmeierer/REndo?branch=development"><img src="https://img.shields.io/codecov/c/github/mmeierer/REndo/development.svg" alt="Coverage Status"></a></li>
<li><a href="https://cran.r-project.org/package=REndo"><img src="http://www.r-pkg.org/badges/version/REndo" alt="CRAN Status"></a></li>
<li><a href="https://cran.r-project.org/package=REndo"><img src="https://cranlogs.r-pkg.org/badges/REndo" alt="CRAN Downloads"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Repo Status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
